function enforceMaxInputLengthsWithinContainer(n){n&&jQuery("textarea[maxlength], input[maxlength]",n).bind("keyup input paste",function(){var n=jQuery(this),t=parseInt(n.attr("maxlength")),i=n.val();i.length>t&&n.val(i.substr(0,t))})}function unbindMaxInputLengthsWithinContainer(n){n&&jQuery("textarea[maxlength], input[maxlength]",n).unbind()}function isAllowedSavedView(n){for(var i=["MonthView","WeekView","DayView","AgendaView","TaskView","DefaultView"],u=i.length,r=!1,t=0;t<u;t++)if(i[t]==n){r=!0;break}return r}function getZoomLevel(){if($B.IE)try{var n=window.document.body;return n.offsetParent&&n.offsetParent.offsetWidth?n.offsetParent.offsetWidth/n.offsetWidth:1}catch(t){return 1}else return 1}function getFontRatio(){fontControlDiv=fontControlDiv||_ge("fontControlDiv");var n=1;return fontControlDiv&&(n=fontControlDiv.offsetWidth/14),n}function doCommandFromHistory(n){gController.doCommand(n.commandName,n.paramList,!0)}function doCommand(n,t){gController.doCommand(n,t,!1)}function doHelp(n){window.open(m_helpBaseUrl+"&errorCode="+n)}function onJsLoaded(){if(getSetting("webWatsonEnable")&&(window.$Config||($Config={}),$Config.TraceData={PLTRate:getSetting("webPltTraceRate"),target:getSetting("webWatsonTargetParamter"),skipInitPLT:"1",traceLevel:"4",disable:"",renderPLT:"0"},typeof $Version=="undefined"))try{var n=new Image;n.src=$Config.TraceData.target+"&ec=54"}catch(t){}$Do.when("$MDCReady",0,init)}function showUrlDlg(n,t,i,r,u){if(!!getSetting("publishedUrlBase")){var e=n+"://"+getSetting("publishedUrlBase")+t,f=new $StringBuilder;f.append("<p "),f.append(" >"),f.append(r),f.append("<\/p><a target='_top' href='"),f.append(e.encodeHtml()),f.append("' "),f.append(">"),f.append(e.encodeHtml()),f.append("<\/a>"),wLive.Controls.Notifications.createModalDialog({title:i,content:f.toString(),buttons:{action:m_pStrings.controller.ok}}).show(),gController.doCommand("TrackAction",{trackId:u})}return!1}function GetTemperatureString(n,t){return"&lrm;"+n+"&deg;"+(t?t:"&lrm;")}function getEffectHandlerAttributesHtml(n){var t;return t=n?Calendar.EFFECT_HANDLER_ATTRIBUTES_SUPPRESS_CAPTURE_HTML:Calendar.EFFECT_HANDLER_ATTRIBUTES_HTML}function handleButtonMouseEffectEvents(n,t,i){if(!Dom.isClassPresent(t,"buttonDisable")){n=n||window.event;switch(n.type){case"mouseenter":case"mouseover":Dom.isClassPresent(t,"buttonHover")||Dom.addClass(t,"+buttonHover","-buttonRest");break;case"mouseleave":case"mouseout":Dom.isClassPresent(t,"buttonHover")&&Dom.addClass(t,"-buttonHover","+buttonRest");break;case"mousedown":Dom.addClass(t,"+buttonPressed"),$B.Firefox||i||t.setCapture(!0);break;case"mouseup":$B.Firefox||t.releaseCapture(),Dom.addClass(t,"-buttonPressed"),Dom.getNearestParentWithClass(n.target,"buttonHover")==null&&Dom.addClass(t,"-buttonHover")}}}function isSMS(n){var t=!1;return n!==null&&(t=n.ModalityType===CAL.ModalityType.SMS),t}function pltTimerStart(n){_isTimingPLT&&pltTimerStop(),$CSIPerf.setPerformanceId(n),$BSI.informNav(),_isTimingPLT=!0}function pltTimerMarkRequestingData(){_isTimingPLT&&$CSIPerf.lapseTimer("QD")}function pltTimerMarkReceivedData(){_isTimingPLT&&$CSIPerf.lapseTimer("GD")}function pltTimerMarkRequestingJavascript(){_isTimingPLT&&$CSIPerf.lapseTimer("QJ")}function pltTimerMarkReceivedJavascript(){_isTimingPLT&&$CSIPerf.lapseTimer("GJ")}function pltTimerMarkAllDownloadingComplete(){_isTimingPLT&&$BSI.informPVHead()}function pltTimerMarkAsCacheHit(){_isTimingPLT&&$CSIPerf.addCsd("CH","1")}function pltTimerStop(){_isTimingPLT&&($BSI.informLoaded(),_isTimingPLT=!1)}var fontControlDiv,NUMBER_OF_COLORS,__CALDESKTOPUTIL_LOADED,g_highestNamespaceId,__WEBUTILS_LOADED,CharmsManager;$Network.Fpp=function(n,t){function f(proxy,obj){var pkg,strUrl,oFppPkg,arrArgs;$Network.Events.onfinished.fire(obj),pkg={ErrorCode:0,Context:obj.context,Proxy:proxy,Error:null},obj.bRetry=!1;try{proxy==null?pkg.ErrorCode=-4:proxy.statusText==null||proxy.statusText==""?pkg.ErrorCode=-5:proxy.status!=200&&proxy.status!=500&&(pkg.ErrorCode=-7)}catch(ex){pkg.ErrorCode=-5}if(pkg.ErrorCode!=0){if(++obj.nRetry<=u){obj.bRetry=!0;return}obj.cbErr&&obj.cbErr(pkg.ErrorCode,pkg.Context,pkg.Proxy,pkg.Error),$Network.Events.onerror.fire(pkg)}else{try{strUrl=proxy.getResponseHeader("FPPRPURL"),strUrl!=""&&strUrl!=null&&(r.FPPRPURL=strUrl)}catch(ex){}try{t.CommandType==0?oFppPkg=eval(proxy.responseText):t.CommandType==1&&(oFppPkg=eval("("+proxy.responseText+")")),$Network.Events.onprofile.fire(oFppPkg.ProfilingInfo),oFppPkg.Status==0?(arrArgs=oFppPkg.OutRefParams,arrArgs.unshift(obj.context),arrArgs.unshift(oFppPkg.Value),obj.callback.apply(null,arrArgs)):(pkg.ErrorCode=oFppPkg.Status,pkg.Error=oFppPkg.Error,obj.cbErr&&obj.cbErr(pkg.ErrorCode,pkg.Context,pkg.Proxy,pkg.Error),$Network.Events.onerror.fire(pkg))}catch(ex){if(pkg.ErrorCode=-6,pkg.Error=ex,++obj.nRetry<=u){obj.bRetry=!0;return}obj.cbErr&&obj.cbErr(pkg.ErrorCode,pkg.Context,pkg.Proxy,pkg.Error),$Network.Events.onerror.fire(pkg)}}obj.bRetry=!1}var u=2,i=0,r={};r["Content-Type"]="application/x-www-form-urlencoded",typeof t=="undefined"&&(t={}),typeof t.ServerTunnelingUrl=="string"&&(typeof t.UseClientXmlProxy=="undefined"||t.UseClientXmlProxy==!1)&&(r.FPPRPURL=t.ServerTunnelingUrl),t.CommandType=t.CommandType||0,t.Version=t.Version||0,t.PartnerId=t.PartnerId||0,t.SessionId=t.SessionId||"",t.AuthUser=t.AuthUser||"",Object.isNumber(t.DefaultRetry)&&(u=t.DefaultRetry),Object.isBoolean(t.Notify)&&t.Notify&&(i=i|$Network.Flags.NOTIFY),Object.isBoolean(t.UseClientXmlProxy)&&t.UseClientXmlProxy&&(i=i|$Network.Flags.CLIENTPROXY),Object.isBoolean(t.AllowDuplicate)&&t.AllowDuplicate&&(i=i|$Network.Flags.DUPLICATE),r["X-FPP-Command"]=t.CommandType,this.invoke=function(u,e,o,s,h,c,l,a,v,y){if(e==null||o==null||h==null)throw new Error("invalid arguments for $Network.Fpp");if(typeof h!="function")throw new Error("$Network.Fpp arg list mismatch:  cb must be of type function.");y||(y=Array.$Prioritizer.Priorities.High);var w="cn="+e+"&mn="+o+"&d="+s+"&v="+t.Version,b,p,k=$Network.defaultTimeout,g={context:c,callback:h,cbErr:l,bRetry:!1,nRetry:0,bSave:!1},d=n.indexOf("?")>0?"&":"?";return u==$Network.Type.XMLPost?(b=w,p="{0}{1}cnmn={2}.{3}&ptid={4}&a={5}&au={6}".format(n,d,e,o,t.PartnerId,t.SessionId,t.AuthUser)):u==$Network.Type.XMLGet&&(p="{0}{1}{2}&ptid={3}&a={4}&au={5}".format(n,d,w,t.PartnerId,t.SessionId,t.AuthUser)),v&&$Network.abortGroup(v),a&&(k=a),$Network.fetch(f,new $Request(p,u,i,g).setHeaders(r).setPostString(b).setTimeout(k).setGroup(v).setCanary(t.CanaryToken))}},$Network.FppProxy=function(n){function u(i,r){function u(){for(var u={},e=r.length,f=0;f<e;f++)u[r[f]]=arguments[f];return u.toString=function(f){var o=[],s;for(t.CommandType==0&&f&&o.push(n,".",i,":"),o.push("{"),s=0;s<e;s++)t.CommandType==1&&o.push(typeof r[s].toString()=="undefined"?r[s].type:r[s].toString(),":"),o.push(r[s].escape(u[r[s]],t.Version,t.CommandType==0),",");return e>0&&o.pop(),o.push("}"),o.join("")},u.__isFppObject=!0,u}return u}function f(n,i,u,f,e){function o(){for(var h=[],s=i.length,o=0;o<s;o++)t.CommandType==1&&h.push(typeof i[o].toString()=="undefined"?i[o].type:i[o].toString(),":"),h.push(i[o].escape(arguments[o],t.Version,t.CommandType==0),",");return s>0&&h.pop(),r.invoke(u||$Network.Type.XMLPost,e,n,h.join(""),arguments[s],arguments[s+1],arguments[s+2],arguments[s+3],f)}return o}var i=this,r,t;this.initialize=function(n,t,r,u,f,e){var o={Version:0,CommandType:0,PartnerId:t,SessionId:r,ServerTunnelingUrl:u,UseClientXmlProxy:f,CanaryToken:e};return i.initializeEx(n,o)},this.initializeEx=function(n,u){return r=new $Network.Fpp(n,u),t=u,i},this.rfc=this.registerFppClass=function(n,t){this[n]=u(n,t)},this.rfm=this.registerFppMethod=function(n,t,i,r,u,e){this[n]=f(i||n,t,r||$Network.Type.XMLPost,u,e||strDefaultNamespace)},this.seal=function(){this.rfc=this.registerFppClass=this.rfm=this.registerFppMethod=this.seal=null}},new function(){var n=$Network.FppProxy,i,t,r;for(n.TypeSystem=function(n,t){return this.toString=function(){return t},this.type=n,this},n.dateToISO8601=function(t){var f="{0}-{1}-{2}T{3}:{4}:{5}",i=t.getHours(),r=t.getMinutes(),u=t.getSeconds();return i<10&&(i="0"+i),r<10&&(r="0"+r),u<10&&(u="0"+u),n.escape(f.format(t.getFullYear(),t.getMonth()+1,t.getDate(),i,r,u))},n.arrayToString=function(t,i,r){var e="",u,f;if(t==null)return e;if(Object.isArray(t)){for(u=[],u.push("["),f=0;f<t.length;f++)u.push(n.objToStringImpl(t[f],i,r)),u.push(",");return t.length>0&&u.pop(),u.push("]"),u.join("")}throw new Error("p_array = "+t+" is not an array");},n.escape=function(n,t){if(n==null)return n;var i="";return i=t==0?encodeURIComponent(n.toString().replace(/([\{|\}\[|\]\,\\])/g,"\\$1")):encodeURIComponent('"'+n.toString().replace(/([\{|\}\[|\]\,\\:\"])/g,"\\$1")+'"')},n.objToStringImpl=function(t,i,r){var u=[];return t==null||typeof t=="undefined"?(r&&u.push("null:"),u.push("null")):typeof t=="string"?(r&&u.push("System.String:"),u.push(n.escape(t,i))):t.constructor._typeName=="Date"?(r&&u.push("System.DateTime:"),u.push(n.dateToISO8601(t))):Object.isArray(t)?(r&&u.push("System.Array:"),u.push(n.arrayToString(t,i,r))):typeof t=="object"?t.__isFppObject==!0?u.push(t.toString(r)):(r&&u.push("System.Collections.Hashtable:"),u.push(n.objToString(t,i,r))):(r&&u.push("System.String:"),u.push(t.toString())),u.join("")},n.objToString=function(t,i,r){var u=["{"],f;for(f in t)t.hasOwnProperty(f)&&u.push(n.escape(f,i),":",n.objToStringImpl(t[f],i,r),",");return u.pop(),u.push("}"),u.join("")},n.TypeSystem.prototype.escape=function(t,i,r){if(t==null||typeof t=="undefined")return"null";switch(this.type){case"__string":return n.escape(t,i);case"__date":return n.dateToISO8601(t);case"__array":return n.arrayToString(t,i,!1);case"__oArray":case"__object":return n.objToStringImpl(t,i,r);case"__primitive":case"__enum":return t;default:return t.__isFppObject==!0?t:n.objToString(t,i,r)}},n.__string=function(t){return new n.TypeSystem("__string",t)},n.__date=function(t){return new n.TypeSystem("__date",t)},n.__array=function(t){return new n.TypeSystem("__array",t)},n.__oArray=function(t){return new n.TypeSystem("__oArray",t)},n.__primitive=function(t){return new n.TypeSystem("__primitive",t)},n.__object=function(t){return new n.TypeSystem("__object",t)},n.__enum=function(t){return new n.TypeSystem("__enum",t)},n.__custom=function(t,i){return new n.TypeSystem(t,i)},n.create=function(n,t){for(var i=window,u=n.split("."),e=u.length,f,r=0;r<e-1;r++)f=u[r],i[f]||(i[f]=function(){}),i=i[f];i[u[r]]=new t},typeof Web!="undefined"&&Web.Network&&(Web.Network.Fpp=$Network.Fpp,Web.Network.FppProxy=$Network.FppProxy),i=$Network._fppProxies,t=i.length-1;t>=0;t--)r=i[t],n.create(r.type,r.classType);$Network._fppReady=!0},$Network.registerScript("FireAnt.js"),$Network.registerFpp("CAL",function(){var o=$Network.FppProxy,n=o.__string,i=o.__primitive,e=o.__array,f=o.__custom,r=o.__enum,u=o.__date,s=o.__object,h=o.__oArray,t=new $Network.FppProxy("CAL");return t.ServiceError=new $Flags("GenericServerError",1,"VersioningUpgradeError",2,"SessionStateError",3,"BlockedRequest_FppCanaryMismatch",4,"BlockedRequest_FppCanaryMissing",5,"BlockedRequest_FppCanaryEmpty",6,"BlockedRequest_FppAuthUserMismatch",7,"BlockedRequest_BlockedHttp",8,"BlockedRequest_BlockedIp",9,"BlockedRequest_BlockedUser",10,"BlockedRequest_PartnerAccessOnly",11,"BlockedRequest_QueryCacheLockTimeout",12,"BlockedRequest_CookiesRefused",13,"BlockedRequest_EidFailure",14,"Authentication_WrongMode",15,"Authentication_PassportFailure",16,"Authentication_NoUser",17,"Authentication_DelegatedTokenFailure",18,"Authentication_RequiresSsl",19,"Authentication_NotSignedTermsOfUse",20,"MetroOptIn_DisallowedOptInRequest",21,"MaxErrorValue",22),t.ClientMessageType=new $Flags("Info",0,"Warning",1,"Error",2),t.rfc("__0",[n("Url"),i("CommandCode"),n("Text"),n("Data")]),t.rfc("__1",[r("MessageType"),i("InfoCode"),n("Message"),n("ExtendedMessage"),n("PSValue"),f(t.__0,"LearnMoreLink"),f(t.__0,"Link1"),f(t.__0,"Link2"),f(t.__0,"Link3"),i("IsBlocking"),i("DisplayInSuperbar"),i("IsImportant")]),t.rfc("HmSimpleMsg",[i("IsBlocking"),i("YesCode"),i("NoCode"),n("Message"),n("Link1")]),t.RecurrenceDayDropDownOption=new $Flags("AllDays",0,"WeekDays",1,"WeekendDays",2,"Sunday",3,"Monday",4,"Tuesday",5,"Wednesday",6,"Thursday",7,"Friday",8,"Saturday",9),t.RecurrenceRepeatType=new $Flags("Unknown",0,"Secondly",1,"Minutely",2,"Hourly",3,"Daily",4,"Weekly",5,"Monthly",6,"Yearly",7),t.RecurrenceEndType=new $Flags("WindowEnd",0,"RepeatForever",1,"RepeatInstances",2),t.rfc("BLCalendarDefaultReminder",[n("ModalityGuid"),r("PLReminderOffset")]),t.ReminderOffset=new $Flags("NotSupported",0,"NoReminder",1,"ZeroMinutes",2,"FiveMinutes",3,"TenMinutes",4,"FifteenMinutes",5,"ThirtyMinutes",6,"FortyFiveMinutes",7,"OneHour",8,"TwoHours",9,"FourHours",10,"SixHours",11,"HalfDay",12,"OneDay",13,"TwoDays",14,"OneWeek",15,"TwoWeeks",16),t.rfc("BusinessLogicCalendar",[n("Guid"),n("CharmId"),n("NotificationModalityId"),e("Alarms"),n("Name"),n("Description"),i("IsVisibleToCurrentUser"),i("IsHidden"),i("IsCurrentUserOwner"),i("IsPermissionStoredLocally"),r("Visibility"),i("IsPublicPublished"),i("PublishTimeZone"),i("ColorIndex"),r("SharingPermission"),r("TasksPermissionLevel"),i("IsAllowSharingViaUrl"),i("HasDailyEmailSummaryEnabled"),n("OwnerName"),i("IsShared"),i("IsDefaultCalendar"),r("CalendarType"),e("DefaultReminders"),n("Url"),u("LastRefreshTimeLocal"),i("ConsecutiveSubscriptionErrorCount"),i("ImportedSubscriptionEventCount"),i("TotalSubscriptionEventCount"),i("MissingUidCountForSubscription"),i("PollingDisabledForSubscription")]),t.BusinessLogicCalendar.PreProvisionName=decodeURIComponent("%7b5EC4AEA7-85C5-453c-B9A4-09A14D92FF50%7d"),t.rfc("BusinessLogicSharingData",[e("Contacts"),e("Groups")]),t.rfc("BusinessLogicGroup",[n("Name"),n("Guid"),r("SharingPermission")]),t.rfc("BusinessLogicContact",[n("Name"),n("Email"),n("Id"),r("SharingPermission")]),t.rfc("BusinessLogicContactOperation",[n("Id"),r("SharingOperation"),r("SharingPermission")]),t.rfc("BusinessLogicGroupOperation",[n("Guid"),r("SharingOperation"),r("SharingPermission")]),t.rfc("CalRequestErrorStatus",[e("ErrorCode"),e("Message"),h("ErrorData")]),t.rfc("BLSharingMember",[n("Name"),n("Email"),n("Id"),r("SharingPermission"),i("IsReadOnly")]),t.rfc("BLCalendarSharingSettingsResult",[i("IsShared"),r("SharingPermission"),i("IsPublicPublished"),i("IsAllowSharingViaUrl"),r("PrivateVisibility"),f(t.BLPublishingUrls,"PrivateFreeBusyUrls"),f(t.BLPublishingUrls,"PrivateFullDetailUrls"),f(t.BLPublishingUrls,"PublicUrls")]),t.rfc("TasksQueryObject",[i("BuildTaskList"),i("NumberOfSearchResults"),e("CalendarList"),i("ReturnCompletedTasks"),i("ReturnIncompleteTasks")]),t.rfc("BLPublishingUrls",[n("Html"),n("Rss"),n("ICal")]),t.rfc("BLCalendarSharingSettings",[i("MemberSharingEnabled"),i("PrivateUrlsEnabled"),r("PrivateVisibility"),i("PublicUrlsEnabled"),f(t.BLPublishingUrls,"PrivateFreeBusyUrls"),f(t.BLPublishingUrls,"PrivateFullDetailUrls"),f(t.BLPublishingUrls,"PublicUrls"),e("Members"),r("PublicUrlsPermissionLevel"),i("TimeZoneNum"),n("OwnerEmail"),r("TasksPermissionLevel")]),t.rfc("PLRecurrenceDescriptor",[u("PLRecurrenceStartDate"),u("PLRecurrenceEndDate"),r("RepeatType"),r("EndType"),i("RepeatCount"),i("Interval"),i("IsEveryWeekDay"),e("WeekdayList"),i("MonthRecurrenceSubType"),i("MonthDay"),i("SetPosition"),i("YearlyRecurrenceSubType"),i("MonthNo"),r("DropDownOption"),i("IsNotSupportedRecurrence"),i("HasRecurrenceExceptionsOrRdates")]),t.PLRecurrenceDescriptor.DAYS_IN_WEEK=7,t.rfc("PublishingSettings",[n("CalendarId"),i("IsEnabled"),i("IsPublic"),i("IsPrivate"),i("IsFreeBusy"),i("IsPrivateFreeBusy"),n("PublicRssUrl"),n("PublicICalUrl"),n("PrivateRssUrl"),n("PrivateICalUrl"),n("PublicICalQuickAddLink")]),t.rfc("BusinessLogicMapCoordinate",[i("Latitude"),i("Longitude")]),t.CommandCodeType=new $Flags("Unknown",0,"ReportError",1,"NetworkStatus",2,"EditSingle",3,"EditSeries",4,"Reauth",5),t.CalendarVisibility=new $Flags("Private",1,"Public",2,"Shared",4),t.PrivatePublishVisibility=new $Flags("None",0,"FreeBusy",10,"Detail",20,"FreeBusyAndDetail",30),t.SharingPermissionLevel=new $Flags("FreeBusy",0,"LimitedDetails",10,"Read",20,"ReadWrite",30,"CoOwner",40,"Owner",50,"Null",-10),t.TasksPermissionLevel=new $Flags("ShareEventsOnly",0,"ShareWithReadWriteMembers",1,"ShareWithReadOnlyMembers",2,"ShareWithCoOwners",3,"Null",-1),t.CalendarType=new $Flags("Regular",0,"Birthday",1,"Exchange",2,"iCal",4,"Holiday",8,"Group",16,"FamilyHub",32),t.SharingMemberState=new $Flags("Accepted",0,"Declined",1,"Pending",2,"Removed",3,"Tentative",4,"Unknown",5,"Null",-1),t.SharingOperationType=new $Flags("None",0,"Add",1,"Update",2,"Delete",3),t.ConvertRecurringToNonRecurringEnum=new $Flags("None",0,"ConvertEventFromNonRecurringToRecurring",1,"ConvertEventFromRecurringToNonRecurring",2),t.DisplayView=new $Flags("DayView",0,"WeekView",1,"MonthView",2,"AgendaView",3,"DefaultView",4,"NewEventView",5,"ReadOnlyEventView",6,"EditEventView",7,"NewTaskView",8,"ReadOnlyTaskView",9,"EditTaskView",10,"CalendarGeneralSettingsView",11,"CalendarSharingSettingsView",12,"Options",13,"CodeOfConduct",14,"ICalSubscription",15,"TaskView",16,"MigrationInterstitial",17,"LegacyInterstitial",18),t.GridExpansionMode=new $Flags("DontExpand",0,"Expand",1,"TitlesExpanded",2),t.rfc("PLMROperationInfo",[r("organizerAction"),r("participantAction"),n("commentToSend")]),t.OrganizerActionType=new $Flags("CreateMeetingRequest",0,"SendUpdatesToAll",1,"SendUpdatesToNewParticipants",2,"Save",3,"CancelMeeting",4),t.ParticipantActionType=new $Flags("UpdateParticipantStatusOnly",0,"UpdateParticipantStatusAndSendUpdate",1,"Save",2),t.MeetingRequestModeType=new $Flags("Participant",0,"Organizer",1),t.EventPriority=new $Flags("Undefined",0,"Highest",1,"Normal",5,"Lowest",9),t.EventProgress=new $Flags("Undefined",0,"NotStarted",1,"InProgress",5,"Completed",9),t.TasksSortOrder=new $Flags("DueDate",0,"Priority",1),t.PLEventFields=new $Flags("StartTime",0,"EndTime",1,"EventProgress",2),t.ModalityType=new $Flags("Email",0,"SMS",1,"Messenger",2,"Client",3),t.rfc("SubscriptionCalendarInfo",[e("SyncErrors")]),t.rfc("JsonCategory",[n("Guid"),n("Name")]),t.rfc("JsonGetEventResult",[f(t.JsonEvent,"Result"),i("UserTimezoneOffset")]),t.rfc("JsonGetEventsResult",[e("Result"),i("ActualCount"),i("UserTimezoneOffset")]),t.rfc("JsonGetCalendarsResult",[e("Result")]),t.rfc("JsonGetCalendarResult",[f(t.JsonCalendar,"Result")]),t.rfc("JsonCalendar",[n("Guid"),n("Name"),n("Description"),i("IsVisibleToCurrentUser"),i("IsShared"),i("IsDefaultCalendar"),n("Owner"),n("CalendarOwnerId"),n("SharingPermission"),n("CalendarType"),n("SubscribedCalendarUrl"),n("CreatedDate"),n("LastModifiedDate")]),t.rfc("JsonCalendarWithCollectionId",[n("CollectionID"),n("Guid"),n("Name"),n("Description"),i("IsVisibleToCurrentUser"),i("IsShared"),i("IsDefaultCalendar"),n("Owner"),n("CalendarOwnerId"),n("SharingPermission"),n("CalendarType"),n("SubscribedCalendarUrl"),n("CreatedDate"),n("LastModifiedDate")]),t.rfc("JsonEvent",[n("Guid"),n("CalendarGuid"),n("DateStart"),n("DateEnd"),i("DateStartTimeZoneOffset"),i("DateEndTimeZoneOffset"),n("Summary"),n("Description"),n("Location"),i("IsAllDayEvent"),i("AlarmOffsetTimeInMin"),i("IsMeetingRequest"),n("RecurrenceDescription"),n("Availability"),n("Visibility"),n("UserParticipationStatus"),n("MeetingRequestMode"),e("Participants"),e("Categories"),n("CreatedDate"),n("LastModifiedDate")]),t.rfc("JsonParticipant",[n("Guid"),n("EventGuid"),n("EmailAddress"),n("CommonName"),n("ParticipantType"),n("Role"),n("Status"),i("IsOrganizer"),i("RsvpExpected"),e("DelegatedFrom"),e("DelegatedTo"),n("LastResponseType")]),t.rfc("JsonSharingMemberToAddInfo",[n("Puid"),r("Permission"),n("PassportName"),n("Cid"),i("LCID"),n("TimeZone")]),t.rfc("JsonSharingMemberToDeleteInfo",[n("Puid")]),t.rfc("JsonSharingMemberToModifyInfo",[n("Puid"),r("Permission")]),t.rfc("JsonAddedSharingCalendarInfo",[n("Puid"),n("CollectionID")]),t.rfc("JsonAddedSharingCalendarResult",[e("Added")]),t.rfc("JsonTimeZone",[i("GMTOffset"),n("TimeZoneId")]),t.rfc("JsonUserLocation",[n("Location")]),t.rfc("BootstrapPackage",[e("Calendars"),e("Events"),i("NumberOfCircleCalendars"),i("BirthdayCalendarBackgroundUpdate")]),t.rfc("PostBootstrapPackage",[e("UpdatedGroupCalendars"),f(t.BusinessLogicCalendar,"BirthdayCalendar"),e("Events"),i("BirthdayCalendarBackgroundUpdate"),i("BirthdayCalendarSyncedOnline")]),t.rfc("PLAlarm",[n("Guid"),n("EventGuid"),n("Description"),r("OffsetTime"),n("ModalityGuid"),r("ModalityType"),n("ModalityValue"),i("UnsupportedOffsetTimeInMin"),n("UnsupportedReminderDropdownText"),r("AlarmType")]),t.rfc("PLCategory",[n("Guid"),n("Name")]),t.EventStatus=new $Flags("Busy",0,"Tentative",1,"Free",2,"OOF",3),t.EventVisibility=new $Flags("Public",0,"Private",1,"Confidential",2,"Personal",3),t.CalendarUserType=new $Flags("Individual",0,"Group",1,"Resource",2,"Room",3,"Unknown",4),t.CalendarUserParticipationRole=new $Flags("Required",0,"Chair",1,"Optional",2,"NonParticipant",3),t.CalendarUserParticipationStatus=new $Flags("NeedsAction",0,"Accepted",1,"Declined",2,"Tentative",3,"Delegated",4),t.PLCalendarAlarmType=new $Flags("Display",0,"Email",1,"TextMessage",2,"MessengerMessage",3),t.CalendarItemType=new $Flags("CalendarItem",0,"MeetingRequest",1,"Holiday",2,"SocialEvent",3,"TaskItem",4,"CustomItem",5),t.ICalEventStatus=new $Flags("Confirmed",0,"Tentative",1,"Cancelled",2,"NeedsAction",3,"InProcess",4,"Completed",5),t.rfc("PLEvent",[n("Guid"),u("DateStart"),u("DateEnd"),u("CustomTZStartDate"),u("CustomTZEndDate"),i("EventTimeInUserTimeZone"),i("StartTimeTZNum"),i("EndTimeTZNum"),n("CalendarGuid"),n("CharmId"),n("BirthdaySourceId"),n("Summary"),n("Description"),n("Location"),n("Url"),r("FreeBusyStatus"),r("Visibility"),f(t.BusinessLogicMapCoordinate,"MapCoordinate"),e("Alarms"),i("Priority"),i("IsAllDayEvent"),u("RecurrenceId"),r("EventProgress"),u("CompletedDate"),u("CreatedDate"),r("ItemType"),n("ParentGuid"),f(t.PLRecurrenceDescriptor,"RecurrenceInfo"),n("RecurrenceDescription"),i("IsRecurrenceException"),e("Categories"),e("Participants"),f(t.PLParticipant,"Organizer"),r("UserParticipationStatus"),f(t.PLMROperationInfo,"MeetingRequestOperation"),i("SequenceNumber"),i("IsDraft"),r("MeetingRequestMode"),r("IcsEventStatus"),n("ExternalId"),u("Birthdate")]),t.rfc("PLParticipant",[n("Guid"),n("EventGuid"),n("EmailAddress"),n("CommonName"),u("RecurrenceId"),r("ParticipantType"),r("Role"),r("Status"),i("IsOrganizer"),i("RsvpExpected"),e("DelegatedFrom"),e("DelegatedTo"),n("InternalUserId"),n("LastResponseType"),u("LastResponseDate"),u("LastSentDate"),i("HasError"),u("LastModified"),n("UserId")]),t.rfc("PLSaveCalendarResult",[f(t.BusinessLogicCalendar,"Calendar"),e("Events")]),t.rfc("PLStubEvent",[n("Guid"),u("DateStart"),u("DateEnd"),u("CustomTZStartDate"),u("CustomTZEndDate"),i("EventTimeInUserTimeZone"),i("StartTimeTZNum"),i("EndTimeTZNum"),n("CalendarGuid"),n("CharmId"),n("BirthdaySourceId"),n("ExternalId"),n("Summary"),n("Description"),n("Location"),r("FreeBusyStatus"),r("Visibility"),i("Priority"),i("IsAllDayEvent"),u("RecurrenceId"),r("EventProgress"),u("CompletedDate"),u("CreatedDate"),r("ItemType"),n("ParentGuid"),n("RecurrenceDescription"),i("IsRecurrenceException"),e("Categories"),e("Participants"),f(t.PLParticipant,"Organizer"),f(t.PLMROperationInfo,"MeetingRequestOperation"),r("MeetingRequestMode"),i("IsDraft"),r("IcsEventStatus")]),t.FppStatus=new $Flags("SUCCESS",0,"ERR_HTTP_MISCONFIGURATION",-7,"ERR_HTTP_PARSE_FAILURE",-6,"ERR_HTTP_CONNECT_FAILURE",-5,"ERR_HTTP_TIMEOUT",-4,"ERR_SERVER_UNCAUGHT",-3,"ERR_APP_SPECIFIC",-2,"ERR_FPP_PROTOCOL",-1),t.rfc("FppError",[n("ErrorCode"),n("Message"),s("ErrorObj"),n("StackTrace")]),t.rfc("FppReturnPackage",[r("Status"),s("Value"),h("OutRefParams"),f(t.FppError,"Error"),s("ProfilingInfo")]),t.FppCommandType=new $Flags("FPP",0,"FPP_JSON",1,"FPP_RP",2,"FPP_RP_JSON",3),t.FppVersion=new $Flags("BASE",0,"ONE",1,"TWO",2,"CURRENT",2),t.rfc("FppProxySettings",[r("Version"),r("CommandType"),n("PartnerId"),n("SessionId"),n("AuthUser"),n("ServerTunnelingUrl"),i("UseClientXmlProxy"),n("CanaryToken"),i("DefaultRetry"),i("Notify"),r("DateType")]),t.FppDateType=new $Flags("Local",0,"UTC",1),t.rfm("GetCalendarSharingSettings",[n("guid")],"GetCalendarSharingSettings",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("SaveBirthdayEvent",[n("contactId"),n("firstName"),n("lastName"),u("birthdate"),e("alarms"),n("charmId"),i("isCalendarVisibleToUser"),u("windowStart"),u("windowEnd")],"SaveBirthdayEvent",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("RefreshCalendar",[n("guid"),i("isCalendarVisibleToUser"),u("windowStart"),u("windowEnd")],"RefreshCalendar",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("SaveCalendarSettings",[n("guid"),n("name"),i("colorIndex"),n("description"),i("enableSummaryReminders"),n("charmId"),i("getEvents"),u("windowStart"),u("windowEnd"),r("calendarType")],"SaveCalendarSettings",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("SaveCalendarSettingsWithDefaultReminders",[n("guid"),n("name"),i("colorIndex"),n("description"),i("enableSummaryReminders"),n("charmId"),i("getEvents"),u("windowStart"),u("windowEnd"),r("calendarType"),e("defaultReminders"),i("ignoreDefaultReminders"),n("changeNotificationModalityGuid"),i("updateChangeNotification")],"SaveCalendarSettingsWithDefaultReminders",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("SetCalendarColor",[n("guid"),i("colorIndex")],"SetCalendarColor",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("SaveCalendarSharingSettings",[n("guid"),i("memberSharingEnabled"),i("privateUrlSharingEnabled"),r("privateVisibility"),e("addMembers"),e("updateMembers"),e("deleteMembers"),i("timeZoneNum"),r("taskPermissionLevel")],"SaveCalendarSharingSettings",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("RespondToExchangeSharingRequest",[n("calendarGuid"),r("permission"),n("message"),n("emailId"),i("isAccepted")],"RespondToExchangeSharingRequest",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("ReorderCalendar",[n("guid"),i("order")],"ReorderCalendar",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("SetLastDisplayView",[r("lastDisplayView")],"SetLastDisplayView",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("ClearAllCompletedTasks",[f("blTasksQueryObj")],"ClearAllCompletedTasks",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("GetCalendarById",[n("calendarId"),i("getSharingPermissionLevels")],"GetCalendarById",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("GetBootstrapPackage",[u("startPeriod"),u("endPeriod")],"GetBootstrapPackage",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("DoPostBootstrapTasks",[u("startPeriod"),u("endPeriod")],"DoPostBootstrapTasks",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("GetEventWithRange",[n("calendarId"),n("eventId"),u("windowStart"),u("windowEnd")],"GetEventWithRange",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("GetEvent",[n("calendarId"),n("eventId")],"GetEvent",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("HandleFirstRunExperience",[i("timeZone"),i("isLegacyUser")],"HandleFirstRunExperience",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("SaveEvent",[f("eventToBeSaved"),i("isCalendarVisibleToUser"),u("windowStart"),u("windowEnd"),f("tasksQuery")],"SaveEvent",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("SaveEventWithStubResult",[f("eventToBeSaved"),i("isCalendarVisibleToUser"),u("windowStart"),u("windowEnd"),f("tasksQuery")],"SaveEventWithStubResult",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("SaveRecurringEvent",[f("plEvent"),i("editSeries"),i("deleteExceptions"),r("convertEnum"),i("isCalendarVisibleToUser"),u("windowStart"),u("windowEnd"),f("taskQuery")],"SaveRecurringEvent",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("SaveRecurringEventWithStubResult",[f("plEvent"),i("editSeries"),i("deleteExceptions"),r("convertEnum"),i("isCalendarVisibleToUser"),u("windowStart"),u("windowEnd"),f("taskQuery")],"SaveRecurringEventWithStubResult",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("UpdateEventWithStubResult",[f("eventToBeSaved"),e("fieldspec"),u("windowStart"),u("windowEnd")],"UpdateEventWithStubResult",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("DeleteRecurringEvent",[f("plEvent"),i("deleteSeries")],"DeleteRecurringEvent",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("DeleteEvent",[n("calendarId"),n("eventGuid"),f("meetingrequestOperation")],"DeleteEvent",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("DeleteBirthdayEvent",[n("calendarId"),n("eventGuid")],"DeleteBirthdayEvent",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("UpdateEventAlarms",[f("eventToUpdate")],"UpdateEventAlarms",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("GetNotificationUserPreferences",[],"GetNotificationUserPreferences",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("SetNotificationUserPreferences",[i("notificationsEnabled"),i("smsEnabled")],"SetNotificationUserPreferences",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("SaveCalendarFormData",[f("calendarToBeSaved"),e("contactOperations"),e("groupOperations"),f("publishingSettings")],"SaveCalendarFormData",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("DeleteCalendar",[n("calendarId")],"DeleteCalendar",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("GetEventsByDateTimeAndCalendars",[e("calendarGuids"),f("tasksQuery"),u("startPeriod"),u("endPeriod")],"GetEventsByDateTimeAndCalendars",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("GetEventsByDateTimeAndCalendarsWithStubResult",[e("calendarGuids"),f("tasksQuery"),u("startPeriod"),u("endPeriod")],"GetEventsByDateTimeAndCalendarsWithStubResult",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("PollCalendarEventsByDateTime",[n("calendarId"),u("startPeriod"),u("endPeriod")],"PollCalendarEventsByDateTime",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("GetTasks",[f("tasksQueryParams")],"GetTasks",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("GetSubscriptionCalendarInfo",[n("calendarId")],"GetSubscriptionCalendarInfo",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("SetCalendarVisible",[n("calId"),u("startPeriod"),u("endPeriod"),f("taskQuery")],"SetCalendarVisible",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("SetCalendarInvisible",[n("calId"),f("taskQuery")],"SetCalendarInvisible",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("PublishingGetCalendarSettings",[n("calendarId")],"PublishingGetCalendarSettings",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("PublishingSaveCalendarSettings",[n("calendarId"),f("settings")],"PublishingSaveCalendarSettings",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("PublishingResetCalendarPrivateId",[n("calendarId")],"PublishingResetCalendarPrivateId",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("PublishingGetProposedUserName",[],"PublishingGetProposedUserName",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("PublishingSaveUserName",[n("userName")],"PublishingSaveUserName",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("PublishingResetCalendarPrivateFreeBusyId",[n("calendarId")],"PublishingResetCalendarPrivateFreeBusyId",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.rfm("PublishingResetCalendarPrivateDetailId",[n("calendarId")],"PublishingResetCalendarPrivateDetailId",$Network.Type.XMLPost,null,"Microsoft.Live.Calendar.FppPresentation.ServiceProxy"),t.seal(),t}),registerNamespace("Calendar"),Calendar.Date=function(n,t,i,r,u,f){var o,e,s;this._isEndOfDay=!1,o=arguments.length;switch(o){case 0:e=new Date,Calendar.Date.remoteNowTime?(s=e.getTime()-Calendar.Date.clientStartTime,this.JSDate=new Date(Calendar.Date.remoteNowTime+s)):this.JSDate=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));break;case 1:this.JSDate=new Date(n);break;case 3:this.JSDate=new Date(Date.UTC(n,t,i));break;case 4:this.JSDate=new Date(Date.UTC(n,t,i,r));break;case 5:this.JSDate=new Date(Date.UTC(n,t,i,r,u));break;case 6:this.JSDate=new Date(Date.UTC(n,t,i,r,u,f))}},Calendar.Date.prototype.valueOf=function(){return this.JSDate.valueOf()},Calendar.Date.prototype.toString=function(){var n=this.JSDate.getUTCMinutes(),t;return n<10&&(n="0"+n),t=this.JSDate.getUTCSeconds(),t<10&&(t="0"+t),this.JSDate.getUTCDate()+" "+Calendar.Date.AbbreviatedMonthNames[this.JSDate.getUTCMonth()]+" "+this.JSDate.getUTCFullYear()+" "+this.JSDate.getUTCHours()+":"+n+":"+t},Calendar.Date.prototype.toISO8601=function(){var r="{0}-{1}-{2}T{3}:{4}:{5}",n=this.getHours(),t=this.getMinutes(),i=this.getSeconds();return n<10&&(n="0"+n),t<10&&(t="0"+t),i<10&&(i="0"+i),r.format(this.getFullYear(),this.getMonth()+1,this.getDate(),n,t,i)},Calendar.Date.prototype.setHours=function(n,t,i,r){return arguments.length==1?this.JSDate.setUTCHours(n):arguments.length==2?this.JSDate.setUTCHours(n,t):arguments.length==3?this.JSDate.setUTCHours(n,t,i):arguments.length==4&&this.JSDate.setUTCHours(n,t,i,r),this},Calendar.Date.prototype.setTime=function(n){this.JSDate.setTime(n)},Calendar.Date.prototype.setMinutes=function(n){this.JSDate.setUTCMinutes(n)},Calendar.Date.prototype.setDate=function(n,t,i){arguments.length==1?this.JSDate.setUTCDate(n):arguments.length==3&&(this.JSDate.setUTCDate(1),this.JSDate.setUTCFullYear(n),this.JSDate.setUTCMonth(t),this.JSDate.setUTCDate(i))},Calendar.Date.prototype.setMonth=function(n){this.JSDate.setUTCMonth(n)},Calendar.Date.prototype.setYear=function(n){this.JSDate.setUTCFullYear(n)},Calendar.Date.prototype.getTime=function(){return this.JSDate.getTime()},Calendar.Date.prototype.getHours=function(){return this.JSDate.getUTCHours()},Calendar.Date.prototype.getMinutes=function(){return this.JSDate.getUTCMinutes()},Calendar.Date.prototype.getDay=function(){return this.JSDate.getUTCDay()},Calendar.Date.prototype.getMonth=function(){return this.JSDate.getUTCMonth()},Calendar.Date.prototype.getDate=function(){return this.JSDate.getUTCDate()},Calendar.Date.prototype.getSeconds=function(){return this.JSDate.getUTCSeconds()},Calendar.Date.prototype.getYear=function(){return this.JSDate.getUTCFullYear()},Calendar.Date.prototype.getFullYear=function(){return this.JSDate.getUTCFullYear()},Calendar.Date.prototype.moveToEndOfDay=function(){if(!this.isEndOfDay()){this.moveToStartOfDay();var n=this.JSDate.getTime();this.setTime(n+1*Calendar.Date.MillesecondsInADay),this._isEndOfDay=!0}return this},Calendar.Date.prototype.moveToStartOfDay=function(){if(this.isEndOfDay()){var n=this.JSDate.getTime();this.setTime(n-1*Calendar.Date.MillesecondsInADay),this._isEndOfDay=!1}return this.JSDate.setUTCHours(0,0,0,0),this},Calendar.Date.prototype.isStartOfDay=function(){return this.getHours()==0&&this.getMinutes()==0&&this.getSeconds()==0},Calendar.Date.prototype.isEndOfDay=function(){return this._isEndOfDay},Calendar.Date.prototype.getDatePart=function(){var n=this.clone();return n.moveToStartOfDay(),n},Calendar.Date.prototype.moveToEndOfCalendarMonth=function(){var n=Calendar.Date.getDaysInMonth(this.getFullYear(),this.getMonth());this.setDate(n),this.moveToEndOfWeek()},Calendar.Date.prototype.moveToEndOfWeek=function(){this.moveToStartOfDay();var n=Calendar.Date.FirstDayOfWeek-1-this.getDay();n<0&&(n+=Calendar.Date.NumberOfDaysInWeek),this.setTime(this.getTime()+n*Calendar.Date.MillesecondsInADay),this.moveToEndOfDay()},Calendar.Date.prototype.moveToStartOfWeek=function(){this.moveToStartOfDay();var n=this.getDay()-Calendar.Date.FirstDayOfWeek;n<0&&(n+=Calendar.Date.NumberOfDaysInWeek),this.setTime(this.getTime()-n*Calendar.Date.MillesecondsInADay)},Calendar.Date.prototype.moveToSameDateOfTargetMonth=function(n,t){var i=Calendar.Date.getDaysInMonth(n,t),r=this.getDate(),u=new Calendar.Date(n,t,r>i?i:r);this.JSDate.setTime(u.getTime())},Calendar.Date.prototype.isEqual=function(n){return this.JSDate.getTime()==n.getTime()},Calendar.Date.prototype.addMinutes=function(n){var i=this.JSDate.getTime(),t=this.clone();return t.setTime(i+n*Calendar.Date.MillesecondsInAMinute),t},Calendar.Date.prototype.addDays=function(n){var i=this.JSDate.getTime(),t=this.clone();return t.setTime(i+n*Calendar.Date.MillesecondsInADay),t},Calendar.Date.prototype.addMonths=function(n){var i=this.getMonth()+n,t=this.clone();return t.setMonth(i),t},Calendar.Date.prototype.addTime=function(n){var i=this.getHours()+n.getHours(),r=this.getMinutes()+n.getMinutes(),u=this.getSeconds()+n.getSeconds(),t=this.clone();return t.setHours(i,r,u),t},Calendar.Date.prototype.isToday=function(){var n=new Calendar.Date;return this.isSameDayAs(n)},Calendar.Date.prototype.isSameDayAs=function(n){var t=this.JSDate.getTime(),i=n.getTime(),r;return this._isEndOfDay&&t--,n.isEndOfDay()&&i--,r=Calendar.Date.MillesecondsInADay,Math.abs(t-i)<=r&&Math.floor(t/r)==Math.floor(i/r)},Calendar.Date.prototype.isBetween=function(n,t){return this.JSDate.valueOf()>=n.valueOf()&&this.JSDate.valueOf()<=t.valueOf()?!0:!1},Calendar.Date.prototype.clone=function(){var n=new Calendar.Date(this.JSDate.valueOf());return n._isEndOfDay=this._isEndOfDay,n},Calendar.Date.prototype.setClosestHalfHour=function(){var n=this.getMinutes(),t;t=n>30?60-n:n>1?30-n:0,this.setTime(this.getTime()+t*6e4)},Calendar.Date.prototype.toCompactTimeString=function(){return Calendar.Date.Is24HourTimeFormat||this.getMinutes()!=0?this.toShortTimeString():this.toHourString()},Calendar.Date.prototype.isTomorrow=function(){var n=new Calendar.Date;return this.isSameDayAs(n.addDays(1))},Calendar.Date.prototype.isYesterday=function(){var n=new Calendar.Date;return this.isSameDayAs(n.addDays(-1))},Calendar.Date.setCustomNowRemoteTime=function(n,t){Calendar.Date.remoteNowTime=n,Calendar.Date.clientStartTime=(new Date).getTime()-t},Calendar.Date.isRangeMultipleDays=function(n,t){var i=t.valueOf(),r=n.valueOf(),u=!0;return i!=r&&(i--,u=Math.floor(r/Calendar.Date.MillesecondsInADay)==Math.floor(i/Calendar.Date.MillesecondsInADay)),!u},Calendar.Date.datesAreEqual=function(n,t){return n!=null&&t!=null&&n.valueOf()==t.valueOf()&&n.isEndOfDay()==t.isEndOfDay()},Calendar.Date.timesAreEqual=function(n,t){return n!=null&&t!=null&&n.getHours()==t.getHours()&&n.getMinutes()==t.getMinutes()&&n.getSeconds()==t.getSeconds()},Calendar.Date.min=function(n,t){return t.valueOf()<n.valueOf()?t:n},Calendar.Date.max=function(n,t){return t.valueOf()>n.valueOf()?t:n},Calendar.Date.combineDateAndTime=function(n,t){var i=n.clone();return i.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),0),i},Calendar.Date.parseDate=function(n){var o=Calendar.Date,v="[\\s"+o.DateSeparator+"]+",c=new RegExp(v),i=n.split(c),f=o.ShortDatePattern.toLowerCase().split(c),t,y,r,s,h,e;if(i.length!=f.length)return null;if(t=o.parseDate.componentIndexes,y=0,!t)for(t={},r=0;r<f.length;r++)switch(f[r].charAt(0)){case"y":for(t.year=r,s=1;f[r].charAt(s)=="y";)s++;y=s;break;case"m":t.month=r;break;case"d":t.day=r}if(isNaN(parseInt(i[t.year]))||isNaN(parseInt(i[t.month]))||isNaN(parseInt(i[t.day])))return null;var l=i[t.month]-1,a=new Number(i[t.day]),u=parseInt(i[t.year],10);return u<0?null:(u<100&&(h=2029,u+=h-h%100,u>h&&(u-=100)),e=new Calendar.Date(u,l,a),u!=e.getYear()||l!=e.getMonth()||a!=e.getDate())?null:e},Calendar.Date.parseTime=function(n){var o=Calendar.Date,t=n.toLowerCase(),l=o.AMDesignator.toLowerCase(),a=o.PMDesignator.toLowerCase(),i="a",r="p",u,f,s=o.TimeSeparator,h=function(n,t,e){var s=new Calendar.Date,o=Number(n[1]),h=0;return n.length-1==e&&n[e]&&(u=n[e]==i,f=n[e]==r),o<12&&f?o+=12:o==12&&u&&(o=0),t&&(h=Number(n[2])),s.setHours(o,h,0,0),s},c=[{pat:"(\\d{1,2})"+s+"(\\d{1,2})"+s+"(\\d{1,2})\\s*(["+i+r+"])*",handler:function(n){return h(n,!0,4)}},{pat:"(\\d{1,2})"+s+"(\\d{1,2})\\s*(["+i+r+"])*",handler:function(n){return h(n,!0,3)}},{pat:"(\\d{1,2})\\s*(["+i+r+"])*",handler:function(n){return h(n,!1,2)}}],e,v;for(u=t.indexOf(l)>=0,f=t.indexOf(a)>=0,u&&(t=t.replace(l,"")),f&&(t=t.replace(a,"")),e=0;e<c.length;e++)if(v=new RegExp(c[e].pat).exec(t),v)return c[e].handler(v);return null},Calendar.Date.getLongTimeSpanString=function(n){var t=Calendar.Date.Strings,i;if(n>=60){var r=n/60,u=Math.floor(r),f=Math.floor((r-u)*10),e=f?"{0}{3}{2} {1}":"{0} {1}";i=e.format(u,r==1?t.Hour:t.Hours,f,t.DecimalSeperator)}else i=n+" "+(n==1?t.Minute:t.Minutes);return i},Calendar.Date.average=function(n,t){var r=Math.abs(Calendar.Date.getDayDifference(n,t)),i=new Calendar.Date(Math.min(n,t));return i=i.addDays(r/2)},Calendar.Date.getDaysInMonth=function(n,t){var i=31;switch(t){case 3:case 5:case 8:case 10:i=30;break;case 1:i=n%4==0&&n%100!=0||n%400==0?29:28}return i},Calendar.Date.getWeeksInMonth=function(n){var t=Calendar.Date.getDaysInMonth(n);return Math.ceil((t+n.getDay())/Calendar.Date.NumberOfDaysInWeek)},Calendar.Date.getDayDifference=function(n,t){return Math.floor((t.getTime()-n.getTime())/Calendar.Date.MillesecondsInADay)},Calendar.Date.getMinuteDifference=function(n,t){return(t.getTime()-n.getTime())/6e4},Calendar.Date.getTotalDaySpan=function(n,t){var r=new Calendar.Date(n),i=new Calendar.Date(t),f=i.isStartOfDay()?0:1,u;return r.moveToStartOfDay(),i.moveToStartOfDay(),u=Calendar.Date.getDayDifference(r,i)+f,u==0?1:u},Calendar.Date.createTimeSpan=function(n,t){var r={},i=Calendar.Date.getMinuteDifference(n,t),u=Math.floor(i/1440),f,e;return i-=u*1440,f=Math.floor(i/60),i-=f*60,e=Math.floor(i),r.days=u,r.hours=f,r.minutes=e,r},Calendar.Date.getRangeOfMonth=function(n){var t=new Calendar.Date(n.getFullYear(),n.getMonth(),1),r=Calendar.Date.getDaysInMonth(t.getFullYear(),t.getMonth()),i=new Calendar.Date(n.getFullYear(),n.getMonth(),r);return t.moveToStartOfDay(),i.moveToEndOfDay(),{StartDate:t,EndDate:i}},Calendar.Date.getRangeOfCalendarMonth=function(n){var t=Calendar.Date.getRangeOfMonth(n);return t.StartDate.moveToStartOfWeek(),t.EndDate.moveToEndOfWeek(),{StartDate:t.StartDate,EndDate:t.EndDate}},Calendar.Date.getHalfHourIndex=function(n){if(n.isEndOfDay())return 48;var t=n.getMinutes();return Math.floor(n.getHours()*2+t/30)},Calendar.Date.getDateIntersection=function(n,t,i,r){var u=n.valueOf(),f=t.valueOf(),e=i.valueOf(),o=r.valueOf(),s,h;return u>=o||e>=f?null:(s=u>e?n:i,h=f>o?r:t,{start:s,end:h})},Calendar.Date.getMarketHourString=function(n){var t=""+new Calendar.Date(2001,1,1,n,0,0).toHourString();return Calendar.Date.Is24HourTimeFormat&&t.lastIndexOf("時")==t.length-1?t.substring(0,t.length-1):t},Calendar.Date.tryGetFriendlyDateString=function(n,t){var h=n.isSameDayAs(t.getDatePart()),i,r,u;if(h)i=n.isToday()?Calendar.Date.Strings.Today:n.isTomorrow()?Calendar.Date.Strings.Tomorrow:n.isYesterday()?Calendar.Date.Strings.Yesterday:Calendar.Date.DayNames[n.getDay()];else{r=new Calendar.Date,u=new Calendar.Date,r.moveToStartOfWeek(),u.moveToEndOfWeek();var f=r.addDays(Calendar.Date.NumberOfDaysInWeek),e=u.addDays(Calendar.Date.NumberOfDaysInWeek),o=r.addDays(-1*Calendar.Date.NumberOfDaysInWeek),s=u.addDays(-1*Calendar.Date.NumberOfDaysInWeek);i=n.isBetween(r,u)&&t.isBetween(r,u)?Calendar.Date.Strings.ThisWeek:n.isBetween(f,e)&&t.isBetween(f,e)?Calendar.Date.Strings.NextWeek:n.isBetween(o,s)&&t.isBetween(o,s)?Calendar.Date.Strings.LastWeek:n.getMonth()===t.getMonth()?n.toYearMonthString():n.toYearMonthString()+" - "+t.toYearMonthString()}return i},Calendar.Date.NumberOfDaysInWeek=7,Calendar.Date.MillesecondsInADay=864e5,Calendar.Date.MinutesInADay=1440,Calendar.Date.SecondsInADay=86400,Calendar.Date.MillesecondsInAMinute=6e4,$Do.register("$DCReady"),registerNamespace("Calendar"),function(){function n(n,t){var i=this;i.render=function(){var i,r;return t=t||m_pStrings.spinner.loading,i=$f&&$f.createLoading({returnMarkup:!0,useTransparentFallback:!0,text:t}),i&&(r=jQuery(i),n&&n.append(r),$f.showLoading(r)),i}}wLive.Controls.LoadingSpinner=n}(),function(){function n(n){function r(t){return $ic.ic.createICFromTemplate(n,0,0,0,n,0,0,t||"",t||"","",0,"",0,0,1,0)}function u(t){return $ic.ic.createICFromTemplate(n,0,0,0,n,t.getHexCid(),t.getCid(),t.getOrderedName(),f(t),e(t),t.getUserTileMedium(),"",0,0,1,0)}function f(n){return n.getPassportMemberName()||n.getPersonalEmail()||n.getWorkEmail()||n.getOtherEmail()||""}function e(n){var i=n.getContacts(),r="",t,f,u;if(i)for(t=0;t<i.length;t++)if(f=$WLXContacts.getContactHelper(n.getCurrent(),t),u=f.getMri(),u){r=u[0];break}return r}function o(i,r){var u=jQuery("#"+i),f,e;r?u.html(r.html):(f=$WLXContacts.getPerson(contactId),f&&(e=t.renderStaticIc($WLXContacts.getPersonHelper(f),n),u.html(e.html)))}function s(n){var t=$WLXContacts.getPersonHelper(n),r=t.getUserTileMedium(),u;r&&(u=i[t.getId()],u&&$ic.ic.replaceUserTile(u,r))}var t=this,i={};t.render=function(t,f,e){var h=null,l,c,a;t&&(t=t.toLowerCase(),l=$WLXContacts.getPerson(t),l?(c=$WLXContacts.getPersonHelper(l),a=!!(c.getHexCid()&&c.getCid()),a?$ic.ic.createICsFromCids(n,[[c.getCid(),f]],o,!0):(e&&$WLXContacts.getPersonDetails(t,s),h=u(c),i[c.getId()]=h.id,jQuery("#"+f).html(h.html))):(h=r(t),jQuery("#"+f).html(h.html)))}}Calendar.ICHelper=n}(),Calendar.createWatermarkedInput=function(n,t,i){var r=null,u=jQuery(n),f;return u.addClass("WatermarkedInput"),$B&&$B.IE&&$B.V<10?(f=jQuery("<div><\/div>").addClass("WatermarkedInputContainer"),r=jQuery("<div><\/div>").text(t).addClass("Watermark").click(function(){u.focus()}),i&&r.addClass(i),u.wrap(f).after(r).focus(function(){r.hide()}).blur(function(){var n=jQuery(this);n.val()===""&&r.show()}).change(function(){var n=jQuery(this);r.toggle(n.val()==="")}),u.change()):(u.attr("placeholder",t),r=u),u.attr("aria-label",t),r},fontControlDiv=null,Array.prototype.findInsertLoc=function(n,t){for(var r=0,u=this.length-1,i=0,f;r<=u;){if(i=Math.floor((u+r)/2),f=t(n,this[i]),f==0)return i;f<0?u=i-1:(r=i+1,i++)}return i},String.prototype.clip=function(n){return this.length>n?this.substr(0,n)+"...":this},String.isNullOrEmpty=function(n){return n==null||n==""},ReadOnlyModel=function(n){var t=n;this.$=function(){return t.$()},this.attachEvent=function(n,i){jQuery(t).bind(n,i)},this.detachEvent=function(n,i){jQuery(t).unbind(n,i)},this.hasBirthdayCalendar=n.hasBirthdayCalendar,this.getCalendarCharmId=n.getCalendarCharmId,this.getCalendarVisibility=n.getCalendarVisibility,this.getCalendar=n.getCalendar,this.getCachedEvent=n.getCachedEvent},ImageStrip=function(n){var t=this;t.getImage=function(t,i,r){var e=gImageStripConfig[t],o="",f,s;return e&&(f=e.split(","),s=$IS.Create(f[0],f[1],f[2],f[3],gTopLevelImagePath,m_pImagePath+n,i,r),s&&(o=s.outerHTML)),o}},Calendar.BICITrackingManager=function(){var n=this;n.m_defaults={attributes:{IsGroup:0},kind:"Click"},n.m_actions={EventQuickAddFromGridAddLink:{id:"QuickAddEvent"},EventQuickAddMoreDetailsLink:{id:"QuickAddEventDetails"},FullScreenEventEdit:{id:"EditEvent",kind:"View"},ToolbarAddEventButton:{id:"ToolbarAddEvent"},AgendaView:{kind:"View"},DayView:{kind:"View"},TraditionalMonthView:{id:"MonthView",kind:"View"},TraditionalWeekView:{id:"WeekView",kind:"View"},TaskView:{kind:"View"},EventPartialDayMonthGridSave:{id:"QuckAddEventSave"},MiniCalClickEvent:{id:"MiniCalDay"},SetExplicitEventCharm:{id:"EventCharm",kind:"Set"},SetCalendarCharm:{id:"CalendarCharm",kind:"Set"},ClearBirthdayCalendarCharm:{id:"BirthdayCalendarCharm",kind:"Clear"},CommittedInlineAddTask:{id:"InlineAddTask",kind:"Committed"},DayWeekGridPagination:{id:"GridPagination"},MonthGridPagination:{id:"GridPagination"},MonthDateClicked:{id:"MonthDate"},WeekDateClicked:{id:"WeekDate"},WeatherEventPreview:{kind:"View"}},n.m_groupModeDefaults={attributes:{IsGroup:1}},n.m_groupModeActions={},n.init=function(t){return t&&(jQuery.extend(n.m_defaults,n.m_groupModeDefaults),jQuery.extend(n.m_actions,n.m_groupModeActions)),this},n.trackAction=function(t,i,r){var o;if(t){var f=n.m_defaults.kind,e=jQuery.extend({},n.m_defaults.attributes),u=n.m_actions[t];u&&(t=u.id||t,f=u.kind||f,u.attributes&&jQuery.extend(e,u.attributes)),r&&jQuery.extend(e,r),o=(i||f)+"."+t,$BSI.reportEvent(o,e)}}},Calendar.DragDrop=function(){},Calendar.DragDrop.DragType=new $Enum("Move","TopResize","BottomResize"),Calendar.DragDrop.onEventDragEnd=function(n,t,i,r){jQuery(n).unbind("mousemove",t),document.body.style.cursor="auto",jQuery(i).trigger("drageventended",r)},Calendar.cloneObject=function(n){var t={},i;for(i in n)t[i]=n[i];return t},Calendar.CommandBar=function(n){function f(){t.newMenu=jQuery("#CB_NewItem").parent(),t.importButton=jQuery("#CB_Import").parent(),t.shareMenu=jQuery("#CB_Share").parent(),t.deleteButton=jQuery("#CB_Delete").parent(),t.replyMenu=jQuery("#CB_Reply").parent(),t.acceptMeetingMenu=jQuery("#CB_Accept").parent(),t.tentativeMeetingMenu=jQuery("#CB_Tentative").parent(),t.declineMeetingMenu=jQuery("#CB_Decline").parent(),t.messageToAllButton=jQuery("#CB_MessageToAll").parent(),t.viewRSSButton=jQuery("#CB_ViewRSS").parent(),t.viewICSButton=jQuery("#CB_ViewICS").parent(),t.newBirthdayEvent=jQuery("#CB_BirthdayEvent").parent(),t.newBirthdayCalendar=jQuery("#CB_BirthdayCalendar").parent(),jQuery("#c_cof").attr("title",getContentStrings().commandBar.feedbackTitle),i&&i.$().bind("viewnav_viewchanged.cb",s)}function e(){var n=!!getSetting("publishedUrlBase");t.newMenu.toggle(!n),t.importButton.toggle(!n),t.shareMenu.toggle(!n),t.viewRSSButton.toggle(n),t.viewICSButton.toggle(n)}function u(){t.deleteButton.toggle(!0)}function o(){t.newMenu.toggle(!1),t.importButton.toggle(!1),t.shareMenu.toggle(!1),t.deleteButton.toggle(!1),t.replyMenu.toggle(!1),t.acceptMeetingMenu.toggle(!1),t.tentativeMeetingMenu.toggle(!1),t.declineMeetingMenu.toggle(!1),t.messageToAllButton.toggle(!1),t.viewRSSButton.toggle(!1),t.viewICSButton.toggle(!1)}function s(n,i){o();switch(i){case CAL.DisplayView.MonthView:case CAL.DisplayView.WeekView:case CAL.DisplayView.DayView:case CAL.DisplayView.AgendaView:case CAL.DisplayView.TaskView:e();break;case CAL.DisplayView.EditEventView:u(),t.updateDeleteTooltip(m_pStrings.commandBar.deleteEventTooltip);break;case CAL.DisplayView.EditTaskView:u(),t.updateDeleteTooltip(m_pStrings.commandBar.deleteToDoTooltip);break;case CAL.DisplayView.CalendarGeneralSettingsView:t.updateDeleteTooltip(m_pStrings.commandBar.deleteCalendarTooltip)}}var h=0,c=1,r=2,t=this,i=n;t.dispose=function(){i&&i.$().unbind(".cb")},t.addCalendar=function(n){var o,u,f,e,i,s,h;if(Calendar.Event.isBirthdayCalendar(n))t.newBirthdayEvent.toggle(!0),t.newBirthdayCalendar.toggle(!1);else if(Calendar.Event.isCalendarOwnedOrCoOwned(n)){if(o=$CommandBar.getDataModel().getItemByIndex(r),u=wLive.Controls.NavLink.create({html:n.Name.encodeHtml(),id:""}),jQuery(u._$a).attr("cpm",n.Guid),jQuery(u._$a).attr("cmd","ShareCalendar"),f=o._items,e=f.length,n.IsDefaultCalendar)e=0;else for(i=1;i<f.length;i++)if(s=f[i]._$a.text().toLowerCase(),h=n.Name.toLowerCase(),s>h){e=i;break}o.add(u,e)}},t.removeCalendar=function(n,i){var f,e,u;if(i)t.newBirthdayEvent.toggle(!1),t.newBirthdayCalendar.toggle(!0);else for(f=$CommandBar.getDataModel().getItemByIndex(r),e=f._items,u=0;u<e.length;u++)if(e[u]._$a.attr("cpm")===n){f.remove(u);break}},t.updateCalendar=function(n){for(var u=$CommandBar.getDataModel().getItemByIndex(r),f=u._items,i=0;i<f.length;i++)if(f[i]._$a.attr("cpm")===n.Guid){u.remove(i),t.addCalendar(n);break}},t.updateDeleteTooltip=function(n){jQuery("#CB_Delete").attr("title",n)},f()},Calendar.CogMenu=function(n){function u(n,t){r(t),n.insertAfter(t),e(n)}function f(n,i){var r=jQuery("li[guid]",t),s=i.Name.toLowerCase(),f=null,o="",e;if(r.length===1)u(n,r[0]);else for(e=1;e<r.length;e++)if(f=r[e],o=jQuery("a",f).contents()[1].nodeValue.toLowerCase(),o>s){n.insertBefore(f);break}else if(e===r.length-1&&o<s){u(n,f);break}}function e(n){jQuery("span.c_ms",n).length||n.append(jQuery('<span class="c_ms"><\/span>'))}function r(n){jQuery("span.c_ms",n).remove()}var t=n,i=this;i.removeCalendar=function(n){var i=jQuery("li[guid='"+n+"']",t),u=i.attr("class");return r(i),jQuery(i,t).remove(),e(jQuery("li[guid]:last",t)),u!==undefined&&u.length&&jQuery("li[guid]",t).filter(":first").addClass(u),i},i.addCalendar=function(n){var i=jQuery("li[guid]",t).filter(":first").clone();i.removeClass(),r(i),i.attr("guid",n.Guid),jQuery("a",i).contents()[1].nodeValue=n.Name,jQuery("span",i).filter(":first").removeClass().addClass("is_c color"+n.ColorIndex),jQuery("img",i).filter(":first").removeClass("NotSelected"),f(i,n)},i.updateCalendar=function(n){var r=jQuery("li[guid='"+n.Guid+"'] a",t).filter(":first").contents()[1],u=r.nodeValue,e;r.nodeValue=n.Name,i.setCalendarColor(n.Guid,n.ColorIndex),u===n.Name||n.IsDefaultCalendar||(e=i.removeCalendar(n.Guid),f(e,n))},i.setCalendarColor=function(n,i){jQuery("li[guid='"+n+"'] span",t).filter(":first").removeClass().addClass("is_c color"+i)},i.showHideCalendarSelected=function(n,i){var r=jQuery("li[guid='"+n+"']",t);r.find("img").filter(":first").toggleClass("NotSelected",!i),r.find("a").filter(":first").removeClass("t_seli")},i.calendarExist=function(n){var i=jQuery("li[guid='"+n+"']",t);return i!==undefined&&i.length?!0:!1}},Calendar.isRRUSidePageRedirect=function(n){var t;switch(n){case Calendar.getViewNameFromEnum(CAL.DisplayView.ICalSubscription):case Calendar.getViewNameFromEnum(CAL.DisplayView.Options):case Calendar.getViewNameFromEnum(CAL.DisplayView.CodeOfConduct):case Calendar.getViewNameFromEnum(CAL.DisplayView.LegacyInterstitial):t=!0;break;default:t=!1}return t},Calendar.getViewNameFromEnum=function(n){var t="";switch(n){case CAL.DisplayView.MonthView:t="MonthView";break;case CAL.DisplayView.WeekView:t="WeekView";break;case CAL.DisplayView.DayView:t="DayView";break;case CAL.DisplayView.AgendaView:t="AgendaView";break;case CAL.DisplayView.TaskView:t="TaskView";break;case CAL.DisplayView.NewEventView:t="NewEventView";break;case CAL.DisplayView.ReadOnlyEventView:t="ReadOnlyEventView";break;case CAL.DisplayView.EditEventView:t="EditEventView";break;case CAL.DisplayView.NewTaskView:t="NewTaskView";break;case CAL.DisplayView.ReadOnlyTaskView:t="ReadOnlyTaskView";break;case CAL.DisplayView.EditTaskView:t="EditTaskView";break;case CAL.DisplayView.CalendarGeneralSettingsView:t="CalendarGeneralSettingsView";break;case CAL.DisplayView.CalendarSharingSettingsView:t="CalendarSharingSettingsView";break;case CAL.DisplayView.Options:t="Options";break;case CAL.DisplayView.CodeOfConduct:t="CodeOfConduct";break;case CAL.DisplayView.ICalSubscription:t="ICalSubscription";break;case CAL.DisplayView.LegacyInterstitial:t="LegacyInterstitial"}return t},Calendar.isEventOrTaskView=function(n){return n==CAL.DisplayView.MonthView||n==CAL.DisplayView.WeekView||n==CAL.DisplayView.DayView||n==CAL.DisplayView.AgendaView||n==CAL.DisplayView.TaskView},Calendar.NoDate="None",Calendar.NoTime="None",Calendar.EventFigureScaledHeight=function(){var n=29;return Math.round(Math.max(n,n*getFontRatio()))},BuildDurationString=function(n,t){var i=Calendar.Date.createTimeSpan(n,t),r=new $StringBuilder;return i.days==0&&i.hours==0&&i.minutes==0?(r.append("0"),r.append(window.minuteDesignator)):(i.days>0&&(r.append(i.days),r.append(window.dayDesignator)),i.hours>0&&(i.days>0&&r.append(" "),r.append(i.hours),r.append(window.hourDesignator)),i.minutes>0&&((i.hours>0||i.days>0)&&r.append(" "),r.append(i.minutes),r.append(window.minuteDesignator))),r.toString()},$Flags.prototype.valueToString=function(n){for(var t in this)if(this[t]==n)return t;return""},Calendar.EventGridHelper=function(){},Calendar.EventGridHelper.getCoveredGroupsFromRanges=function(n,t,i,r,u){for(var o=[],f=Math.floor(Calendar.Date.getDayDifference(i,n.StartDate)/u),s=Math.floor(Calendar.Date.getDayDifference(i,n.EndDate)/u),h=s-f+1,e=0;e<h;e++)o.push(f),f++;for(f=Math.floor(Calendar.Date.getDayDifference(i,t.StartDate)/u),s=Math.floor(Calendar.Date.getDayDifference(i,t.EndDate)/u),h=s-f+1,e=0;e<h;e++)o.contains(f)||o.push(f),f++;return o},Calendar.EventGridHelper.createEventElement=function(n,t,i,r,u,f,e,o,s){var y="inside",c=null,v,a,h,l;switch(i){case CAL.EventStatus.Tentative:c="url("+r+"strip_tentative-4.png)";break;case CAL.EventStatus.OOF:c="url("+r+"strip_opacity40-4.png)";break;case CAL.EventStatus.Free:c="url("+r+"strip_opacity60-4.png)"}return v="",s&&(v+=CharmsManager.getInstance().getCharm(s).render(!1,!1,!1,!1,!0)),a="",u&&(o&&(a+="<img class='LowPriIcon "+(f?"firstIcon":"oneIconOnly ")+"' src='"+r+"Lock_White_12.png'/>"),f&&(a+="<img class='LowPriIcon "+(o?"secondIcon":"oneIconOnly ")+"' src='"+r+(e?"Recurrence_Off_white_12.png":"Recurrence_white_12.png")+"'/>")),h=new $StringBuilder,h.append('<div class="'+y+'"'),h.append(">"+n+"<\/div>"),(a.length>0||s)&&(h.append('<div class="floatIcon">'),h.append(a),h.append(v),h.append("<\/div>")),h.append("<\/div>"),l=_ce("DIV"),l.innerHTML=h.toString(),c&&(l.className="strip",l.style.backgroundImage=c),(u||s)&&jQuery(".onlyEventText",l).removeClass("onlyEventText"),l},Calendar.EventGridHelper.updateEventAppearance=function(n,t,i){var u=n.childNodes[0],f=n.childNodes[1],o=u.className.indexOf("strip")>=0,r=null,e;i&&(u.style.height=i,i=="auto"&&(n.style.height="auto")),e=t?"selected ":"unselected ",r="inside inside-"+e,f&&(f.className="floatIcon floatIcon-"+e),o&&(t&&(r+=" inside-selected-strip"),r+=" strip"),u.className=r},Calendar.EventGridHelper.adjustEventTextWidth=function(n,t,i){var u=jQuery(n),s=u.find(".inside"),h=s.width(),f=u.find(".eventText"),e=0,c=parseInt(f.css("paddingLeft"))+parseInt(f.css("paddingRight")),o=u.find(".location"),b=o.outerWidth()||0,l=u.find(".floatIcon"),a=l.outerWidth(!0)||0,v=u.find(".timeIndicator").outerWidth(!0)||0,y=u.find(".inside > .Charm").outerWidth(!0)||0,r,p,w;return f.width(""),e=f.outerWidth()||0,r=h-v-y-a-c,p=e<r,t&&(i&&p?(w=r-e,o.width(r-e).css("display",w>0?"inline-block":"none"),r=""):o.toggle(!0)),r!==""&&f.width(r),r},NUMBER_OF_COLORS=12,Calendar.Weather=function(){function u(n){i&&($newScript(n,"weatherData",!1,!0,!1),$Do.register("ReadyForWeather"))}function r(n){return t()?t()[n]:null}function t(){return n&&n.Weather?n.Weather:null}function f(){getSetting("forecastRange")>0&&(n={},n.StartDate=new Calendar.Date,n.StartDate.moveToStartOfDay(),n.EndDate=n.StartDate.addDays(getSetting("forecastRange")-1),i=!0)}var i=!1,n=null;this.getStartDate=function(){return n.StartDate},this.getEndDate=function(){return n.EndDate},this.requestWeatherData=function(n){u(n)},this.isWeatherAvailable=function(){return n&&n.Weather},this.setWeatherData=function(t){t&&t.length&&(n.Weather=t,gController.doCommand("ProcessWeather"))},this.getTodaysWeather=function(){return r(0)},this.getForecast=function(n){return r(n)},this.getNumberOfForecastDays=function(){return t()?t().length:0},f()},__CALDESKTOPUTIL_LOADED=!0,registerNamespace("Calendar"),Calendar.MouseButton={LEFT:1,MIDDLE:2,RIGHT:3},Calendar.ErrorCodes=new $Flags("AbchDownRangeBegin",200,"AbchDownRangeEnd",299,"SubscriptionPending",300,"SubscriptionPollingDisabled",301,"FppRequestTimeout",-5,"HttpMisconfiguration",-7,"SessionTimedOut",358,"ServerErrorGetCalendarAlreadyDeleted",329,"ServerErrorGetEventAlreadyDeleted",331,"PermissionErrorEventNoReadPermissions",340,"SharingPermissionDenied",101),Calendar.NavigateWatcher=function(n){function c(){if(i){for(var n=0;n<i.length;n++)i[n].unbind(".csu");i=null}u=e=r=null,f=!1}function l(n){for(var t=n.target;t.nodeType===1&&t.tagName!=="A";)t=t.parentNode;if(t===r)return n.preventDefault(),!1}function a(n){for(var i=n.target;i.nodeType===1&&i.tagName!=="A";)i=i.parentNode;i.onclick&&(i.__onclick=i.onclick),v(i)&&(r=i,$menu.closeAll(),setTimeout(function(){if(e())t.navigateAway();else return n.preventDefault(),!1},0))}function v(n){var i,t;if(n&&n.tagName==="A"&&!y(n)){for(i=!0,t=0;t<o.length;t++)if(jQuery(n).hasClass(o[t])){i=!1;break}return i}return!1}function y(n){if(u)for(var t=0,i=u.length;t<i;t++)if(Dom.isRelation(u[t],n))return!0;return!1}var t=this,h=null;t.$=function(){return h||(h=jQuery(t))};var i=[],f=!1,e=null,u=null,r=null,o=["localAction"],s=gDefaulNavigateWatchedSelectors.clone();typeof gNavigateWatcherInvalidClassName!="undefined"&&o.addRange(gNavigateWatcherInvalidClassName),n&&s.addRange(n),t.enableWatcher=function(n,t){var r=0,o;if(!f&&n){for(o=null,r=0;r<s.length;r++)o=jQuery(s[r]),o.length>0&&(o.bind({"mousedown.csu":a,"click.csu":l}),i||(i=[]),i.push(o));f=!0,e=n,u=t}},t.navigateAway=function(){if(r){t.$().trigger("beforeNavigate");var n=r;t.disableWatcher(),n.click?n.click():n.__onclick?n.__onclick():n.target&&n.target.toLowerCase()==="_top"?window.setTimeout(function(){window.top.location.href=n.href},1):window.setTimeout(function(){window.location.href=n.href},1)}},t.cleanUpNavigation=function(){r=null},t.disableWatcher=function(){f&&c()},t.getSrcElement=function(){return r}},g_highestNamespaceId=0,Calendar.IdManager=function(n){function r(t,r,f){var s=i+t,h="#"+s,e=null,o=null;return r?(e=jQuery(r).find(h),o=e[0]):n?(e=u.find(h),o=e[0]):(o=_ge(s),f||(e=jQuery(o))),f?o:e}var t=this,u=n?jQuery(n):null,i="ns"+g_highestNamespaceId+"_";g_highestNamespaceId++,t.getId=function(n){return i+n},t.getIdTag=function(n){return" id='"+i+n+"' "},t.getForTag=function(n){return" for='"+i+n+"' "},t.getElement=function(n,t){return r(n,t,!0)},t.$getElement=function(n,t){return r(n,t,!1)}},Calendar.EFFECT_HANDLER_ATTRIBUTES_SUPPRESS_CAPTURE_HTML="onmouseover='javascript:handleButtonMouseEffectEvents(event, this, true);' onmouseout='javascript:handleButtonMouseEffectEvents(event, this, true);' onmousedown='javascript:handleButtonMouseEffectEvents(event, this, true);' onmouseup='javascript:handleButtonMouseEffectEvents(event, this, true);' ",Calendar.EFFECT_HANDLER_ATTRIBUTES_HTML="onmouseover='javascript:handleButtonMouseEffectEvents(event, this);' onmouseout='javascript:handleButtonMouseEffectEvents(event, this);' onmousedown='javascript:handleButtonMouseEffectEvents(event, this);' onmouseup='javascript:handleButtonMouseEffectEvents(event, this);' ";var _isTimingPLT=!1,PLT_TIMER_ID_POPUP_EVENT_EDITOR="QE",PLT_TIMER_ID_POPUP_TASK_EDITOR="QT",PLT_TIMER_ID_AJAX_UPCOMING_VIEW="U",PLT_TIMER_ID_AJAX_DAY_VIEW="D",PLT_TIMER_ID_AJAX_WEEK_VIEW="W",PLT_TIMER_ID_AJAX_MONTH_VIEW="M",PLT_TIMER_ID_AJAX_EDIT_EVENT_VIEW="EE",PLT_TIMER_ID_AJAX_EDIT_TASK_VIEW="ET";Calendar.FullEvent=function(){},Calendar.FullEvent.createNewEvent=function(){var n=new CAL.PLEvent;return n.Priority=0,n.SequenceNumber=0,n.IsDraft=!1,n.IsRecurrenceException=!1,n.Visibility=CAL.EventVisibility.Public,n.CreatedDate=new Calendar.Date,n},Calendar.FullEvent.cloneEvent=function(n){var t=null;return n!=null&&(t=Calendar.FullEvent.createNewEvent(),t.Guid=n.Guid,t.CalendarGuid=n.CalendarGuid,t.Summary=n.Summary,t.Description=n.Description,t.Location=n.Location,t.Url=n.Url,t.ParentGuid=n.ParentGuid,t.RecurrenceDescription=n.RecurrenceDescription,t.CacheEventId=n.CacheEventId,t.ExternalId=n.ExternalId,t.CharmId=n.CharmId,t.BirthdaySourceId=n.BirthdaySourceId,t.DateStart=n.DateStart?n.DateStart.clone():null,t.DateEnd=n.DateEnd?n.DateEnd.clone():null,t.CustomTZStartDate=n.CustomTZStartDate?n.CustomTZStartDate.clone():n.DateStart?n.DateStart.clone():null,t.CustomTZEndDate=n.CustomTZEndDate?n.CustomTZEndDate.clone():n.DateEnd?n.DateEnd.clone():null,t.RecurrenceId=n.RecurrenceId?n.RecurrenceId.clone():null,t.CreatedDate=n.CreatedDate?n.CreatedDate.clone():null,t.CompletedDate=n.CompletedDate?n.CompletedDate.clone():null,t.Birthdate=n.Birthdate?n.Birthdate.clone():null,t.StartTimeTZNum=n.StartTimeTZNum,t.EndTimeTZNum=n.EndTimeTZNum,t.SequenceNumber=n.SequenceNumber||t.SequenceNumber,t.Priority=n.Priority,t.EventProgress=n.EventProgress,t.EventTimeInUserTimeZone=n.EventTimeInUserTimeZone?n.EventTimeInUserTimeZone:!1,t.IsAllDayEvent=n.IsAllDayEvent,t.IsRecurrenceException=n.IsRecurrenceException,t.IsDraft=n.IsDraft,t.__isFppObject=n.__isFppObject,t.FreeBusyStatus=n.FreeBusyStatus,t.Visibility=n.Visibility,t.UserParticipationStatus=n.UserParticipationStatus,t.MeetingRequestMode=n.MeetingRequestMode,t.ItemType=n.ItemType,t.IcsEventStatus=n.IcsEventStatus,t.Calendar=Calendar.Event.Calendar.clone(n.Calendar),t.MapCoordinate=Calendar.Event.MapCoordinate.clone(n.MapCoordinate),t.Organizer=Calendar.Event.Participant.clone(n.Organizer),t.RecurrenceInfo=Calendar.Event.RecurrenceInfo.clone(n.RecurrenceInfo),t.MeetingRequestOperation=Calendar.Event.MeetingRequestOperation.clone(n.MeetingRequestOperation),t.Categories=Calendar.Event.cloneCategories(n.Categories),t.Participants=Calendar.Event.cloneParticipants(n.Participants),t.Alarms=Calendar.Event.cloneAlarms(n.Alarms)),t},Calendar.FullEvent.addAlarm=function(n,t,i,r,u,f,e){n.Alarms||(n.Alarms=[]);var o=new CAL.PLAlarm;o.AlarmType=t?t:CAL.PLCalendarAlarmType.Display,o.OffsetTime=i?i:0,i==CAL.ReminderOffset.NotSupported&&(o.UnsupportedOffsetTimeInMin=e),o.ModalityGuid=r,o.ModalityType=u?u:"Email",f!=null&&(o.Guid=f),n.Alarms.push(o)},Calendar.FullEvent.areEventsEqual=function(n,t,i,r){var u=!0;return!r&&(!Calendar.Event.areAlarmsEqual(n.Alarms,t.Alarms)||n.CharmId!=t.CharmId||n.CalendarGuid!=t.CalendarGuid||n.Visibility!=t.Visibility||n.FreeBusyStatus!=t.FreeBusyStatus)?!1:(n.Guid==t.Guid&&(n.DateStart?n.DateStart.valueOf():0)==(t.DateStart?t.DateStart.valueOf():0)&&(n.DateEnd?n.DateEnd.valueOf():0)==(t.DateEnd?t.DateEnd.valueOf():0)&&(n.CustomTZStartDate?n.CustomTZStartDate.valueOf():0)==(t.CustomTZStartDate?t.CustomTZStartDate.valueOf():0)&&(n.CustomTZEndDate?n.CustomTZEndDate.valueOf():0)==(t.CustomTZEndDate?t.CustomTZEndDate.valueOf():0)&&n.StartTimeTZNum==t.StartTimeTZNum&&n.EndTimeTZNum==t.EndTimeTZNum&&n.Priority==t.Priority&&n.Summary==t.Summary&&n.Description==t.Description&&n.Location==t.Location&&n.EventProgress==t.EventProgress&&Calendar.Event.MapCoordinate.areEqual(n.MapCoordinate,t.MapCoordinate)&&n.IsAllDayEvent==t.IsAllDayEvent&&n.__isFppObject==t.__isFppObject&&n.CacheEventId==t.CacheEventId&&n.ExternalId==t.ExternalId&&(n.Birthdate?n.Birthdate.valueOf():0)==(t.Birthdate?t.Birthdate.valueOf():0)&&n.RecurrenceInfo==null==(t.RecurrenceInfo==null)&&n.RecurrenceDescription==t.RecurrenceDescription&&Calendar.Event.Participant.areEqual(n.Organizer,t.Organizer)&&Calendar.Event.areParticipantsEqual(n.Participants,t.Participants)&&Calendar.Event.areCategoriesEqual(n.Categories,t.Categories)?i||n.RecurrenceInfo&&t.RecurrenceInfo&&(u=Calendar.FullEvent.RecurrenceDescriptor.areRecurrenceDescriptorsEqual(n.RecurrenceInfo,t.RecurrenceInfo)):u=!1,u)},Calendar.FullEvent.isRecurringEvent=function(n){return n.RecurrenceId!=null||n.RecurrenceInfo!=null},Calendar.FullEvent.RecurrenceDescriptor=function(){},Calendar.FullEvent.RecurrenceDescriptor.initializeRecurrenceDescriptor=function(n){n.PLRecurrenceStartDate=new Calendar.Date,n.PLRecurrenceEndDate=new Calendar.Date,n.RepeatCount=0,n.Interval=1,n.IsEveryWeekDay=!1,n.WeekdayList=[],n.MonthRecurrenceSubType=!1,n.MonthDay=0,n.SetPosition=0,n.YearlyRecurrenceSubType=!1,n.MonthNo=0,n.DropDownOption=CAL.RecurrenceDayDropDownOption.AllDays,n.IsNotSupportedRecurrence=!1,n.HasRecurrenceExceptionsOrRdates=!1},Calendar.FullEvent.RecurrenceDescriptor.areRecurrenceDescriptorsEqual=function(n,t){return n==null&&t!=null||n!=null&&t==null?!1:n.RepeatType==t.RepeatType&&n.Interval==t.Interval&&n.EndType==t.EndType&&n.IsEveryWeekDay==t.IsEveryWeekDay&&n.MonthDay==t.MonthDay&&n.MonthNo==t.MonthNo&&n.MonthRecurrenceSubType==t.MonthRecurrenceSubType&&n.YearlyRecurrenceSubType==t.YearlyRecurrenceSubType&&n.SetPosition==t.SetPosition&&n.DropDownOption==t.DropDownOption&&n.PLRecurrenceStartDate.valueOf()==t.PLRecurrenceStartDate.valueOf()&&(n.EndType==CAL.RecurrenceEndType.RepeatInstances&&n.RepeatCount==t.RepeatCount||n.EndType==CAL.RecurrenceEndType.WindowEnd&&n.PLRecurrenceEndDate.valueOf()==t.PLRecurrenceEndDate.valueOf()||n.EndType==CAL.RecurrenceEndType.RepeatForever&&t.EndType==CAL.RecurrenceEndType.RepeatForever)&&Calendar.FullEvent.RecurrenceDescriptor.areWeekdayListEqual(n.WeekdayList,t.WeekdayList)?!0:!1},Calendar.FullEvent.RecurrenceDescriptor.areWeekdayListEqual=function(n,t){if((n==null||n.length==0)&&t!=null&&t.length!=0||n!=null&&n.length!=0&&(t==null||t.length==0))return!1;if((n==null||n.length==0)&&(t==null||n.length==0))return!0;for(var i=0;i<7;i++)if(n[i]!=t[i])return!1;return!0},Calendar.FullEvent.RecurrenceDescriptor.copyCalculatedProperties=function(n,t){t.IsNotSupportedRecurrence=n.IsNotSupportedRecurrence,t.Interval=n.Interval},Calendar.FullEvent.isEventMeetingRequest=function(n){return n.MeetingRequestMode!=null},Calendar.FullEvent.isEventMeetingRequestInParticipantMode=function(n){return n.MeetingRequestMode==CAL.MeetingRequestModeType.Participant},Calendar.FullEvent.isEventMeetingRequestInOrganizerMode=function(n){return n.MeetingRequestMode==CAL.MeetingRequestModeType.Organizer},Calendar.FullEvent.CreateFromFullMasterAndStubInstance=function(n,t){if(n.Guid!=t.Guid||n.ParentGuid!=t.ParentGuid)return null;var i=Calendar.FullEvent.cloneEvent(n);return i.DateStart=t.DateStart?t.DateStart.clone():null,i.DateEnd=t.DateStart?t.DateEnd.clone():null,i.CustomTZStartDate=t.CustomTZStartDate?t.CustomTZStartDate.clone():null,i.CustomTZEndDate=t.CustomTZEndDate?t.CustomTZEndDate.clone():null,i.RecurrenceId=t.RecurrenceId?t.RecurrenceId.clone():null,i.StartTimeTZNum=t.StartTimeTZNum,i.EndTimeTZNum=t.EndTimeTZNum,i.CacheEventId=t.CacheEventId,i},Calendar.FullEvent.IsFullEvent=function(n){return n.SequenceNumber||n.SequenceNumber==0},Calendar.Event=function(){},Calendar.Event.cloneEvent=function(n){var t=null;return n!=null&&(t=new CAL.PLStubEvent,t.Priority=0,t.IsRecurrenceException=!1,t.Visibility=CAL.EventVisibility.Public,t.Guid=n.Guid,t.CalendarGuid=n.CalendarGuid,t.Summary=n.Summary,t.Description=n.Description,t.Location=n.Location,t.ParentGuid=n.ParentGuid,t.RecurrenceDescription=n.RecurrenceDescription,t.CacheEventId=n.CacheEventId,t.CharmId=n.CharmId,t.ExternalId=n.ExternalId,t.BirthdaySourceId=n.BirthdaySourceId,t.DateStart=n.DateStart?n.DateStart.clone():null,t.DateEnd=n.DateEnd?n.DateEnd.clone():null,t.CustomTZStartDate=n.CustomTZStartDate?n.CustomTZStartDate.clone():n.DateStart?n.DateStart.clone():null,t.CustomTZEndDate=n.CustomTZEndDate?n.CustomTZEndDate.clone():n.DateEnd?n.DateEnd.clone():null,t.RecurrenceId=n.RecurrenceId?n.RecurrenceId.clone():null,t.CompletedDate=n.CompletedDate?n.CompletedDate.clone():null,t.CreatedDate=n.CreatedDate?n.CreatedDate.clone():null,t.StartTimeTZNum=n.StartTimeTZNum,t.EndTimeTZNum=n.EndTimeTZNum,t.Priority=n.Priority,t.EventProgress=n.EventProgress,t.EventTimeInUserTimeZone=n.EventTimeInUserTimeZone?n.EventTimeInUserTimeZone:!1,t.IsAllDayEvent=n.IsAllDayEvent,t.IsRecurrenceException=n.IsRecurrenceException,t.__isFppObject=n.__isFppObject,t.IsDraft=n.IsDraft,t.FreeBusyStatus=n.FreeBusyStatus,t.Visibility=n.Visibility,t.ItemType=n.ItemType,t.MeetingRequestMode=n.MeetingRequestMode,t.IcsEventStatus=n.IcsEventStatus,t.Calendar=Calendar.Event.Calendar.clone(n.Calendar),t.Organizer=Calendar.Event.Participant.clone(n.Organizer),t.MeetingRequestOperation=Calendar.Event.MeetingRequestOperation.clone(n.MeetingRequestOperation),t.Categories=Calendar.Event.cloneCategories(n.Categories),t.Participants=Calendar.Event.cloneParticipants(n.Participants)),t},Calendar.Event.fixDateTypeInEventArray=function(n){for(var t,u,s,e,i,r,f=0,o=n.length;f<o;f++){if(t=n[f],t.DateStart&&(t.DateStart=new Calendar.Date(t.DateStart)),t.DateEnd&&(t.DateEnd=new Calendar.Date(t.DateEnd)),t.CustomTZStartDate&&(t.CustomTZStartDate=new Calendar.Date(t.CustomTZStartDate)),t.CustomTZEndDate&&(t.CustomTZEndDate=new Calendar.Date(t.CustomTZEndDate)),t.CreatedDate&&(t.CreatedDate=new Calendar.Date(t.CreatedDate)),t.CompletedDate&&(t.CompletedDate=new Calendar.Date(t.CompletedDate)),t.Birthdate&&(t.Birthdate=new Calendar.Date(t.Birthdate)),t.RecurrenceId&&(t.RecurrenceId=new Calendar.Date(t.RecurrenceId)),t.RecurrenceInfo&&(u=t.RecurrenceInfo.PLRecurrenceStartDate,u&&(t.RecurrenceInfo.PLRecurrenceStartDate=new Calendar.Date(u)),u=t.RecurrenceInfo.PLRecurrenceEndDate,u&&(t.RecurrenceInfo.PLRecurrenceEndDate=new Calendar.Date(u))),t.IsAllDayEvent&&t.ItemType!=CAL.CalendarItemType.TaskItem&&t.DateEnd&&(t.DateEnd._isEndOfDay=!0,t.CustomTZEndDate._isEndOfDay=!0),t.Participants&&t.Participants.length>0)for(s=t.Participants.length,e=0;e<s;e++)i=t.Participants[e],i.RecurrenceId=i.RecurrenceId?new Calendar.Date(i.RecurrenceId):null,i.LastResponseDate=i.LastResponseDate?new Calendar.Date(i.LastResponseDate):null,i.LastSentDate=i.LastSentDate?new Calendar.Date(i.LastSentDate):null,i.LastModified=i.LastModified?new Calendar.Date(i.LastModified):null;t.Organizer&&t.Organizer!=""&&(r=t.Organizer,r.RecurrenceId=r.RecurrenceId?new Calendar.Date(r.RecurrenceId):null,r.LastResponseDate=r.LastResponseDate?new Calendar.Date(r.LastResponseDate):null,r.LastSentDate=r.LastSentDate?new Calendar.Date(r.LastSentDate):null,r.LastModified=r.LastModified?new Calendar.Date(r.LastModified):null)}},Calendar.Event.MeetingRequestOperation=function(){},Calendar.Event.MeetingRequestOperation.clone=function(n){var t=null;return n!=null&&(t=new CAL.PLMROperationInfo,t.organizerAction=n.organizerAction!=null?n.organizerAction:null,t.participantAction=n.participantAction!=null?n.participantAction:null,t.commentToSend=n.commentToSend!=null?n.commentToSend:null),t},Calendar.Event.MapCoordinate=function(){},Calendar.Event.MapCoordinate.clone=function(n){var t=null;return n!=null&&(t=new CAL.BusinessLogicMapCoordinate,t.Latitude=n.Latitude,t.Longitude=n.Longitude),t},Calendar.Event.MapCoordinate.areEqual=function(n,t){var i=!0;return n!=null&&t!=null?(n.Latitude!=t.Latitude||n.Longitude!=t.Longitude)&&(i=!1):n!=t&&(i=!1),i},Calendar.Event.Calendar=function(){},Calendar.Event.Calendar.clone=function(n){var t=null;return n!=null&&(t=new CAL.BusinessLogicCalendar,t.Guid=n.Guid,t.Name=n.Name,t.Description=n.Description,t.IsVisibleToCurrentUser=n.IsVisibleToCurrentUser,t.IsCurrentUserOwner=n.IsCurrentUserOwner,t.IsPermissionStoredLocally=n.IsPermissionStoredLocally,t.Visibility=n.Visibility,t.IsPublicPublished=n.IsPublicPublished,t.PublishTimeZone=n.PublishTimeZone,t.ColorIndex=n.ColorIndex,t.SharingPermission=n.SharingPermission,t.IsAllowSharingViaUrl=n.IsAllowSharingViaUrl,t.HasDailyEmailSummaryEnabled=n.HasDailyEmailSummaryEnabled,t.OwnerName=n.OwnerName,t.IsShared=n.IsShared,t.IsDefaultCalendar=n.IsDefaultCalendar,t.CalendarType=n.CalendarType,t.Url=n.Url,t.LastRefreshTimeLocal=n.LastRefreshTimeLocal?n.LastRefreshTimeLocal.clone():null,t.LastTotalEventCount=n.LastTotalEventCount,t.LastImportedEventCount=n.LastImportedEventCount,t.SyncErrors=n.SyncErrors?n.SyncErrors.clone():null),t},Calendar.Event.fixDateTypeInCalendarArray=function(n){for(var i=n.length,t=0;t<i;t++)pCalendar=n[t],pCalendar.LastRefreshTimeLocal=new Calendar.Date(pCalendar.LastRefreshTimeLocal)},Calendar.Event.Alarm=function(){},Calendar.Event.Alarm.clone=function(n){var t=null;return n!=null&&(t=new CAL.PLAlarm,t.Guid=n.Guid,t.EventGuid=n.EventGuid,t.Description=n.Description,t.OffsetTime=n.OffsetTime,t.ModalityGuid=n.ModalityGuid,t.ModalityType=n.ModalityType,t.UnsupportedOffsetTimeInMin=n.UnsupportedOffsetTimeInMin,t.UnsupportedReminderDropdownText=n.UnsupportedReminderDropdownText,t.AlarmType=n.AlarmType),t},Calendar.Event.cloneAlarms=function(n){var t=null,r,u,i;if(n!=null)for(t=[],r=n.length,u=Calendar.Event.Alarm.clone,i=0;i<r;i++)t.push(u(n[i]));return t},Calendar.Event.Alarm.areEqual=function(n,t){var i=!0;return n!=null&&t!=null?(n.Guid!=t.Guid||n.EventGuid!=t.EventGuid||n.Description!=t.Description||n.OffsetTime!=t.OffsetTime||n.UnsupportedOffsetTimeInMin!=t.UnsupportedOffsetTimeInMin||n.UnsupportedReminderDropdownText!=t.UnsupportedReminderDropdownText||n.AlarmType!=t.AlarmType||n.ModalityGuid!=t.ModalityGuid)&&(i=!1):n!=t&&(i=!1),i},Calendar.Event.areAlarmsEqual=function(n,t){var i=!0,u,f,r;if(n!=null&&t!=null){if(u=n.length,f=t.length,u!=f)i=!1;else for(r=0;r<u;r++)if(!Calendar.Event.Alarm.areEqual(n[r],t[r])){i=!1;break}}else n!=t&&(i=!1);return i},Calendar.Event.Category=function(){},Calendar.Event.Category.clone=function(n){var t=null;return n!=null&&(t=new CAL.PLCategory,t.Guid=n.Guid,t.Name=n.Name),t},Calendar.Event.cloneCategories=function(n){var t=null,r,u,i;if(n!=null)for(t=[],r=n.length,u=Calendar.Event.Category.clone,i=0;i<r;i++)t.push(u(n[i]));return t},Calendar.Event.Category.areEqual=function(n,t){var i=!0;return n!=null&&t!=null?(n.Guid!=t.Guid||n.Name!=t.Name)&&(i=!1):n!=t&&(i=!1),i},Calendar.Event.areCategoriesEqual=function(n,t){var i=!0,u,f,r;if(n!=null&&t!=null){if(u=n.length,f=t.length,u!=f)i=!1;else for(r=0;r<u;r++)if(!Calendar.Event.Category.areEqual(n[r],t[r])){i=!1;break}}else n!=t&&(i=!1);return i},Calendar.Event.getCharmId=function(n,t){return n.CharmId?n.CharmId:t?t.getCalendarCharmId(n.CalendarGuid):null},Calendar.Event.Participant=function(){},Calendar.Event.Participant.clone=function(n){var t=null;return n!=null&&(t=new CAL.PLParticipant,t.Guid=n.Guid,t.EventGuid=n.EventGuid,t.EmailAddress=n.EmailAddress,t.CommonName=n.CommonName,t.RecurrenceId=n.RecurrenceId,t.ParticipantType=n.ParticipantType,t.Role=n.Role,t.Status=n.Status,t.IsOrganizer=n.IsOrganizer,t.RsvpExpected=n.RsvpExpected,t.DelegatedFrom=n.DelegatedFrom?n.DelegatedFrom.clone():null,t.DelegatedTo=n.DelegatedTo?n.DelegatedTo.clone():null,t.InternalUserId=n.InternalUserId,t.LastResponseType=n.LastResponseType,t.LastResponseDate=n.LastResponseDate?n.LastResponseDate.clone():null,t.LastSentDate=n.LastSentDate?n.LastSentDate.clone():null,t.HasError=n.HasError,t.LastModified=n.LastModified?n.LastModified.clone():null,t.UserId=n.UserId),t},Calendar.Event.cloneParticipants=function(n){var t=null,r,u,i;if(n!=null)for(t=[],r=n.length,u=Calendar.Event.Participant.clone,i=0;i<r;i++)t.push(u(n[i]));return t},Calendar.Event.Participant.areEqual=function(n,t){var i=!0;return n!=null&&t!=null?n.Guid==t.Guid&&n.EventGuid==t.EventGuid&&n.EmailAddress==t.EmailAddress&&n.CommonName==t.CommonName&&Calendar.Event.Participant.areRecurrenceIdEqual(n.RecurrenceId,t.RecurrenceId)&&n.ParticipantType==t.ParticipantType&&n.Role==t.Role&&n.Status==t.Status&&n.IsOrganizer==t.IsOrganizer&&n.RsvpExpected==t.RsvpExpected&&n.DelegatedFrom==t.DelegatedFrom&&n.DelegatedTo==t.DelegatedTo&&n.InternalUserId==t.InternalUserId&&n.LastResponseType==t.LastResponseType&&n.LastResponseDate.valueOf()==t.LastResponseDate.valueOf()&&n.LastSentDate.valueOf()==t.LastSentDate.valueOf()&&n.HasError==t.HasError&&n.LastModified.valueOf()==t.LastModified.valueOf()&&n.UserId==t.UserId||(i=!1):n!=t&&(i=!1),i},Calendar.Event.Participant.areRecurrenceIdEqual=function(n,t){return n==null&&t==null?!0:n==null||t==null?!1:n.valueOf()==t.valueOf()},Calendar.Event.areParticipantsEqual=function(n,t){var i=!0,u,f,r;if(n!=null&&t!=null){if(u=n.length,f=t.length,u!=f)i=!1;else for(r=0;r<u;r++)if(!Calendar.Event.Participant.areEqual(n[r],t[r])){i=!1;break}}else n!=t&&(i=!1);return i},Calendar.Event.RecurrenceInfo=function(){},Calendar.Event.RecurrenceInfo.clone=function(n){var t=null;return n!=null&&(t=new CAL.PLRecurrenceDescriptor,t.PLRecurrenceStartDate=n.PLRecurrenceStartDate.clone(),t.PLRecurrenceEndDate=n.PLRecurrenceEndDate?n.PLRecurrenceEndDate.clone():null,t.RepeatType=n.RepeatType,t.EndType=n.EndType,t.RepeatCount=n.RepeatCount,t.Interval=n.Interval,t.IsEveryWeekDay=n.IsEveryWeekDay,t.WeekdayList=n.WeekdayList?n.WeekdayList.clone():null,t.MonthRecurrenceSubType=n.MonthRecurrenceSubType,t.MonthDay=n.MonthDay,t.SetPosition=n.SetPosition,t.YearlyRecurrenceSubType=n.YearlyRecurrenceSubType,t.MonthNo=n.MonthNo,t.DropDownOption=n.DropDownOption,t.IsNotSupportedRecurrence=n.IsNotSupportedRecurrence,t.HasRecurrenceExceptionsOrRdates=n.HasRecurrenceExceptionsOrRdates),t},Calendar.Event.cloneEvents=function(n){for(var i=[],r=n.length,u=Calendar.Event.cloneEvent,t=0;t<r;t++)i.push(u(n[t]));return i},Calendar.Event.areEventsEqual=function(n,t){var i=!0;return n.Guid==t.Guid&&(n.DateStart?n.DateStart.valueOf():0)==(t.DateStart?t.DateStart.valueOf():0)&&(n.DateEnd?n.DateEnd.valueOf():0)==(t.DateEnd?t.DateEnd.valueOf():0)&&(n.CustomTZStartDate?n.CustomTZStartDate.valueOf():0)==(t.CustomTZStartDate?t.CustomTZStartDate.valueOf():0)&&(n.CustomTZEndDate?n.CustomTZEndDate.valueOf():0)==(t.CustomTZEndDate?t.CustomTZEndDate.valueOf():0)&&n.CharmId==t.CharmId&&n.ExternalId==t.ExternalId&&n.StartTimeTZNum==t.StartTimeTZNum&&n.EndTimeTZNum==t.EndTimeTZNum&&n.Priority==t.Priority&&n.CalendarGuid==t.CalendarGuid&&n.Summary==t.Summary&&n.Description==t.Description&&n.Location==t.Location&&n.EventProgress==t.EventProgress&&n.FreeBusyStatus==t.FreeBusyStatus&&n.Visibility==t.Visibility&&n.IsAllDayEvent==t.IsAllDayEvent&&n.__isFppObject==t.__isFppObject&&n.IsDraft==t.IsDraft&&n.CacheEventId==t.CacheEventId&&n.RecurrenceDescription==t.RecurrenceDescription&&Calendar.Event.Participant.areEqual(n.Organizer,t.Organizer)&&Calendar.Event.areParticipantsEqual(n.Participants,t.Participants)&&Calendar.Event.areCategoriesEqual(n.Categories,t.Categories)||(i=!1),i},Calendar.Event.Fields=new $Enum("Start","End","StartTZ","EndTZ","Charm","ExternalId","Priority","Summary","Location","Progress","FreeBusy","IsAllDay","FullEventRecurrence","StubEventRecurrence"),Calendar.Event.quantifyChangeFromStub=function(n,t){var i=[];return(n.DateStart?n.DateStart.valueOf():0)!=(t.DateStart?t.DateStart.valueOf():0)&&i.push(Calendar.Event.Fields.Start),(n.DateEnd?n.DateEnd.valueOf():0)!=(t.DateEnd?t.DateEnd.valueOf():0)&&i.push(Calendar.Event.Fields.End),n.CharmId!=t.CharmId&&i.push(Calendar.Event.Fields.Charm),n.ExternalId!=t.ExternalId&&i.push(Calendar.Event.Fields.ExternalId),n.StartTimeTZNum!=t.StartTimeTZNum&&i.push(Calendar.Event.Fields.StartTZ),n.EndTimeTZNum!=t.EndTimeTZNum&&i.push(Calendar.Event.Fields.EndTZ),n.Priority!=t.Priority&&i.push(Calendar.Event.Fields.Priority),n.Summary!=t.Summary&&i.push(Calendar.Event.Fields.Summary),n.Location!=t.Location&&i.push(Calendar.Event.Fields.Start),n.EventProgress!=t.EventProgress&&i.push(Calendar.Event.Fields.Progress),n.FreeBusyStatus!=t.FreeBusyStatus&&i.push(Calendar.Event.Fields.FreeBusy),n.IsAllDayEvent!=t.IsAllDayEvent&&i.push(Calendar.Event.Fields.IsAllDay),n.RecurrenceDescription!=t.RecurrenceDescription&&(n.RecurrenceDescription&&i.push(Calendar.Event.Fields.FullEventRecurrence),t.RecurrenceDescription&&i.push(Calendar.Event.Fields.StubEventRecurrence)),i},Calendar.Event.isRecurringEvent=function(n){return n.RecurrenceId!=null||n.RecurrenceDescription!=null},Calendar.Event.isEventInRange=function(n,t,i,r){return n<r&&(t>i||t==n&&t==i)},Calendar.Event.filterEventsInRange=function(n,t){for(var u=[],f=n.length,r,i=0;i<f;i++)r=n[i],Calendar.Event.isEventInRange(r.DateStart.getTime(),r.DateEnd.getTime(),t.StartDate.getTime(),t.EndDate.getTime())&&u.push(r);return u},Calendar.Event.filterItemsByType=function(n,t){for(var r=[],i=0;i<n.length;i++)t.indexOf(n[i].ItemType)==-1&&r.push(n[i]);return r},Calendar.Event.isCalendarReadOnly=function(n){return n.SharingPermission==CAL.SharingPermissionLevel.Read||n.SharingPermission==CAL.SharingPermissionLevel.FreeBusy||n.SharingPermission==CAL.SharingPermissionLevel.LimitedDetails||Calendar.Event.isBirthdayCalendar(n)},Calendar.Event.isCalendarOwnedOrCoOwned=function(n){return n.SharingPermission==CAL.SharingPermissionLevel.CoOwner||Calendar.Event.isCalendarOwned(n)},Calendar.Event.isCalendarOwned=function(n){return n.SharingPermission==CAL.SharingPermissionLevel.Owner},Calendar.Event.isBirthdayCalendar=function(n){return(n.CalendarType&CAL.CalendarType.Birthday)==CAL.CalendarType.Birthday},Calendar.Event.isHolidayCalendar=function(n){return(n.CalendarType&CAL.CalendarType.Holiday)==CAL.CalendarType.Holiday},Calendar.Event.isGroupCalendar=function(n){return(n.CalendarType&CAL.CalendarType.Group)==CAL.CalendarType.Group},Calendar.Event.isFamilyCalendar=function(n){return(n.CalendarType&CAL.CalendarType.FamilyHub)==CAL.CalendarType.FamilyHub},Calendar.Event.canCalendarBeShared=function(n){return Calendar.Event.isCalendarOwnedOrCoOwned(n)&&!Calendar.Event.isBirthdayCalendar(n)&&!Calendar.Event.isGroupCalendar(n)},Calendar.Event.isSubscriptionCalendar=function(n){return(n.CalendarType&CAL.CalendarType.iCal)==CAL.CalendarType.iCal},Calendar.Event.isEventMeetingRequest=function(n){return n.MeetingRequestMode!=null},Calendar.Event.isEventMeetingRequestInParticipantMode=function(n){return n.MeetingRequestMode==CAL.MeetingRequestModeType.Participant},Calendar.Event.isEventMeetingRequestInOrganizerMode=function(n){return n.MeetingRequestMode==CAL.MeetingRequestModeType.Organizer},Calendar.Event.isEventDragable=function(n){return Calendar.Event.isEventReadOnly(n)?!1:Calendar.Event.isEventMeetingRequestInParticipantMode(n)||Calendar.Event.isEventMeetingRequestInOrganizerMode(n)&&!n.Calendar.IsCurrentUserOwner||n.Visibility==CAL.EventVisibility.Private&&!n.Calendar.IsCurrentUserOwner?!1:!0},Calendar.Event.isEventReadOnly=function(n){return n.Calendar?n.ItemType==CAL.CalendarItemType.SocialEvent||Calendar.Event.isCalendarReadOnly(n.Calendar)||n.ItemType==CAL.CalendarItemType.TaskItem&&Calendar.Event.isRecurringEvent(n):!1},Calendar.Event.isEventViewOnly=function(n){return n.Calendar?n.Calendar.SharingPermission==CAL.SharingPermissionLevel.FreeBusy||n.Calendar.SharingPermission!=CAL.SharingPermissionLevel.Owner&&n.Visibility!=CAL.EventVisibility.Public:!1},Dom=function(){},Dom.UI={},Dom.UI.HAnchor=new $Flags("Center",0),Dom.KeyCode={},Dom.KeyCode.Tab=9,Dom.KeyCode.Enter=13,Dom.KeyCode.Delete=46,Dom.KeyCode.Esc=27,Dom.KeyCode.Space=32,Dom.KeyCode.LeftArrow=37,Dom.KeyCode.UpArrow=38,Dom.KeyCode.RightArrow=39,Dom.KeyCode.DownArrow=40,Dom.KeyCode.F6=117,Dom.getKeyCodeFromDomEvent=function(n){return n.charCode&&n.charCode!=0?n.charCode:n.keyCode},Dom.disableLink=function(n){var t,i;n&&!n.replacedByElement&&(t=document.createElement("SPAN"),t.innerText=n.innerText,t.className="disabledLink",t.disabled=!0,n.style.display="none",i=n.parentElement.replaceChild(t,n),t.replacedElement=n,n.replacedByElement=t)},Dom.enableLink=function(n){if(n&&n.replacedByElement){var t=n.replacedByElement;t.parentElement.replaceChild(n,t),t.replacedElement=null,n.style.display="inline",n.replacedByElement=null}},Dom.removeAllChildNodes=function(n){while(n.hasChildNodes())n.removeChild(n.firstChild)},Dom.getSiblingIndex=function(n){for(var i=n.parentNode.childNodes,t=0;t<i.length;t++)if(i[t]==n)return t;return null},Dom.addClass=function(n){for(var i=arguments.length,r,t=1;t<i;t++)r=arguments[t].slice(0,1),r=="+"?$css.add(n,arguments[t].slice(1)):$css.remove(n,arguments[t].slice(1))},Dom.isClassPresent=function(n,t){return $css.has(n,t)},Dom.getDescendantsWithClass=function(n,t,i,r){var u=[],c,v,s,h,f,l,a,e,o;for((r==null||r=="")&&(r="*"),c=n.getElementsByTagName(r),v=c.length,s=0;s<v&&u.length!=i;s++){if(h=c[s],f=h.className,f==t){u.push(h);continue}for(l=f.length,a=!1,e=0;!a&&e<l;e=o+1)o=f.indexOf(" ",e+1),o<0&&(o=l),f.slice(e,o)==t&&(a=!0,u.push(h))}return u},Dom.getNearestParentWithClass=function(n,t,i){for(var r=n;r!=null&&r!=i&&Dom.isClassPresent(r,t)==!1;)r=r.parentNode;return r!=null&&Dom.isClassPresent(r,t)==!0?r:null},Dom.getOffsetPositionedParent=function(n){while(n!=null&&n.currentStyle.position!="absolute"&&n.currentStyle.position!="relative")n=n.offsetParent;return n},Dom.searchIndexInDropdownListByValue=function(n,t){for(var r=-1,u=n.options.length,i=0;i<u;i++)if(t==n.options[i].value){r=i;break}return r},Dom.generateDropdownHtml=function(n,t,i,r,u){var f=new $StringBuilder,o,e;for(f.append("<select name='"),f.append(n),f.append("' id='"),f.append(n),f.append("' "),u&&f.append(u+" "),r&&(f.append("class='"),f.append(r),f.append("' ")),f.append(">"),o=t.length,e=0;e<o;e++)f.append("<option value='"),f.append(i[e]),u?f.append("'"+getSutraAttribute("DropdownOption")+">"):f.append("'>"),f.append(t[e]),f.append("<\/option>");return f.append("<\/select>"),f.toString()},Dom.setOptionInDropdownListByValue=function(n,t){var i=Dom.searchIndexInDropdownListByValue(n,t);n.selectedIndex=i},Dom.isDropdownListContainsValue=function(n,t){return Dom.searchIndexInDropdownListByValue(n,t)>=0},Dom.removeDropdownListOptionByValue=function(n,t){var i=Dom.searchIndexInDropdownListByValue(n,t);i>=0&&n.remove(i)},Dom.addDropdownListOption=function(n,t,i,r){if(!Dom.isDropdownListContainsValue(n,i)){var u=document.createElement("OPTION");r?n.options.add(u,r):n.options.add(u),u.innerText=t,u.value=i}},Dom.isRelation=function(n,t){for(var i=t;i;){if(i==n)return!0;i=i.parentElement}return!1},Dom.isElementDisplayNone=function(n,t){for(var i=n;i&&i!=t&&i!=document;){if(i.currentStyle.display=="none")return!0;i=i.parentElement}return!1},Dom.setElementHeightInPixel=function(n,t){Dom.isElementDisplayNone(n,document.body)||(n.style.pixelHeight=t)},Dom.addClassToElementsInArray=function(n,t){var r,u,i;if(n!=null)for(r=n.length,u=!1,r&&(u=typeof n[0]=="string"),i=0;i<r;i++)u?Dom.addClass(_ge(n[i]),t):Dom.addClass(n[i],t)},Dom.isComponentEvent=function(n){var t=!1,i;return $B.IE?(i=n.target.componentFromPoint(n.clientX,n.clientY),n.target&&i!=""&&i!="outside"&&(t=!0)):typeof n.originalTarget!="undefined"&&n.originalTarget.prefix=="xul"&&(t=!0),t},Dom._uniqueElementIdCount=0,Dom._uniqueElementIdPrefix="__livecal_id",Dom.getUniqueElementId=function(){return Dom._uniqueElementIdPrefix+Dom._uniqueElementIdCount++},"undefined"==typeof WebUtilities&&(WebUtilities={}),WebUtilities.Rect=function(n,t,i,r){return{left:n,x:n,top:t,y:t,width:i,height:r,right:n+i,bottom:t+r,toString:function(){return"{x:{0},y:{1},width:{2},height:{3}}".format(this.x,this.y,this.width,this.height)},equals:function(n){return this.x==n.x&&this.y==n.y&&this.width==n.width&&this.height==n.height},inflate:function(n,t){this.width+=n,this.height+=t,this.right=this.x+this.width,this.bottom=this.y+this.height},offset:function(n,t){this.x+=n,this.left=this.x,this.y+=t,this.top=this.y,this.right+=n,this.bottom+=t},isEmpty:function(){return this.width<=0||this.height<=0},contains:function(n){return n.x>=this.left&&n.x<=this.width+this.left&&n.y>=this.top&&n.y<=this.height+this.top}}},WebUtilities.Rect.Empty=function(){return new WebUtilities.Rect(0,0,0,0)},WebUtilities.Conversion={coerceInt:function(n){return n=parseInt(n),isNaN(n)?0:n}},WebUtilities.getLocation=function(n){var t,r,e,u,i,f,o;if(!n)return WebUtilities.Rect.Empty();for(t=WebUtilities.Rect.Empty(),t.source=n,r=n.currentStyle,e=["Top","Left","Right","Bottom"],u=0;u<e.length;u++)i=e[u],t["margin"+i]=WebUtilities.Conversion.coerceInt(r["margin"+i]),t["border"+i]=WebUtilities.Conversion.coerceInt(r["border"+i+"Width"]),t["padding"+i]=WebUtilities.Conversion.coerceInt(r["padding"+i]);return f=jQuery(n),o=f.position(),t.height=f.height(),t.width=f.width(),t.left=o.left,t.top=o.top,document.compatMode=="CSS1Compat"?(t.contentWidth=t.source.offsetWidth-t.borderLeft-t.borderRight-t.paddingLeft-t.paddingRight-t.marginLeft-t.marginRight,t.contentHeight=t.source.offsetHeight-t.borderTop-t.borderBottom-t.paddingTop-t.paddingBottom-t.marginTop-t.marginBottom):(t.contentWidth=t.source.offsetWidth,t.contentHeight=t.source.offsetHeight),t.x=t.left,t.y=t.top,t.bottom=t.top+t.height-t.marginBottom,t.right=t.left+t.width-t.marginRight,t},WebUtilities.getLayoutRoot=function(){return document.compatMode=="CSS1Compat"&&!$B.Safari?document.documentElement:document.body},WebUtilities.getScrollLeft=function(n,t){return t?$B.IE?n.scrollWidth-n.clientWidth-n.scrollLeft:n.scrollLeft:n.scrollLeft},WebUtilities.getViewportWidth=function(){return window.innerWidth!=window.undefined?window.innerWidth:document.compatMode=="CSS1Compat"?document.documentElement.clientWidth:document.body?document.body.clientWidth:void 0},WebUtilities.findFocusableElement=function(n,t,i){function r(n){if(!n)return null;for(var t=i?n.nextSibling:n.previousSibling;t&&t.nodeType!=1;)t=i?t.nextSibling:t.previousSibling;return t?t:r(n.parentNode)}function u(n,t){var u=t;if(u&&n.contains(u))while(u!=null){if(WebUtilities.isFocusable(u))return u;u=i&&u.firstChild?u.firstChild:!i&&u.lastChild?u.lastChild:r(u)}return null}t=t?r(t):n;var f=u(n,t);return!f&&t&&t!=n?u(n,n):f},WebUtilities.isFocusable=function(n){var t="BUTTON|TEXTAREA|FIELDSET|IFRAME|SELECT|";return n.tagName&&!n.disabled&&(t.indexOf(n.tagName+"|")>-1||n.tagName=="A"&&n.href||n.tagName=="INPUT"&&n.type!="hidden")},WebUtilities.strictParseInt=function(n,t){try{return WebUtilities.s_hasAlphas||(WebUtilities.s_hasAlphas=new RegExp("[^0-9]+")),!n||WebUtilities.s_hasAlphas.test(n)?t:parseInt(n)}catch(i){return t}},__WEBUTILS_LOADED=!0,function(){var n=window.wLive=window.wLive||{},t=n.Calendar=n.Calendar||{},i=0;t.createNotificationWithOptions=function(t,r,u){var f=new $StringBuilder,c,s,o,h,e;if(f.append("<div>"),f.append(r.content),f.append("<\/div>"),u&&u.length>0){for(f.append('<div style="padding-top: 16px;">'),c=u.length,h=0;h<c;h++)s="notificationOption"+i++,o=u[h],f.append('<div><input type="radio" name="notificationOption" id="'),f.append(s),f.append('" value="'),f.append(o.value),f.append('"'),o.checked&&f.append(" checked"),f.append('/><label for="'),f.append(s),f.append('">'),f.append(o.caption),f.append("<\/label><\/div>");f.append("<\/div>")}return r.content=f.toString(),e=n.Controls.Notifications["create"+t](r),jQuery(e).bind("beforedismiss.notificationwithoptions",function(){e.optionSelected=jQuery(e.content()).find("input:checked").val(),jQuery(e).unbind(".notificationwithoptions")}),e}}(),Calendar.MiniCalendar=function(n,t){function wt(){t.disallowMultiDaySelection&&(st=!0),t.imagePath&&(ht=t.imagePath),k=!!t.isHeaderClickable;var i=new Calendar.Date;e=i.getFullYear(),o=i.getMonth(),et=Calendar.Date.AbbreviatedMonthNames,ot=Calendar.Date.OneCharDayNames,ti(i),jQuery(f).bind({"mousedown.minic":gt,"mouseup.minic":vt,"keydown.minic":ni}),c=new MiniCalendarController(r),Dom.addClass(n,"+Calendar_MiniCalendar")}function ct(n,t){var i,r,u;return t?(r=Calendar.Date.min(n,t),u=Calendar.Date.max(n,t),i=Calendar.Date.average(r,u)):i=n,i}function nt(n,t,r){l=!0,i.StartDate=n,i.EndDate=t,it(),r&&rt()}function tt(n,t,u){r.$().trigger("beforeselectionchanged",[n,i,r.getDisplayedRange()]),it(),n?r.checkAndChangeViewingMonth(n):r.checkAndChangeViewingMonth(i.StartDate,i.EndDate),rt(),l=!1;var f=i.StartDate,e=i.EndDate;f!=Calendar.MiniCalendar.None&&(f=f.clone()),e!=Calendar.MiniCalendar.None&&(e=e.clone()),t||r.$().trigger("selectionchanged",[f,e,!u])}function d(n,t,i){for(var r,u=0;u<n.length;u++)if(r=Dom.getNearestParentWithClass(t,n[u],i),r)return r;return null}function bt(){r.$().trigger("todaylinkclicked")}function kt(){r.$().trigger("selectionchanged",[Calendar.MiniCalendar.None])}function dt(){r.$().trigger("headerClicked",[new Calendar.Date(e,o,1)])}function gt(n){var i,r,t;n.which==Calendar.MouseButton.LEFT&&(i=d(["lastMonthDate","curMonthDate","nextMonthDate","pickTodayLink","pickNoneLink"],n.target,f),i!=null)&&(r=g(i),t=r,t!=Calendar.MiniCalendar.None&&(t=t.clone()),nt(r,t,!0),st||(s=!0,$B.IE&&$B.V<9&&f.setCapture(!0),jQuery(f).mouseover(at),$B.IE||jQuery(document.body).mouseup(lt)))}function lt(n){vt(n)}function at(n){var t,u;(s&&r.$().trigger("drageventstarted"),s=!1,t=d(["lastMonthDate","curMonthDate","nextMonthDate"],n.target,f),t!=null)&&(u=g(t),i.EndDate=u,rt())}function vt(n){if(s&&d(["lastMonthDate","curMonthDate","nextMonthDate","pickTodayLink","pickNoneLink"],n.target,f)&&r.$().trigger("clickaction"),s=!1,l)return jQuery(f).unbind("mouseover",at),f.releaseCapture(),it(),tt(null),$B.IE?void 0:(jQuery(document.body).unbind("mouseup",lt),n.stopPropagation(),!1)}function ni(n){var t,i,r;if(n.keyCode==Dom.KeyCode.Enter)return(t=d(["lastMonthDate","curMonthDate","nextMonthDate","pickTodayLink"],n.target,f),t==null)?void 0:(i=g(t),r=i.clone(),nt(i,r,!1),tt(),n.stopPropagation(),!1)}function it(){if(i.StartDate!=Calendar.MiniCalendar.None&&i.EndDate!=Calendar.MiniCalendar.None){if(i.StartDate>i.EndDate){var n=i.StartDate;i.StartDate=i.EndDate,i.EndDate=n}i.StartDate.moveToStartOfDay(),i.EndDate.moveToEndOfDay()}}function g(n){var i=e,t=o,r=n.className.split(" ")[0];switch(r){case"curMonthDate":break;case"lastMonthDate":t--;break;case"nextMonthDate":t++;break;case"pickTodayLink":return new Calendar.Date;case"pickNoneLink":return Calendar.MiniCalendar.None;default:return null}return new Calendar.Date(i,t,n.firstChild.innerText)}function rt(){var o=i.StartDate!=Calendar.MiniCalendar.None&&i.EndDate!=Calendar.MiniCalendar.None,t=null,r=null,s,n,u,c,e,h,a;for(o&&(t=Calendar.Date.min(i.StartDate,i.EndDate).clone(),r=Calendar.Date.max(i.StartDate,i.EndDate).clone(),t.moveToStartOfDay(),r.moveToStartOfDay()),s=f.firstChild.childNodes[1],n=null,u=0;u<s.childNodes.length;u++)for(c=s.childNodes[u],e=0;e<Calendar.Date.NumberOfDaysInWeek;e++)h=c.childNodes[e],n=n?n.addDays(1):g(h),l&&(a=o&&n.isBetween(t,r),Dom.addClass(h,(a?"+":"-")+"selected"))}function ti(i){var r=new $StringBuilder;r.append("<div class='miniCalendarHolder' "),r.append(u.getIdTag("miniCalendarHolder")),r.append(">"),t.showNoneLink&&(r.append("<div class='pickNoneLink'"+u.getIdTag("pickNoneLink")),r.append(">"+t.contentStrings.noDate+"<\/div>")),r.append("<div class='miniCalendarHeader' "),r.append(getSutraAttribute("MiniCalHeader")),r.append(">"),r.append("<div class='switchMonthBtn leftSideLargeMargin' "),r.append(getSutraAttribute("GridNavigatorLeftArrow")),r.append(" "+u.getIdTag("prevMonthBtn")+">"),r.append("<a href='#'"),r.append(">"),r.append(Calendar.ImageStrip.getImage("Outlook_Previous_9x10",t.contentStrings.previousMonth)),r.append("<\/a><\/div>"),r.append("<div class='switchMonthBtn rightSideLargeMargin' "),r.append(getSutraAttribute("GridNavigatorRightArrow")),r.append(" "+u.getIdTag("nextMonthBtn")+">"),r.append("<a href='#'"),r.append(">"),r.append(Calendar.ImageStrip.getImage("Outlook_Next_9x10",t.contentStrings.nextMonth)),r.append("<\/a><\/div>"),r.append("<span"),r.append(getSutraAttribute("GridNavigatorLabel")),r.append(u.getIdTag("headerText")),r.append("class='headerText "+(k?"clickable":"")+"'>"),r.append(i.toYearMonthString()),r.append("<\/span><\/div>"),r.append("<div class='miniCalendarBody' "),r.append(getSutraAttribute("MiniCalBody")),r.append(" "+u.getIdTag("miniCalendarBody")+">"+yt(i)+"<\/div>"),t.showTodayLink&&(r.append("<div class='pickTodayLink' "),r.append(getSutraAttribute("TodayButton")),r.append(" "+u.getIdTag("pickTodayLink")+"><a href='#'"),r.append(">"+t.contentStrings.todayLink.format(i.toDayMonthAndWeekdayString())+"<\/a><\/div>")),r.append("<\/div>"),n.innerHTML=r.toString(),a=u.getElement("prevMonthBtn"),h=u.getElement("headerText"),v=u.getElement("nextMonthBtn"),f=u.getElement("miniCalendarBody"),w=u.getElement("pickTodayLink"),b=u.getElement("pickNoneLink"),jQuery(a).click(ri),jQuery(v).click(ui),jQuery(w).click(bt),jQuery(b).click(kt),k&&jQuery(h).click(dt)}function yt(n){var r=ii(n),t=new $StringBuilder,i,u;for(t.append("<table class='miniCalendarTable TextSizeXSmall'><thead><tr"+getSutraAttribute("MiniCalDayNames")+">"),i=0;i<7;i++)u=(i+Calendar.Date.FirstDayOfWeek)%7,t.append("<th"),t.append(getSutraAttribute("MiniCalDayName")),t.append(">"),t.append(ot[u]),t.append("<\/th>");return t.append("<\/tr><\/thead><tbody"),t.append(getSutraAttribute("MiniCalDayRows")),t.append(">"),t.append(r.toString()),t.append("<\/tbody><\/table>"),t.toString()}function ii(n){var u=n.getFullYear(),f=n.getMonth(),b=new Calendar.Date(u,f,1,0,0),k=b.getDay(),l=(k-Calendar.Date.FirstDayOfWeek+7)%7,d=Calendar.Date.getDaysInMonth(u,f),g=f==0?Calendar.Date.getDaysInMonth(u-1,11):Calendar.Date.getDaysInMonth(u,f-1),h=null,t=new $StringBuilder,s=null,v=null,a=1,w=1,c,e;for(i.StartDate&&i.StartDate!=Calendar.MiniCalendar.None&&i.EndDate&&i.EndDate!=Calendar.MiniCalendar.None&&(h={StartDate:i.StartDate.getDatePart(),EndDate:i.EndDate.getDatePart()}),c=0;c<ft;c++){for(t.append("<tr>"),j=0;j<Calendar.Date.NumberOfDaysInWeek;j++){var nt="",r=null,e=null,o=[];c==0&&j<=l-1?(e=g-l+j+1,r=new Calendar.Date(u,f-1,e,0,0),o.push("lastMonthDate"),s||(s=r.clone())):c==0&&j>l||a<=d?(e=a,r=new Calendar.Date(u,f,e,0,0),o.push("curMonthDate"),s||(s=r.clone()),a++):(e=w,r=new Calendar.Date(u,f+1,e,0,0),o.push("nextMonthDate"),v=r.clone(),w++),r.isToday()&&o.push("miniCalToday"),h&&r.isBetween(h.StartDate,h.EndDate)&&o.push("selected"),t.append("<td class='"),t.append(o.join(" ")),t.append("' "),t.append(getSutraAttribute("MiniCalDate")),t.append("><a href='#' "),t.append(">"),t.append(e),t.append("<\/a><\/td>")}t.append("<\/tr>")}return y=s,p=v,t.toString()}function ri(){var n,t,i;r.$().trigger("paginationaction"),n=e,t=o-1,t==-1&&(t=11,n=n-1),i=new Calendar.Date(n,t,1),r.checkAndChangeViewingMonth(i),r.$().trigger("displayedmonthchanged",[e,o,-1]);return}function ui(){var n,t,i;r.$().trigger("paginationaction"),n=e,t=o+1,t==12&&(t=0,n=n+1),i=new Calendar.Date(n,t,1),r.checkAndChangeViewingMonth(i),r.$().trigger("displayedmonthchanged",[e,o,1]);return}var r=this,ut=null;this.$=function(){return ut||(ut=jQuery(r))};var c=null,e=null,o=null,l=!1,s=!1,i={StartDate:null,EndDate:null},ft=6,a=null,v=null,h=null,pt=null,y=null,p=null,f=null,et=null,ot=null,st=!1,u=new Calendar.IdManager(n),ht="",w=null,b=null,k=null;this.getController=function(){return c},this.dispose=function(){jQuery(f).unbind(".minic"),jQuery(a).unbind("click"),jQuery(v).unbind("click"),jQuery(w).unbind("click"),jQuery(b).unbind("click"),k&&jQuery(h).unbind("click"),c&&c.dispose(),r=i=et=u=null,ht=f=y=pt=null,p=m_contentStrings=a=v=w=b=null,h=null},this.getIDManager=function(){return u},this.getDisplayedYear=function(){return e},this.getDisplayedMonth=function(){return o},this.getSelectionRange=function(){var n={StartDate:null,EndDate:null};return i.StartDate!=null&&(n={StartDate:i.StartDate.clone(),EndDate:i.EndDate.clone()}),n},this.forceSetSelection=function(n,t,i,r){n&&n!=Calendar.MiniCalendar.None&&(n=n.clone()),t&&t!=Calendar.MiniCalendar.None&&(t=t.clone()),n||t||i?i&&(i=i.clone()):i=new Calendar.Date,nt(n,t,!1),tt(i,r,!0)},this.setSelection=function(n,t,r,u){(n==i.StartDate||n!=Calendar.MiniCalendar.None&&i.StartDate!=Calendar.MiniCalendar.None&&Calendar.Date.datesAreEqual(n,i.StartDate))&&(t==i.EndDate||t!=Calendar.MiniCalendar.None&&i.EndDate!=Calendar.MiniCalendar.None&&Calendar.Date.datesAreEqual(t,i.EndDate))||this.forceSetSelection(n,t,r,u)},this.getFirstDayDisplayed=function(){return y},this.getLastDayDisplayed=function(){return p},this.getDisplayedRange=function(){return{StartDate:y,EndDate:p}},this.calculateDisplayedRange=function(n,t){var u={},o=ct(n,t),r=o.getFullYear(),i=o.getMonth(),c=new Calendar.Date(r,i,1,0,0),l=c.getDay(),f=(l-Calendar.Date.FirstDayOfWeek+7)%7,a=Calendar.Date.getDaysInMonth(r,i),v=f,y=ft*7,e=y-a;if(v=0)u.StartDate=new Calendar.Date(r,i,1,0);else{var s=i==0?11:i-1,h=i==0?r-1:r,p=Calendar.Date.getDaysInMonth(h,s);u.StartDate=new Calendar.Date(h,s,p-(f-1),0),e=e-f}return u.EndDate=new Calendar.Date(i==11?r+1:r,i==11?0:i+1,e,0),u.EndDate.moveToEndOfDay(),u},this.checkAndChangeViewingMonth=function(n,t){var i=null,r,u,s;(i=n==Calendar.MiniCalendar.None&&t==Calendar.MiniCalendar.None?new Calendar.Date:ct(n,t),r=i.getFullYear(),u=i.getMonth(),r!=e||u!=o)&&((r!=e||u!=o)&&(e=r,o=u,h.innerText=i.toYearMonthString()),s=yt(i),f.innerHTML=s)},wt()},Calendar.MiniCalendar.registerClass_lf("Calendar.MiniCalendar"),Calendar.MiniCalendar.None="None",CharmsManager=function(){function n(){var t,i,n,r,u;this.m_charms={},this.m_numCharms=0,this.m_mktCharms={},this.m_numMarketCharms=0;for(t in gCharmsConfig){i=gCharmsConfig[t];for(n in i)r=i[n],u=new Charm(t,n,r,this.m_numCharms),this.m_charms[n]=u,this.m_numCharms++,r.charAt(0)=="+"&&(this.m_mktCharms[n]=u,this.m_numMarketCharms++)}}var t=null,i=null;return n.getInstance=function(){return t==null&&(t=new n),t},n.setImagePath=function(n){i=n},n.getImagePath=function(){return i},n.prototype.getCharms=function(){return this.m_charms},n.prototype.getNumCharms=function(){return this.m_numCharms},n.prototype.getMarketCharms=function(){return this.m_mktCharms},n.prototype.getNumMarketCharms=function(){return this.m_numMarketCharms},n.prototype.getCharm=function(n){return this.m_charms[n.toUpperCase()]},n}(),Charm=function(n,t,i,r){this.m_id=t,this.m_altText=null,this.m_isSelected=!1,this.m_imgCluster=n+".png",this.m_imgClusterWhite=n+"w.png",this.m_topPos=0,this.m_leftPos=0,this.m_ind=r,this.parse(i)},Charm.prototype.isSelected=function(){return!!this.m_isSelected},Charm.prototype.setIsSelected=function(n){this.m_isSelected=n},Charm.prototype.altText=function(){return this.m_altText},Charm.prototype.ind=function(){return this.m_ind},Charm.prototype.parse=function(n){var t=n.split(":");this.m_altText=t[0].slice(1),this.m_topPos=t[1],this.m_leftPos=t[2]},Charm.prototype.render=function(n,t,i,r,u){var f=new $StringBuilder;return f.append("<div class='Charm"),r?f.append("'"):f.append(this.m_isSelected?" buttonPressed ecxt_bci'":" buttonRest'"),n&&(f.append(" charmId='"),f.append(this.m_id),f.append("'")),t&&f.append(getEffectHandlerAttributesHtml($B.FF_M4)),f.append(">"),i&&f.append("<a href='javascript:;' class='localAction'>"),f.append("<div class='charmClip"),u&&f.append(" charmClip12x12"),f.append("'><img src='"),f.append(CharmsManager.getImagePath()),u?f.append(this.m_imgClusterWhite):f.append(this.m_imgCluster),f.append("' alt='"),f.append(this.m_altText),f.append("' title='' style='top:"),f.append(this.m_topPos),f.append("px;left:"),f.append(this.m_leftPos),f.append("px;'"),f.append(" /><\/div>"),i&&f.append("<\/a>"),f.append("<\/div>"),f.toString()},Charm.prototype.getElement=function(n,t,i){var r=document.createElement("DIV");return r.innerHTML=this.render(n,t,i),r.firstChild},CharmPicker=function(n,t,i,r,u){function g(){h.setNoneString(t),a()}function v(){jQuery(o.getElement("charmPicker")).unbind("click",w),jQuery(o.getElement("charmpickerpopup")).unbind("click",k)}function a(){var n,t;v(),n=new $StringBuilder,n.append("<table class='charmPickerControlTable'><tr><td><table class='charmPicker'"),n.append(o.getIdTag("charmPicker")),n.append("><tr><td"),s||n.append(" class='clickable'"),n.append(">"),s||n.append("<a href='javascript:;'>"),e?(t=CharmsManager.getInstance().getCharm(e),t&&n.append(t.render(null,null,null,!0))):(n.append("<div class='charmPickerNone'>"),n.append(l),n.append("<\/div>")),s||n.append("<\/a>"),n.append("<\/td>"),s||(n.append("<td class='clickable charmPickerChev CustomDropdownChevron"),n.append("'>&nbsp;<\/td>")),n.append("<\/tr><\/table><\/td><\/tr><\/table>"),c.innerHTML=n.toString(),s||jQuery(o.getElement("charmPicker")).click(w)}function w(){f||(f=new Calendar.SimplePopup(c,{closeOnFocusOut:!0,m_dontRepositionYAxis:$B.Mobile?!0:!1}),jQuery(f).bind("hidePopup",b)),h.show()}function b(){f.isVisible()&&a()}function nt(){var n=new $StringBuilder,s;n.append("<div class='charmPickerContainer'"),n.append(o.getIdTag("charmpickerpopup")),n.append("><table class='charmPickerTable'>"),n.append("<tr><td colspan='"),n.append(y),n.append("'><a href='javascript:;' class='localAction'><div class='charmPickerNonePopup TextSizeNormal"),n.append(e?" buttonRest'":"'"),n.append(getEffectHandlerAttributesHtml($B.FF_M4)),n.append(">"),n.append(l),n.append("<\/div><\/a><\/td><\/tr>");var r=CharmsManager.getInstance().getMarketCharms(),u=0,t=null,i=0;for(s in r)t=r[s],t.setIsSelected(t.m_id==(e?e.toUpperCase():null)),u++,i=u%y,i===1&&n.append("<tr class='CharmRow'>"),n.append("<td"),i===1?n.append(" class='FirstCol'"):i===0&&n.append(" class='LastCol'"),n.append(">"),n.append(t.render(!0,!0,!0,!1,t.isSelected())),n.append("<\/td>"),i===0&&n.append("<\/tr>");n.append("<\/table><\/div>"),f.setContent(n.toString(),"")}function k(n){e=null;var t=Dom.getNearestParentWithClass(n.target,"Charm",c);t!=null&&(e=t.getAttribute("charmId")),h.hide()}var y=13,h=this,p=null;this.$=function(){return p||(p=jQuery(h))};var f=null,e=r==""?null:r,d=n,l=null,c=i,o=new Calendar.IdManager(i),s=!1,tt=u;this.setSelectedCharmId=function(n,t){e=n,s=t,a()},this.getSelectedCharmId=function(){return e},this.show=function(){var n=WebUtilities.getLocation(c);nt(),f&&(jQuery(o.getElement("charmpickerpopup")).click(k),f.show(n))},this.hide=function(){f&&(v(),f.hide())},this.dispose=function(){v(),f&&(jQuery(f).unbind("hidePopup",b),f.dispose()),h=f=e=d=l=c=o=null},this.setNoneString=function(n,t){var i=new $StringBuilder;t?(i.append("<div class='charmPickerUseDefault'>"),i.append(CharmsManager.getInstance().getCharm(t).render(!1,!1,!1,!0)),i.append(n),i.append("<\/div>")):i.append(n),l=i.toString()},this.rerender=function(){a()},g()},Calendar.ColorPicker=function(n,t){function v(){var r,h,s;for(o=t.imagePath?t.imagePath:"",f=t.contentStrings,r=null,r=isSutraEnabled===!0?new $StringBuilder("<ul class='colorPicker'"+getSutraAttribute("CalendarColors")+">"):new $StringBuilder("<ul class='colorPicker'>"),h=f.colorAltStrings,s=0;s<NUMBER_OF_COLORS;s++)isSutraEnabled===!0?r.append("<li class='colorPickerCheck' sutra='color"+new String(h[s]).toLowerCase()+"'><a href='#' class='"):r.append("<li class='colorPickerCheck'><a href='#' class='"),r.append("'><span class='color"),r.append(s),r.append("'><img colorindex='"),r.append(s),r.append("' alt='"),r.append(h[s]),r.append("' src='"),r.append(o),r.append("p.gif' /><\/span><\/a><\/li>");r.append("<\/ul>"),n.innerHTML=r.toString(),u=Dom.getDescendantsWithClass(n,"colorPicker",1,"UL")[0],i=u.getElementsByTagName("IMG"),isNaN(t.selectedIndex)||c(t.selectedIndex),jQuery("a",u).bind({"click.colorp":a,"keypress.colorp":y}),Dom.addClass(n,"+Calendar_ColorPicker"),n.webBinding=e}function a(n){var i=n.target,t;t=i.tagName==="IMG"?i:jQuery("img",i).filter(":first"),t&&c(s(t))}function y(n){var t=Dom.getKeyCodeFromDomEvent(n);(t===Dom.KeyCode.Space||t===Dom.KeyCode.Enter)&&(a(n),n.returnValue=!1)}function s(n){var t=jQuery(n).attr("colorindex");return parseFloat(t)}function h(n,t,i){t?(Dom.addClass(n,"+checked"),n.alt=f.selectedFormatString.format(f.colorAltStrings[i])):(Dom.addClass(n,"-checked"),n.alt=f.colorAltStrings[i])}function c(n){var e,t,f;if(i=u.getElementsByTagName("IMG"),r>0)h(i[r],!1,r),h(i[n],!0,n);else for(e=i.length,t=0;t<e;t++)f=i[t],h(f,s(f)===n,t);r=n}var e=this,l=null;this.$=function(){return l||(l=jQuery(e))};var u=null,i=null,o=null,f=null,p=null,r=-1;this.dispose=function(){jQuery(u).unbind(".colorp"),n=i=u=t=e=o=f=null},this.setSelectedIndex=function(n){c(n)},this.getSelectedIndex=function(){var t,u,n;if(r>0)return r;for(t=null,u=i.length,n=0;n<u;n++)if(Dom.isClassPresent(i[n],"checked")){t=i[n],r=n;break}return t?s(t):-1},v()},Calendar.ColorPicker.registerClass_lf("Calendar.ColorPicker"),Calendar.UserToolbarInfo=function(){this.viewElements={MonthView:["calendarMonthGrid","accHintLink","accContentLink"],WeekView:["calendardayContent","accHintLink","accContentLink"],DayView:["calendardayContent","accHintLink","accContentLink"],AgendaView:["calendarAgendaView","accHintLink","accContentLink"],TaskView:["calendarTaskView","accHintLink","accContentLink"],NewEventView:["fullScreenEventEditor"],NewTaskView:["fullScreenEventEditor"],ReadOnlyEventView:["fullScreenEventEditor"],ReadOnlyTaskView:["fullScreenEventEditor"],EditEventView:["fullScreenEventEditor"],EditTaskView:["fullScreenEventEditor"],CalendarGeneralSettingsView:["calendarGeneralSettingsContainer"]},this.pageSequenceNames={MonthView:"TraditionalMonthView",WeekView:"TraditionalWeekView",DayView:"DayView",AgendaView:"AgendaView",TaskView:"TaskView",NewEventView:"FullScreenEventEdit",ReadOnlyEventView:"FullScreenReadOnly",EditEventView:"FullScreenEventEdit",NewTaskView:"FullScreenAddTask",ReadOnlyTaskView:"FullScreenReadOnly",EditTaskView:"FullScreenTaskEdit"}},Calendar.ViewNavigator=function(n,t){function v(){jQuery(t.viewNavigationMenu).click(h),gController.registerCommands(i,["NavigateToView"])}function s(n){var e=!1,s=l[Calendar.getViewNameFromEnum(n)],h,a,v;return n!=r&&(Dom.addClassToElementsInArray(o[Calendar.getViewNameFromEnum(r)],"+displayNone"),Dom.addClassToElementsInArray(o[Calendar.getViewNameFromEnum(n)],"-displayNone"),h=n==CAL.DisplayView.DayView||n==CAL.DisplayView.WeekView||n==CAL.DisplayView.MonthView||n==CAL.DisplayView.AgendaView||n==CAL.DisplayView.TaskView,Dom.addClass(f,(h?"-":"+")+"displayNone"),p(n===CAL.DisplayView.TaskView),a=n==CAL.DisplayView.NewEventView||n==CAL.DisplayView.ReadOnlyEventView||n==CAL.DisplayView.EditEventView,Dom.addClass(t.editorElem,(a?"-":"+")+"displayNone"),v=n==CAL.DisplayView.NewTaskView||n==CAL.DisplayView.ReadOnlyTaskView||n==CAL.DisplayView.EditTaskView,Dom.addClass(t.taskEditorElem,(v?"-":"+")+"displayNone"),c(r,!1),c(n,!0),y(n),gController.doCommand("TrackAction",{trackId:s}),r=n,e=!0),e&&i.$().trigger("viewnav_viewchanged",[r]),e}function h(n){$menu.closeCurrent();var t=jQuery(n.srcElement).attr("viewId");t!=null&&i.changeDisplay(parseInt(t))}function c(n,i){jQuery("a[viewId='"+n+"']",t.viewNavigationMenu).toggleClass("Selected",i)}function y(n){var i=jQuery("a[viewId='"+n+"']",t.viewNavigationMenu).filter(":first"),r,u;i&&i.length&&(r=i.contents()[1].nodeValue,u=jQuery("a > span",t.viewNavigationMenu.parentElement).filter(":first"),u.text(a.title.format(r)))}function p(n){jQuery(".navPagination",f).toggleClass("visHidden",n)}var i=this,e=null;this.$=function(){return e||(e=jQuery(i))};var r=null,u=null,f=n,o=t.toolbarInfo.viewElements,l=t.toolbarInfo.pageSequenceNames,a=t.contentStrings;this.dispose=function(){gController.unregisterCommands(i),jQuery(t.viewNavigationMenu).unbind("click",h),i=f=null},this.doCommand=function(n,t){switch(n){case"NavigateToView":i.navigate(t)}},this.getCurrentViewName=function(){return r},this.getPreviousViewName=function(){return u},this.navigateToPreviousEventView=function(){s(u),$B.IE&&document.activeElement&&["INPUT","TEXTAREA"].contains(document.activeElement.tagName)&&document.activeElement.blur()},this.navigate=function(n,t){return u==null?u=Calendar.isEventOrTaskView(n)?n:getInitialDisplayView():Calendar.isEventOrTaskView(n)||Calendar.isEventOrTaskView(r)&&(u=r),s(n,t)},this.changeDisplay=function(n){gController.doCommand("TrackAction",{trackId:"SwitchView",attributes:{CalendarVew:gController.getViewNameInstrumentation(n)}}),i.$().trigger("viewnav_requestdisplaychange",[i.getCurrentViewName(),n])},this.update=function(){var n=jQuery(t.viewNavigationMenu).prop("binding");n&&n.update()},v()},Calendar.ViewNavigator.registerClass_lf("Calendar.ViewNavigator"),Calendar.ViewNavigatorButtons=new $Flags("Month",0,"Week",1,"Day",2,"Agenda",3,"Task",4),Calendar.DelayLoadManager=function(){function u(t,i){n.push({fn:t,params:i})}function f(n,t){n(t)}var r=this,t=null,i,n;this.$=function(){return t||(t=jQuery(r))},i=!1,n=[],this.requireDelayLoad=u,this.setDelayLoadCompleted=function(){for(this.requireDelayLoad=f,i=!0;n.length>0;){var t=n.shift();t.fn(t.params)}},this.isDelayLoadCompleted=function(){return i}},Calendar.DelayLoadManager.registerClass_lf("Calendar.DelayLoadManager"),Calendar.OnDemandLoader=function(){function s(){t&&i.featureScriptLoaded(t),n.length>0?(t=n.shift(),$Network.fetchScript(t,s)):i.notifyFeaturesLoaded(o,u)}var u=this,f=null;this.$=function(){return f||(f=jQuery(u))};var i=null,e=null,r=null,o=[],n=[],t;this.requireFeatures=function(t,u,f,h){for(var l,a,v,c=0;c<t.length;c++)if(l=h.Features[t[c]],l){for(a=0;a<l.length;a++)v=l[a],h.isFeatureScriptLoaded(v)||n.exists(v)||n.push(v);o.push(t[c])}i=h,r=f,e=u,s()},this.go=function(){r&&r(e)}},Calendar.OnDemandLoader.registerClass_lf("Calendar.OnDemandLoader"),Calendar.OnDemandLoadManager=function(){var n=this,i=null,r={},t;this.$=function(){return i||(i=jQuery(n))},t=[],this.dispose=function(){n=t=n.Features=null},this.registerFeatures=function(t){n.Features=t},this.requireFeatures=function(i,r,u){if($B.BlackBerry&&$B.V>=5&&$B.V<6)return u(r);var f=new Calendar.OnDemandLoader;t.push(f),f.requireFeatures(i,r,u,n)},this.notifyFeaturesLoaded=function(i,r){n.$().trigger("featuresloaded",[i,r]),t.remove(r)},this.featureScriptLoaded=function(n){r[n]=!0},this.isFeatureScriptLoaded=function(n){return!!r[n]}},Calendar.OnDemandLoadManager.registerClass_lf("Calendar.OnDemandLoadManager"),Calendar.GridNavigator=function(n,t){function rt(){r=_ge("dateLabel"),jQuery(s,n).bind("click.gnav",ut),jQuery(h,n).bind("click.gnav",ft),jQuery(r).bind({"click.gnav":b,"mouseenter.gnav":et,"mouseleave.gnav":ot,"keypress.gnav":st})}function ut(){u.$().trigger("gridnav_paginationaction",["previous"])}function ft(){u.$().trigger("gridnav_paginationaction",["next"])}function a(){clearTimeout(c),c=null}function v(){clearTimeout(l),l=null}function et(){a(),c=setTimeout(function(){k(),o=!0},tt)}function ot(){a(),v(),d()&&(l=setTimeout(i.hide,it))}function b(){a(),v(),o=!1,d()||k()}function st(n){(n.keyCode===Dom.KeyCode.Enter||n.keyCode===Dom.KeyCode.Space)&&(b(),n.returnValue=!1)}function k(){gController.getCurrentViewName()!==CAL.DisplayView.TaskView&&(i||(i=new Calendar.CalendarPopup(n,{imagePath:g,contentStrings:nt,suppressFocusOnShow:!0,isHeaderClickable:!0}),jQuery(i).bind({"dateselected.gnav":lt,"todaylinkclicked.gnav":at,"headerClicked.gnav":vt}),jQuery(w,n).bind({"mouseenter.gnav":ht,"mouseleave.gnav":ct})),i.setStartDate(gController.getAppState().getTargetStartDate()),i.show({dockElement:r}))}function ht(){v()}function ct(){o&&(o=!1,i.hide())}function d(){return!!(i&&i.isShown())}function lt(n,t){i.hide(),gController.doCommand("GoToDate",{targetDate:t})}function at(){i.hide(),gController.doCommand("GoToToday"),gController.doCommand("TrackAction",{trackId:"ToolbarTodayButton",attributes:gController.getViewInstrumentation()})}function vt(n,t){i.hide(),gController.doCommand("ShowMonthView",{targetDate:t})}var u=this,y=null;this.$=function(){return y||(y=jQuery(u))};var g=t.imagePath,nt=t.contentStrings,p=new Calendar.IdManager,f=null,e=null,r=null,s="#previousButton",h="#nextButton",i=null,o=!1,tt=500,it=200,c=null,l=null,w=".PopUpDialogContainer";this.disableGridExpansionLinks=function(n){f||(f=p.getElement("expandGrid")),e||(e=p.getElement("collapseGrid")),n?(Dom.disableLink(f),Dom.disableLink(e)):(Dom.enableLink(f),Dom.enableLink(e))},this.dispose=function(){i&&(jQuery(i).unbind(".gnav"),jQuery(w,n).unbind(".gnav")),jQuery(s,n).unbind(".gnav"),jQuery(h,n).unbind(".gnav"),jQuery(r).unbind(".gnav"),u=r=i=null},this.setDateLabelText=function(t){jQuery(s,n).show(),jQuery(h,n).show(),jQuery(r).text(t)},this.setDateLabelPointer=function(n){jQuery(r).css("cursor",n?"pointer":"default")},rt()},Calendar.GridNavigator.registerClass_lf("Calendar.GridNavigator"),registerNamespace("Calendar"),Calendar.Model=function(){function o(t){n.enableloadingindicator&&t.type==$Network.Type.XMLPost&&(r==0&&window.setTimeout(h,n.loadingindicatordelay),r++)}function s(){n.enableloadingindicator&&(r--,r<=0&&t.$().trigger("requestcomplete"))}function h(){r>0&&t.$().trigger("requestinprogress")}function e(n,i,r){errorContext=i!=Calendar.ErrorCodes.FppRequestTimeout&&i!=Calendar.ErrorCodes.HttpMisconfiguration&&r?{message:r,error:n}:{title:u.connectionErrorTitle,message:u.connectionError},errorContext.errorCode=i,t.$().trigger("servererror",errorContext)}var t=this,f=null;this.$=function(){return f||(f=jQuery(t))};var i=null,n=null,u=null,r=0;this.getCalendarService=function(){return i},this.init=function(t,r){n=t,u=r,$Network.Events.onerror.attach(this.network_cb_onError),$Network.Events.onhttperror.attach(this.network_cb_onError),$Network.Events.onrequest.attach(o),$Network.Events.onfinished.attach(s),$Network.defaultTimeout=n.defaultfpptimeout;var f=new CAL.FppProxySettings;f.PartnerId=0,f.Version=n.fppversion,f.CommandType=n.fppcmd,f.SessionId=n.sessionidhash,f.CanaryToken=n.canary,f.DefaultRetry=n.fppretry,f.AuthUser=n.authuser,f.AllowDuplicate=!0,i=CAL.initializeEx(n.fppUrl,f),i.FppProxySettings.DateType=i.FppDateType.Local},this.dispose=function(){n=u=i=t=boundElem=null},this.setFppError=function(n){t.network_cb_onError(n)},this._cb_processError=function(n,t,i,r){e(r,n,r?r.Message:null)},this.network_cb_onError=function(n){n.Context&&n.Context.customError||e(n.Error,n.ErrorCode,n.Error?n.Error.Message:null)},Calendar.Model.registerBaseMethod(this,"init"),Calendar.Model.registerBaseMethod(this,"dispose"),Calendar.Model.registerBaseMethod(this,"_cb_processError"),Calendar.Model.registerBaseMethod(this,"network_cb_onError")},Calendar.Model.registerClass_lf("Calendar.Model"),Calendar.DesktopModel=function(){function rt(){var n=new Calendar.Date(h.getYear(),h.getMonth(),1),t,i;return n.moveToStartOfWeek(),t=n.addDays(ei*oi),i={DateRange:{StartDate:n,EndDate:t}},i}function bt(){n.$().trigger("bootstrapfailed")}function si(t,i){var r=rt();r.InnerContext={ControlInstanceName:"bootstrapControls",WaitForServer:!1},n.setBootData(t,r,i)}function hi(t,i,r){n.setBootData(t,i,r)}function ci(t,i){c=t,c.oContext=i,n.$().trigger("postbootstrapdatareceived")}function li(i,r){var u=t.getCalendarById(r.calendarId);u.subscriptionCalendarInfo=i,n.$().trigger("calendardetailsreceived",[u,r])}function ai(t,i){n.$().trigger("calendardetailsreceived",[t,i.innerContext])}function vi(n){if(n){var t=parseInt(n.ErrorCode,16);t>=Calendar.ErrorCodes.AbchDownRangeBegin&&t<=Calendar.ErrorCodes.AbchDownRangeEnd&&nt()}}function yi(i,r){var u=i.Calendar,e,o;u&&(Calendar.Event.fixDateTypeInCalendarArray([u]),kt(u,r.DefaultReminders),e=t.getCalendarById(u.Guid),e&&ut(e,u),t.registerCalendars([u]),n.$().trigger("calendarsaved",[u,r.InnerContext])),o=i.Events,o&&f(o,r,"eventsadded")}function pi(i,r,u){var f,e;u?n.$().trigger("calendarsharingsettingsnotsaved",[r,u]):(f=t.getCalendarById(r.calendarId),i.SharingPermission!=f.SharingPermission&&(e={CalendarId:f.Guid,OldPermissionLevel:f.SharingPermission,NewPermissionLevel:i.SharingPermission},n.$().trigger("calendarpermissionlevelchanged",[e])),i.SharingPermission==CAL.SharingPermissionLevel.Null?g(r.calendarId,r):(ut(i,f),t.registerCalendars([f])),n.$().trigger("calendarsharingsettingssaved",[r,i]))}function wi(i,r){var u=i.Calendar,e,s,h,o;u&&(Calendar.Event.fixDateTypeInCalendarArray([u]),e=t.getCalendarById(u.Guid),e&&ut(e,u),t.registerCalendars([u]),n.$().trigger("calendarrefreshed",[u,r.InnerContext]),s=t.unregisterEventsOnCalendar(u.Guid),h=tt(s),n.$().trigger("eventsdeleted",[h])),o=i.Events,o&&f(o,r,"eventsadded")}function kt(n,t){var r,i;if(t!=null&&t.length>0){for(r=[],i=0;i<t.length;i++)r[i]={},r[i].OffsetTime=parseInt(t[i].PLReminderOffset),r[i].ModalityGuid=t[i].ModalityGuid;applicationSettings.userDefaultCalendarReminders[n.Guid]=r}else applicationSettings.userDefaultCalendarReminders[n.Guid]=null}function ut(n,t){t.IsShared=n.IsShared,t.IsPublicPublished=n.IsPublicPublished,t.IsAllowSharingViaUrl=n.IsAllowSharingViaUrl,t.SharingPermission=n.SharingPermission}function l(t,i,r){var u=new CAL.TasksQueryObject;return u.BuildTaskList=t,u.NumberOfSearchResults=i,u.CalendarList=r?[r]:n.getVisibleCalendars(),u.ReturnCompletedTasks=y.ShowCompletedTasks,u.ReturnIncompleteTasks=!0,u}function dt(n){n.ControlInstanceName="taskView"}function e(){return b?0:-1}function ft(r,u,f){var s=!y.DataReceived&&!f,o,e;if(s&&(t.unregisterAllItemsByType(CAL.CalendarItemType.TaskItem),i.clear(),n.$().trigger("cleartasklist")),y.DataReceived=!0,f){for(o=[],e=0;e<r.length;e++)r[e].ItemType==CAL.CalendarItemType.TaskItem&&o.push(r[e]);r=o,dt(u),u.isBootstrap=!0}else Calendar.Event.fixDateTypeInEventArray(r),t.registerEvents(r);ii(r,f,!1,!1),n.$().trigger("eventsexist",[r,u])}function bi(n){for(var f=!1,t,u,r=0;r<n.length;r++)t=n[r],t.ItemType==CAL.CalendarItemType.TaskItem&&(u=i.findInsertLoc(t,yt),(u==i.length||t.Guid!=i[u].Guid)&&(i.insert(u,t),f=!0));return f}function gt(){return y.DataReceived}function p(n){var r=!1,u,t;if(i.length){for(u=[],t=0;t<n.length;t++)n[t].ItemType==CAL.CalendarItemType.TaskItem&&u.push(n[t].Guid);for(t=0;t<i.length;t++)u.indexOf(i[t].Guid)>=0&&(i.removeAt(t--),r=!0)}return r}function ki(n){var t=di(n);t!=-1&&i.removeAt(t)}function di(n){for(var t=0;t<i.length;t++)if(i[t].Guid==n)return t;return-1}function ni(){for(var t=[],n=0;n<i.length;n++)i[n].EventProgress==CAL.EventProgress.Completed&&t.push(i[n]);return t}function gi(i,r){p(r.CompletedTasks),t.unregisterEvents(r.CompletedTasks),n.$().trigger("eventsdeleted",[ri(r.CompletedTasks)])}function nr(n,i){for(var r=0;r<n.length;r++)if(t.getEventId(n[r])==i)return n[r];return null}function tr(n,i){var u=t.getEventById(n),f,r;if(!u&&i)for(f=t.getRecurringEventSeries(n),r=0;r<f.length;r++)if(f[r].Guid==n){u=f[r];break}return u}function ir(n){var u=Calendar.Event.isRecurringEvent(n)&&!n.IsRecurrenceException?n.ParentGuid:null,i,r;if(u){for(i=t.getRecurringEventSeries(u),r=0;r<i.length;r++)i[r].IsRecurrenceException&&(i.removeAt(r),r--);i.length>0&&v(i,!0)}}function rr(t,i){n.$().trigger("calendarcolorchanged",[i.calendar])}function ur(t,i){n.$().trigger("calendarpositionchanged",[i.calendar,i.position])}function ti(i,r,u){var s,a,h,e;pltTimerMarkReceivedData();var v=r.eventId,o=null,l=tr(r.eventId,r.oContext.getSeries),c=[i];if(u&&(c=u,Calendar.Event.fixDateTypeInEventArray([i])),s=i.Alarms,s)for(a=s.length,h=0;h<a;h++)s[h].ModalityGuid==applicationSettings.sharedClientAlarmModalityGuid&&(s[h].ModalityGuid=applicationSettings.userClientAlarmModalityGuid);ir(i),f(c,r,"eventssaved"),o=t.getCalendarById(r.calendarId),e=null,e=u&&!r.oContext.getSeries?Calendar.FullEvent.CreateFromFullMasterAndStubInstance(i,nr(u,r.eventId)):Calendar.FullEvent.cloneEvent(i),t.appendClientProperties(e,t.getEventId(e),o),t.appendClientProperties(i,t.getEventId(i),o),n.$().trigger("eventdetailsreceived",[e,o,r.oContext,i,l])}function fr(n,t){var i=t.RecurrenceState.shouldDeleteExceptions||t.RecurrenceState.ConvertRecurringToNonRecurringEnum==2||t.IsChangingCalendar;t.EventSaved.Guid&&t.EventSaved.Guid!=""?(ct(t.Event,t.RecurrenceState.isEditingSeries,!0,i),f(n,t,"eventssaved")):o(n,t)}function er(i,r){var u,o,e,s,f;if(Calendar.Event.fixDateTypeInEventArray([i]),Calendar.FullEvent.isRecurringEvent(i))if(i.IsRecurrenceException)o=t.getEventId(i),u=t.getEventById(o),u.Alarms=i.Alarms;else for(e=t.getRecurringEventSeries(i.ParentGuid),s=e.length,f=0;f<s;f++)u=e[f],u.IsRecurrenceException||(u.Alarms=i.Alarms);else u=t.getEventById(i.Guid),u.Alarms=i.Alarms;n.$().trigger("readonlyeventsaved",[r,u])}function o(t,i){i.IsBirthday&&$WLXContacts.deltaSync();var r=t.length;if(r==0&&i.EventSaved){n.$().trigger("eventsoutofrangeadded",[i.EventSaved,i.InnerContext?i.InnerContext:{}]);return}f(t,i,"eventsadded")}function a(n,t){(n.length==0||t.EventSaved.Guid&&t.EventSaved.Guid!=n[0].Guid)&&v([t.EventSaved],!0),f(n,t,"eventssaved")}function or(n,t){$WLXContacts.deltaSync(),ct(t.EventSaved,!0,!0,!0),f(n,t,"eventssaved")}function ii(t,r,u,f){u&&(f?i.clear():p(t));var e=bi(t);return n.$().trigger("tasksreceived"),e}function f(i,r,u){var f,e,o;r.isTogglingCalendarOn&&(t.getCalendarById(r.CalendarToToggle).IsVisibleToCurrentUser=!0),Calendar.Event.fixDateTypeInEventArray(i),f=Calendar.Event.cloneEvents(i),t.registerEvents(f),e=r.tasksQueryObj,o=ii(f,!1,!0,e&&e.BuildTaskList),r.InnerContext&&jQuery.extend(r,r.InnerContext),n.$().trigger(u,[f,r])}function et(i,r){r.RecurringEvent?ct(r.Event,r.DeleteSeries,!0,r.DeleteSeries):(t.isEventInCache(r.pDeletedEvent.Guid)&&v([r.pDeletedEvent],!1),ki(r.pDeletedEvent.Guid),n.$().trigger("eventsdeleted",[r.eventIds]))}function ot(i,r){Calendar.Event.fixDateTypeInCalendarArray(i),t.registerCalendars(i),n.$().trigger("calendarsexist",[i,r])}function sr(i,r){var u=t.getCalendarById(r.calendarId);n.$().trigger("calendarsharingsettingsreceived",[i,u,r])}function hr(n,t){var i=n.Calendar,r;i&&(kt(i,t.DefaultReminders),d(i,t.InnerContext)),r=n.Events,r&&f(r,t,"eventsadded")}function d(i,r){Calendar.Event.fixDateTypeInCalendarArray([i]),t.registerCalendars([i]),n.$().trigger("calendarsadded",[[i],r])}function g(i,r){var u=t.unregisterEventsOnCalendar(i),f=t.unregisterCalendar(i),e=tt(u);p(u),n.$().trigger("calendarremoved",[f,e,r])}function cr(n,t){g(n,t)}function lr(i,r){var u=r.calendarId;t.getCalendarById(u).IsVisibleToCurrentUser=!1,n.$().trigger("eventsdeleted",[r.RemovedEventIds,!1,u])}function ar(t,i){n.$().trigger("calendarprivatefreebusysharingurlreset",[t,i])}function vr(t,i){n.$().trigger("calendarprivatedetailsharingurlreset",[t,i])}function yr(n,t){setSetting(["timeZoneNum",t.timeZone],["timeZoneOffset",n]),t.DoBootstrap&&gController.doCommand("Bootstrap")}function st(n){if(n!=null&&n.length>0)for(var t=0;t<n.length;t++)if(n[t]>=Calendar.ErrorCodes.AbchDownRangeBegin&&n[t]<=Calendar.ErrorCodes.AbchDownRangeEnd)return!0;return!1}function nt(i,r){var u=[];n.$().trigger("sharingdown",[i,r,t.getAllCalendars()])}function ht(i,r,u){var f=r.InnerContext,e=r.DateRange,o=r.WaitForServer;Calendar.Event.fixDateTypeInEventArray(i),t.registerEventsForDateRange(i,e),u&&st(u.ErrorCode)&&nt(r),o&&(i=t.getEventsByDateRange(f.DateRange)),n.$().trigger("eventsexist",[i,f])}function pr(t,i,r){r&&r.ErrorCode==Calendar.ErrorCodes.SubscriptionPending||n.$().trigger("stoppolling",[i.calendarId]),r||o(t,i)}function v(i,r){return removedEventIds=tt(i),t.unregisterEvents(i),r&&n.$().trigger("eventsdeleted",[removedEventIds]),removedEventIds}function tt(n){for(var i=[],r=n.length,t=0;t<r;t++)i.push(n[t].CacheEventId);return i}function ri(n){for(var i=[],r=n.length,t=0;t<r;t++)i.push(n[t].Guid);return i}function ui(){ot(r.Calendars,u.InnerContext),vt==CAL.DisplayView.AgendaView&&n.$().trigger("agenda_data_requested"),ht(r.Events,u),CAL.DisplayView[getSetting("savedView")]==CAL.DisplayView.TaskView&&ft(r.Events,u,!0),k=!0,n.$().trigger("bootstrapcompleted",[r.BirthdayCalendarBackgroundUpdate])}function fi(){ot(r.Calendars,u),u=null,r=null,c!=null&&n.setPostBootData(c,c.oContext)}function ct(i,r,u,f){var o=[],e=null,c,l,s,h;if(r)for(c=t.getRecurringEventSeries(i.ParentGuid),l=c.length,e=[],s=0;s<l;s++)h=c[s],(!h.IsRecurrenceException||f)&&(o.push(h.CacheEventId),e.push(h));else o.push(i.CacheEventId?i.CacheEventId:t.getEventId(i)),e=[i];t.unregisterEvents(e),u&&n.$().trigger("eventsdeleted",[o])}function lt(t,i){return Calendar.Event.isCalendarReadOnly(i)?(n.$().trigger("eventsnotsaved",[[t],Calendar.DesktopModel.EventsNotSavedReason.ReadOnlyCalendar]),!0):!1}function wr(t,i){n.$().trigger("exchangesharingsaved",[i])}function br(t,i,r,u){var f=parseInt(u.ErrorCode,16);f==Calendar.ErrorCodes.SharingPermissionDenied?n.$().trigger("exchangesharingerror",[f]):(i.customError=!1,n.network_cb_onError({Context:i,Error:u,ErrorCode:f,Proxy:r}))}var n,at;Calendar.DesktopModel.initializeBase_lf(this,arguments),n=this,at=null,this.$=function(){return at||(at=jQuery(n))};var s=null,t=null,h=null,w=null,vt=CAL.DisplayView.MonthView,i=[],b=!1,yt=null,y={ShowCompletedTasks:!1,DataReceived:!1},r=null,u=null,it=null,pt=!1,wt=!1,k=!1,c=null,ei=6,oi=7;this.init=function(i,r){s=i,Calendar.DesktopModel.callBaseMethod_lf(n,"init",arguments),vt=i.initViewName,w=r,yt=n.compareTasksByDate,t=new Calendar.ModelCache,t.initialize(),h=new Calendar.Date,getSetting("isRruPresent")&&(getSetting("targetDate")?h=new Calendar.Date(parseInt(getSetting("targetDate"))*1e3):s.alternatebootstraprangestart&&(h=new Calendar.Date(s.alternatebootstraprangestart*1e3)))},this.dispose=function(){Calendar.DesktopModel.callBaseMethod_lf(n,"dispose",arguments),t.dispose(),i&&i.clear(),t=i=r=u=w=null},this.initBootFetch=function(){var t=rt();t.InnerContext={ControlInstanceName:"bootstrapControls",WaitForServer:!1},n.getCalendarService().GetBootstrapPackage(t.DateRange.StartDate,t.DateRange.EndDate,hi,t)},this.postBootstrap=function(){var t=rt();t.InnerContext={ControlInstanceName:"postBootstrapControls",WaitForServer:!1},n.getCalendarService().DoPostBootstrapTasks(t.DateRange.StartDate,t.DateRange.EndDate,ci,t,jQuery.noop)},this.processBootData=function(bootstrapData){var fppPkg=eval(bootstrapData);fppPkg?fppPkg.Value.Calendars&&fppPkg.Value.Calendars.length?si(fppPkg.Value,fppPkg.OutRefParams.length?fppPkg.OutRefParams[0]:null):bt():bt()},this.getTargetDate=function(){return h},this.handleFirstRunExperience=function(t,i,r){n.getCalendarService().HandleFirstRunExperience(t,i,yr,{DoBootstrap:r,timeZone:t})},this.releaseBootstrapPackage=function(){r?ui():pt=!0,it&&st(it.ErrorCode)&&nt()},this.releaseBootstrapPackageForDelayLoadedControls=function(){r?fi():wt=!0},this.getAgendaViewDataForPrinting=function(n,i){var r={StartDate:n,EndDate:i},u=t.isEventQueryAnswerable(r);return u?t.getEventsByDateRange(r):null},this.getAgendaViewData=function(t,i){var r={StartDate:t,EndDate:i},u={DateRange:r,ControlInstanceName:"calendarAgendaView"};n.$().trigger("agenda_data_requested",[r]),n.getEventsByDateRange(t,i,u,!0)},this.returnCachedEventsByDateRange=function(n,i){var r=null,u=t.isEventQueryAnswerable(n);return(u&&(r=t.getEventsByDateRange(n)),r.length&&!i)?Calendar.Event.cloneEvents(r):r},this.getEventsByDateRange=function(i,r,u,f){var e,s,o,c,h;k&&(e={StartDate:i,EndDate:r},s=t.isEventQueryAnswerable(e),s||(o=t.trimRangeToOnlyUncachedDates(e),c={DateRange:o,InnerContext:u,WaitForServer:f},n.getCalendarService().GetEventsByDateTimeAndCalendars(n.getVisibleCalendars(),null,o.StartDate,o.EndDate,ht,c)),(!f||s)&&(h=t.getEventsByDateRange(e),h&&n.$().trigger("eventsexist",[Calendar.Event.cloneEvents(h),u])))},this.updateTaskProgress=function(i,r,u,f){if(t.isEventInCache(i)){var e=t.getEventById(i);e.EventProgress!=r&&(e.EventProgress=r,n.getCalendarService().UpdateEventWithStubResult(e,[CAL.PLEventFields.EventProgress],u.StartDate,u.EndDate,a,{EventSaved:e,InnerContext:f},n._cb_processError))}},this.getFullEvent=function(i,r,u){var f=i,e=null,o,s,h;t.isEventInCache(f)?(o=t.getEventById(f),e=t.getCalendarByEventId(f).Guid,Calendar.Event.isRecurringEvent(o)&&(f=o.Guid)):(s=i.indexOf("|"),s!=-1&&(f=f.substr(0,s)),e=u.calendarId),f!=null&&e!=null&&(h={oContext:u,eventId:i,calendarId:e,removeOnAccessDenied:!0},pltTimerMarkRequestingData(),n.getCalendarService().GetEventWithRange(e,f,r.StartDate,r.EndDate,ti,h,n._cb_processError))},this.getCachedEvent=function(i,r,u){var o=i,s=null,h=!1,f=null,e=null,c;t.isEventInCache(o)?(f=t.getEventById(o),e=t.getCalendarByEventId(o),s=e.Guid,Calendar.Event.isRecurringEvent(f)&&!Calendar.Event.isBirthdayCalendar(e)&&(h=!0,o=f.Guid)):u.event?(f=u.event,e=t.getCalendarById(f.CalendarGuid),f.Calendar=e):(h=!0,s=u.calendarId),c={oContext:u,eventId:i,calendarId:s},h&&o!=null&&s!=null?n.getCalendarService().GetEventWithRange(s,o,r.StartDate,r.EndDate,ti,c,n._cb_processError):f!=null&&e!=null&&n.$().trigger("eventdetailsreceived",[Calendar.FullEvent.cloneEvent(f),e,u])},this.getEventPreviewDetails=function(n){return t.getEventById(n)},this.saveEvent=function(i,r,u,f,h,c){var y={InnerContext:c,EventSaved:i},p=null,w,b,k;f&&(p=t.trimEventCacheToSingleRange(f)),r&&n.$().trigger("preeventssaved",[[i]]),w=null,!r&&gt()&&(w=l(!1,e(),i.CalendarGuid)),y.TasksQueryObj=w,b=Calendar.FullEvent.cloneEvent(i),r||(y.isTogglingCalendarOn=!0,y.CalendarToToggle=i.CalendarGuid),u&&i.Guid?(c.savingRecurringEvent=!0,y.Event=i,y.RecurrenceState=u,y.IsChangingCalendar=h,n.getCalendarService().SaveRecurringEventWithStubResult(b,u.isEditingSeries,u.shouldDeleteExceptions,u.ConvertRecurringToNonRecurringEnum,s.ignoreCalendarVisibility?null:r,p.StartDate,p.EndDate,w,fr,y,n._cb_processError)):(k=r&&i.Guid?a:o,n.getCalendarService().SaveEventWithStubResult(b,s.ignoreCalendarVisibility?null:r,p.StartDate,p.EndDate,w,k,y,null),!r&&i.Guid&&v([i],!0))},this.saveBirthday=function(i,r,u,f){var e={InnerContext:f,EventSaved:i,IsBirthday:!0},h=null,c;u&&(h=t.trimEventCacheToSingleRange(u)),r&&n.$().trigger("preeventssaved",[[i]]),r||(e.isTogglingCalendarOn=!0,e.CalendarToToggle=i.CalendarGuid),c=r&&i.Guid?or:o,n.getCalendarService().SaveBirthdayEvent(i.ExternalId,i.FirstName,i.LastName,i.Birthdate,i.Alarms,i.CharmId,s.ignoreCalendarVisibility?null:r,h.StartDate,h.EndDate,c,e,n._cb_processError),!r&&i.Guid&&v([i],!0)},this.updateEventStartTime=function(t,i,r){var e=t.Event.Calendar,u=Calendar.Event.cloneEvent(t.OriginalEvent),f=Calendar.Event.cloneEvent(t.Event);lt(u,e)||Calendar.Event.areEventsEqual(u,f)||(u.EventTimeInUserTimeZone=!0,f.EventTimeInUserTimeZone=!0,n.getCalendarService().UpdateEventWithStubResult(f,[CAL.PLEventFields.StartTime],i.StartDate,i.EndDate,a,{EventSaved:t.Event,InnerContext:r},n._cb_processError))},this.updateEventEndTime=function(t,i,r){var e=t.Event.Calendar,f=Calendar.Event.cloneEvent(t.OriginalEvent),u=Calendar.Event.cloneEvent(t.Event);lt(f,e)||Calendar.Event.areEventsEqual(f,u)||(u.EventTimeInUserTimeZone=!0,n.getCalendarService().UpdateEventWithStubResult(u,[CAL.PLEventFields.EndTime],i.StartDate,i.EndDate,a,{EventSaved:t.Event,InnerContext:r},n._cb_processError))},this.moveEventUsingStartTime=function(t,i,r){var e=t.Event.Calendar,f=Calendar.Event.cloneEvent(t.OriginalEvent),u=Calendar.Event.cloneEvent(t.Event);lt(f,e)||Calendar.Event.areEventsEqual(f,u)||(u.EventTimeInUserTimeZone=!0,n.getCalendarService().UpdateEventWithStubResult(u,[CAL.PLEventFields.StartTime,CAL.PLEventFields.EndTime],i.StartDate,i.EndDate,a,{EventSaved:t.Event,InnerContext:r},n._cb_processError))},this.saveReadOnlyEvent=function(t,i){var r=Calendar.FullEvent.cloneEvent(t);n.getCalendarService().UpdateEventAlarms(r,er,i,n._cb_processError)},this.deleteRecurringEvent=function(t,i){n.$().trigger("preeventsdeleted",[[t.Guid]]);var r={Event:t,DeleteSeries:i,RecurringEvent:!0};n.getCalendarService().DeleteRecurringEvent(t,i,et,r,n._cb_processError)},this.deleteEvents=function(i,r){var u,e,f;n.$().trigger("preeventsdeleted",[i]),u=null,u=t.isEventInCache(i[0])?t.getEventById(i[0]):r.events[0],r.pDeletedEvent=u,e=r.events[0].MeetingRequestOperation?r.events[0].MeetingRequestOperation:null,f=t.getCalendarById(u.CalendarGuid),Calendar.Event.isBirthdayCalendar(f)?($BSI.reportEvent("DeleteRemove.Event.Birthday",{}),n.getCalendarService().DeleteBirthdayEvent(f.Guid,u.Guid,et,r,n._cb_processError)):n.getCalendarService().DeleteEvent(f.Guid,u.Guid,e,et,r,n._cb_processError)},this.getAllCalendars=function(i,r){if(k){var u=t.getAllCalendars();if(u.length===0)wLive.Controls.Notifications.createModalDialog({title:w.noCalendarsErrorTitle,content:w.noCalendarsError,buttons:{action:gController.getStrings().ok}}).show();else{if(r)return u;n.$().trigger("calendarsexist",[u,i])}}},this.getCalendar=function(i,r){var u=t.getCalendarById(i);return u||n.getCalendarService().GetCalendarById(i,!0,d,r,n._cb_processError),u},this.hasBirthdayCalendar=function(){var n=t.getAllCalendars(),i;if(n&&n.length)for(i=0;i<n.length;i++)if(Calendar.Event.isBirthdayCalendar(n[i]))return!0;return!1},this.getBirthdayCalendar=function(){var n=t.getAllCalendars(),i;if(n&&n.length)for(i=0;i<n.length;i++)if(Calendar.Event.isBirthdayCalendar(n[i]))return n[i];return null},this.getSubscriptionCalendarInfo=function(i,r){var u=t.getCalendarById(i);u&&!u.subscriptionCalendarInfo&&n.getCalendarService().GetSubscriptionCalendarInfo(i,li,{calendarId:i,innerContext:r},n._cb_processError)},this.getCalendarById=function(t,i){n.getCalendarService().GetCalendarById(t,!0,ai,{calendarId:t,innerContext:i},n._cb_processError)},this.makeCalendarsVisibleInGroupMode=function(i,r,u,f){for(var a={InnerContext:f},h=t.trimEventCacheToSingleRange({StartDate:r,EndDate:u}),c,s=0;s<i.length;s++)t.getCalendarById(i[s]).IsVisibleToCurrentUser=!0;c=l(!1,e()),c.CalendarList=i,n.getCalendarService().GetEventsByDateTimeAndCalendars(i,c,h.StartDate,h.EndDate,o,a)},this.setCalendarInvisible=function(i,r,u){var e=t.unregisterEventsOnCalendar(i),o=tt(e),f,s;p(e),f={},s=Function.emptyFunction,r&&u?(f.RemovedEventIds=o,f.calendarId=i,s=lr):(t.getCalendarById(i).IsVisibleToCurrentUser=!1,n.$().trigger("eventsdeleted",[o,!1,i])),r&&n.getCalendarService().SetCalendarInvisible(i,null,s,f,null)},this.updateCalendarVisibility=function(i,r,u,f,s,h){if(r){var a=t.trimEventCacheToSingleRange({StartDate:u,EndDate:f}),v={InnerContext:s,isTogglingCalendarOn:!0,CalendarToToggle:i},c=null;gt()&&(c=l(!1,e(),i)),v.TasksQueryObj=c,n.getCalendarService().SetCalendarVisible(i,a.StartDate,a.EndDate,c,o,v,n._cb_processError)}else n.setCalendarInvisible(i,!0,h)},this.pollCalendarEventsByDateRange=function(i,r,u,f){if(k){var s={InnerContext:f},o=t.trimEventCacheToSingleRange({StartDate:r,EndDate:u});n.getCalendarService().PollCalendarEventsByDateTime(i,o.StartDate,o.EndDate,pr,s,null)}},this.getCalendarDetails=function(n,i){var r=t.getCalendarById(n),u;r!=null?(u=Calendar.Event.isSubscriptionCalendar(r),u&&!r.subscriptionCalendarInfo?this.getSubscriptionCalendarInfo(n,i):this.getCalendarById(n,i)):this.getCalendarById(n,i)},this.getCalendarColorIndex=function(n){var i=t.getCalendarById(n);return i?i.ColorIndex:-1},this.getCalendarCharmId=function(n){var i=t.getCalendarById(n);return i?i.CharmId:null},this.getCalendarVisibility=function(n){var i=t.getCalendarById(n);return i?i.IsVisibleToCurrentUser:!1},this.getCalendarSharingSettings=function(t,i){n.getCalendarService().GetCalendarSharingSettings(t,sr,i,n._cb_processError)},this.sendExchangeSharing=function(t,i,r,u,f){f.customError=!0,n.getCalendarService().RespondToExchangeSharingRequest(t,i,r,u,!0,wr,f,br)},this.setCalendarColor=function(i,r){var u=t.getCalendarById(i),f;u&&(u.ColorIndex=r,f={calendar:u},n.getCalendarService().SetCalendarColor(i,r,rr,f,n._cb_processError))},this.moveCalendar=function(i,r){var u=t.getCalendarById(i),f;u&&(t.moveCalendar(i,r),f={calendar:u,position:r},n.getCalendarService().ReorderCalendar(i,r,ur,f,n._cb_processError))},this.saveCalendarGeneralSettings=function(t,i,r){var f={InnerContext:r,DefaultReminders:t.DefaultReminders},u=t.Guid==null,e=u&&Calendar.Event.isBirthdayCalendar(t),o=u?hr:yi,s=e;n.getCalendarService().SaveCalendarSettingsWithDefaultReminders(t.Guid,t.Name,t.ColorIndex,t.Description,t.HasDailyEmailSummaryEnabled,t.CharmId,s,i.StartDate,i.EndDate,t.CalendarType,t.DefaultReminders,t.IgnoreDefaultReminders,t.NotificationModalityId,t.UpdateChangeNotification,o,f,null)},this.saveCalendarSharingSettings=function(t,i){n.getCalendarService().SaveCalendarSharingSettings(t.Guid,t.MemberSharingEnabled,t.PrivateUrlsEnabled,t.PrivateVisibility,t.AddMembers,t.UpdateMembers,t.DeleteMembers,t.TimeZoneNum,t.TasksPermissionLevel,pi,i,n._cb_processError)},this.refreshCalendar=function(i,r,u,f){var e={InnerContext:f},o;r||(e.isTogglingCalendarOn=!0,e.CalendarToToggle=i),o=t.trimEventCacheToSingleRange(u),n.getCalendarService().RefreshCalendar(i,r,o.StartDate,o.EndDate,wi,e,null)},this.addNewCalendar=function(t,i,r,u){n.getCalendarService().SaveCalendarFormData(t,i,r,null,d,u,null)},this.deleteCalendar=function(i,r){var u=t.getCalendarById(i);u&&r&&Calendar.Event.isBirthdayCalendar(u)&&(r.isBirthdayCalendar=!0),n.getCalendarService().DeleteCalendar(i,cr,r,n._cb_processError)},this.resetCalendarPrivateFreeBusySharingUrl=function(t,i){n.getCalendarService().PublishingResetCalendarPrivateFreeBusyId(t,ar,i)},this.resetCalendarPrivateDetailSharingUrl=function(t,i){n.getCalendarService().PublishingResetCalendarPrivateDetailId(t,vr,i)},this.saveCompletedTaskSectionState=function(i){var u,f,r;y.ShowCompletedTasks=i,i?(u=l(!1,e()),u.ReturnIncompleteTasks=!1,f={InnerContext:{taskAction:"getCompletedTasks"}},dt(f.InnerContext),n.getCalendarService().GetTasks(u,o,f,null)):(r=ni(),p(r),t.unregisterEvents(r),n.$().trigger("eventsdeleted",[ri(r),!1,null,"hideCompletedTasks"])),setSetting(["taskViewShowDone",i])},this.savePersistentView=function(t){n.getCalendarService().SetLastDisplayView(t,Function.emptyFunction,null),setSetting(["savedView",Calendar.getViewNameFromEnum(t)])},this.isLimitedTaskMode=function(){return b},this.setIsLimitedTaskMode=function(t){b=t,n.$().trigger("taskslimitedmodechanged",[b])},this.getAllTasks=function(t){t.clearTaskCache=!0,n.getCalendarService().GetTasks(l(!0,e()),ft,t,null)},this.getTasks=function(t){n.getCalendarService().GetTasks(l(!0,e()),ft,t,null)},this.getDefaultCalendarGuid=function(){var n=null,i=t.getDefaultCalendar();return i&&(n=i.Guid),n},this.clearAllCompletedTasks=function(){var i=ni(),r={CompletedTasks:i};n.getCalendarService().ClearAllCompletedTasks(null,gi,r)},this.setBootData=function(n,t,i){var f,e;if(r=n,u=t,r.NumberOfCircleCalendars>0)for(f=r.Calendars,f[0].IsVisibleToCurrentUser=!0,e=1;e<f.length;e++)f[e].IsVisibleInNonGroupMode=f[e].IsVisibleToCurrentUser,f[e].IsVisibleToCurrentUser=!1;u.InnerContext.GroupCalendarCount=n.NumberOfCircleCalendars,pt?(ui(),wt&&fi(),i&&st(i.ErrorCode)&&nt(t,!0)):it=i},this.setPostBootData=function(t,i){var u=[];t.BirthdayCalendar&&(g(t.BirthdayCalendar.Guid,i),u.push(t.BirthdayCalendar)),t.UpdatedGroupCalendars&&(u=u.concat(t.UpdatedGroupCalendars)),u.length>0&&ot(u,i.InnerContext),t.Events&&t.Events.length>0&&ht(t.Events,i),n.$().trigger("postbootstrapcompleted",[t.BirthdayCalendarBackgroundUpdate]),c=null},this.compareTasksByDate=function(n,t){var r,u,i;return n.EventProgress==CAL.EventProgress.Completed&&t.EventProgress!=CAL.EventProgress.Completed?1:n.EventProgress!=CAL.EventProgress.Completed&&t.EventProgress==CAL.EventProgress.Completed?-1:n.EventProgress==CAL.EventProgress.Completed?n.CompletedDate.valueOf()-t.CompletedDate.valueOf():(r=n.DateEnd,u=t.DateEnd,r==null&&(r=new Calendar.Date,r.moveToEndOfDay(),r.setTime(r.getTime()-1e3)),u==null&&(u=new Calendar.Date,u.moveToEndOfDay(),u.setTime(u.getTime()-1e3)),i=r.valueOf()-u.valueOf(),i!=0)?i:(i=(n.IsAllDayEvent?0:1)-(t.IsAllDayEvent?0:1),i!=0)?i:(i=n.Priority-t.Priority,i!=0)?i:n.CreatedDate.valueOf()-t.CreatedDate.valueOf()},this.getVisibleCalendars=function(){for(var i=t.getAllCalendars(),r=[],n=0;n<i.length;n++)i[n].IsVisibleToCurrentUser&&r.push(i[n].Guid);return r},this.network_cb_onError=function(i){var f,r;if(i&&i.Context&&i.Context.removeOnAccessDenied){var e=null,u=null,o=parseInt(i.ErrorCode,16);o==Calendar.ErrorCodes.ServerErrorGetEventAlreadyDeleted||o==Calendar.ErrorCodes.PermissionErrorEventNoReadPermissions?u=i.Context.eventId:o==Calendar.ErrorCodes.ServerErrorGetCalendarAlreadyDeleted&&(e=i.Context.calendarId),u&&(f=t.getEventById(u),r=[],f!=null&&(f.Guid==f.ParentGuid&&(r=t.getRecurringEventSeries(u)),r.push(f)),r&&r.length>0&&v(r,!0)),e&&g(e)}Calendar.DesktopModel.callBaseMethod_lf(n,"network_cb_onError",arguments)},this._cb_processError=function(t,i,r,u){vi(u),Calendar.DesktopModel.callBaseMethod_lf(n,"_cb_processError",arguments)}},Calendar.DesktopModel.registerClass_lf("Calendar.DesktopModel","Calendar.Model"),Calendar.DesktopModel.EventsNotSavedReason=new $Enum("ReadOnlyCalendar"),Calendar.ModelCache=function(){function f(n){return o.indexOf(n.ItemType)==-1}function e(n,t){return n.DateStart&&n.DateEnd&&Calendar.Event.isEventInRange(n.DateStart.getTime(),n.DateEnd.getTime(),t.StartDate.getTime(),t.EndDate.getTime())}function u(t){var i=n[t];return n[t]=null,delete n[t],i}function s(t,r,u){i.appendClientProperties(t,r,u),n[r]=t}function h(n){return t[n]=null,delete t[n],n}var i=this,n=null,t=null,r=null,o=[CAL.CalendarItemType.TaskItem];this.initialize=function(){n={},t={},r=new Calendar.LineSegmentManager,r.initialize()},this.dispose=function(){i.disposeEventCache(),r.dispose(),r=null,t=null,n=null,i=null},this.disposeEventCache=function(){for(var t in n)n[t]=null;n={},r.clear()},this.registerEvents=function(n){for(var i,t=0,r=n.length;t<r;t++)i=n[t],s(i,this.getEventId(i),this.getCalendarById(i.CalendarGuid))},this.unregisterEvents=function(n){for(var i=n.length,t=0;t<i;t++)u(this.getEventId(n[t]))},this.unregisterEventsOnCalendar=function(t){var i=[],r;for(r in n)n[r].CalendarGuid==t&&i.push(u(r));return i},this.unregisterCalendar=function(n){for(var i in t)if(t[i].Guid==n)return h(i);return null},this.unregisterAllItemsByType=function(t){var i=[],r;for(r in n)n[r].ItemType==t&&i.push(u(r));return i},this.getEventId=function(n){var t=null;return t=n.RecurrenceId?n.ParentGuid+"|"+n.RecurrenceId:n.Guid},this.getEventById=function(t){return n[t]},this.getRecurringEventSeries=function(t){var i=[],r;for(r in n)n[r].ParentGuid==t&&i.push(n[r]);return i},this.moveCalendar=function(n,r){var u=i.getAllCalendars(),f=i.getCalendarById(n);u.remove(f),u.insert(r,f),t={},i.registerCalendars(u)},this.registerCalendars=function(n){for(var r,u,i=0;i<n.length;i++)r=n[i],u=r.Guid,t[u]=r},this.getAllCalendars=function(){var n=[],i;for(i in t)n.push(t[i]);return n},this.getDefaultCalendar=function(){if(t)for(var n in t)if(t[n].IsDefaultCalendar)return t[n]},this.getCalendarById=function(n){return t[n]},this.getCalendarByEventId=function(n){var t=i.getEventById(n);return i.getCalendarById(t.CalendarGuid)},this.isEventInCache=function(n){var t=i.getEventById(n);return t!=null},this.registerEventsForDateRange=function(n,t){var u={Start:t.StartDate.valueOf(),End:t.EndDate.valueOf()};r.setRange(u,!0),i.registerEvents(n)},this.isEventQueryAnswerable=function(n){var t={Start:n.StartDate.valueOf(),End:n.EndDate.valueOf()};return r.isRangeMarked(t)},this.getEventsByDateRange=function(t){var r=[],i;for(i in n)f(n[i])&&e(n[i],t)&&r.push(n[i]);return r},this.getAllTasks=function(){var t=[],i;for(i in n)n[i].ItemType==CAL.CalendarItemType.TaskItem&&t.push(n[i]);return t},this.trimEventCacheToSingleRange=function(t){var o={Start:t.StartDate.valueOf(),End:t.EndDate.valueOf()},i;for(i in n)f(n[i])&&!e(n[i],t)&&u(i);return r.trimToRange(o),t},this.trimRangeToOnlyUncachedDates=function(n){var i={Start:n.StartDate.valueOf(),End:n.EndDate.valueOf()},t=r.truncateRange(i);return{StartDate:new Calendar.Date(t.Start),EndDate:new Calendar.Date(t.End)}},this.appendClientProperties=function(n,t,i){n.Calendar=i,n.CacheEventId=t}},Calendar.LineSegmentManager=function(){function r(t){for(var r=n.length,u,i=0;i<n.length;i++)if(u=n[i],u.Start>t.Start){r=i;break}n.insert(r,t)}function i(t){for(var i=0;i<n.length;i++)if(n[i]==t)return i}var t=this,n=null;this.initialize=function(){n=[]},this.dispose=function(){t.clear(),n=null},this.clear=function(){n.clear()},this.trimToRange=function(t){var i={Start:t.Start,End:t.End};n.clear(),n.push(i)},this.setRange=function(u,f){var o,s,c,l,h,e,a;if(f){if(o=t.getRangeWhichEnclosesValue(u.Start),s=t.getRangeWhichEnclosesValue(u.End),!o&&!s){for(e=0;e<n.length;e++)c=n[e],c.Start>=u.Start&&c.End<=u.End&&(n.removeAt(e),e--);r(u)}if(!o||o!==s)if(o)for(o.End=s?s.End:u.End,h=i(o),e=h+1;e<n.length;e++)if(l=n[e],l)if(l.Start>o.End)break;else n.removeAt(e),e--;else break;else if(s&&!o)for(s.Start=u.Start,h=i(s),e=h-1;e>=0;e--)if(a=n[e],a)if(a.End<s.Start)break;else n.removeAt(e);else break}},this.toString=function(){for(var t="<--",i=0;i<n.length;i++){var r=n[i],u=new Calendar.Date(r.Start),e=u.getMonth()+"/"+u.getDate(),f=new Calendar.Date(r.End),o=f.getMonth()+"/"+f.getDate();t+="["+e+"-"+o+"]",t+="--"}return t+="-->"},this.isRangeMarked=function(t){for(var r,i=0;i<n.length;i++)if(r=n[i],r.Start<=t.Start&&r.End>=t.End)return!0;return!1},this.truncateRange=function(t){for(var r=t,i,u=0,f=n.length;u<f;u++)i=n[u],i.Start<=t.Start&&i.End>t.Start?r.Start=i.End:i.Start<t.End&&i.End>=t.End&&(r.End=i.Start);return r},this.getRangeWhichEnclosesValue=function(t){for(var r,i=0;i<n.length;i++)if(r=n[i],t>=r.Start&&t<=r.End)return r}},registerNamespace("Calendar"),Calendar.View=function(n,t){function d(n,t){var u,e;switch(t){case"CalendarGeneralSettingsControl":r.calendarSettings||addCalendarSettingsContentStrings(r),i.calendarGeneralSettingsControl=new Calendar.CalendarGeneralSettingsControl(_ge("calendarGeneralSettingsContainer"),{contentStrings:r.calendarSettings,imagePath:o,groupProfileURL:getSetting("groupProfileUrl")});break;case"FullScreenEventEditor":r.fullScreenEventEditor||addFullScreenEventEditorContentStrings(r),r.fullScreenCommonEditor||addFullScreenCommonEditorContentStrings(r),r.sharedFullScreenEventEditor||addSharedFullScreenEventEditorContentStrings(r),r.fullScreenEventEditor.common=r.fullScreenCommonEditor,u=new Calendar.DesktopFullScreenEventEditorView(_ge("fullScreenEventEditor"),r.fullScreenEventEditor,v),u&&(u.initialize({readOnlyModel:f,timezones:r.timeZone}),i.fullScreenEventEditor=u);break;case"FullScreenTaskEditor":r.fullScreenTaskEditor||addCalendarSettingsContentStrings(r),r.fullScreenCommonEditor||addFullScreenCommonEditorContentStrings(r),r.fullScreenTaskEditor.common=r.fullScreenCommonEditor,e=new Calendar.DesktopFullScreenTaskEditorView(_ge("fullScreenTaskEditor"),r.fullScreenTaskEditor,v),e&&(e.initialize({readOnlyModel:f}),i.fullScreenTaskEditor=e);break;case"ItemEditor":i.eventEditor=new Calendar.ItemEditorDialog(_ge("quickAddEvent"),{itemType:"event",contentStrings:r,imagePath:o,readOnlyModel:f});break;case"EventEditRsvpResponse":i.eventEditRsvpResponse=new Calendar.EventEditRsvpResponse(_ge("fullScreenEventEditor"),{contentStrings:r.eventEditRsvpResponse,imagePath:o})}}function at(n){var t=new Calendar.ResizeEngine(e);i.resizeEngine=t,i.resizeEngine.attachHandler(),i.viewNavigator=new Calendar.ViewNavigator(_ge("navigationContainer"),{imagePath:o,toolbarInfo:n,viewNavigationMenu:_ge("viewNavigatorMenu"),editorElem:_ge("fullScreenEventEditor"),taskEditorElem:_ge("fullScreenTaskEditor"),contentStrings:r.NavigationMenu}),i.gridNavigator=new Calendar.GridNavigator(_ge("gridNavigator"),{imagePath:o,contentStrings:r.miniCalendar}),i.commandBar=new Calendar.CommandBar(i.viewNavigator),(u===CAL.DisplayView.MonthView||u===CAL.DisplayView.DayView||u===CAL.DisplayView.WeekView)&&g(),(u===CAL.DisplayView.DayView||u===CAL.DisplayView.WeekView)&&nt(),u===CAL.DisplayView.AgendaView&&tt(),u===CAL.DisplayView.TaskView&&it(),i.cogMenu=new Calendar.CogMenu(_ge("c_copt"))}function g(){i.calendarMonthGrid=new Calendar.CalendarMonthGrid(_ge("calendarMonthGrid"),{contentStrings:r.monthGrid,imagePath:o,readOnlyModel:f,showIconsInEventFigures:!1,enableCharms:!0,enableDynamicRowHeights:!0,enableDynamicEventHeights:!1,expandTitlesOnRowExpansion:!1,enableBackgroundSelection:a,enableEventDragAndDrop:l,gridNavigator:i.gridNavigator})}function nt(){i.calendarDayList=new Calendar.DayViewGridList(_ge("dayView"),{contentStrings:r.dayGrid,contentStringsForMonthGrid:r.monthGrid,imagePath:o,readOnlyModel:f,initHeight:_ge("bodyContainer").offsetHeight,initWidth:document.documentElement.clientWidth-_ge("bodyContainer").offsetLeft-8,enableBackgroundSelection:a,enableCharms:!0,enableEventDragAndDrop:l,gridNavigator:i.gridNavigator})}function tt(){i.calendarAgendaView=new Calendar.AgendaView(_ge("calendarAgendaView"),{initWidth:document.documentElement.clientWidth-_ge("bodyContainer").offsetLeft-8,contentStrings:r,imagePath:o,isPublishingMode:!!getSetting("publishedPrintUrl"),userTimezone:getSetting("timeZoneNum"),readOnlyModel:f,gridNavigator:i.gridNavigator})}function it(){i.calendarTaskView=new Calendar.TaskView(_ge("calendarTaskView"),{initWidth:document.documentElement.clientWidth-_ge("bodyContainer").offsetLeft-8,contentStrings:r,imagePath:o,isPublishingMode:!!getSetting("publishedPrintUrl"),userTimezone:getSetting("timeZoneNum"),readOnlyModel:f,taskCountInLimitedMode:getSetting("taskDisplayCount")})}function y(n){var t=function(){var t=e.getControlInstance("calendarMonthGrid"),i=t.getDisplayedRange();i!=null&&n.length>0&&t.addEvents(n)};u==CAL.DisplayView.MonthView||u==CAL.DisplayView.DayView||u==CAL.DisplayView.WeekView?t():h.requireDelayLoad(t)}function c(n){var t=function(){var t=e.getControlInstance("calendarDayList");n.length>0&&t.eventExistsOnGrid(n[0])==!1?t.addEvents(n):t.adjustGridHeight()};u==CAL.DisplayView.DayView||u==CAL.DisplayView.WeekView?t():h.requireDelayLoad(t)}function rt(n){i.calendarAgendaView.setEvents(n)}function ut(n,t,i){for(var f=[],o,r=0;r<n.length;r++)n[r].ItemType==CAL.CalendarItemType.TaskItem&&f.push(n[r]);o=function(){var n=e.getControlInstance("calendarTaskView");n.tasksAdded(f,i)},u==CAL.DisplayView.TaskView?o():h.requireDelayLoad(o)}function s(){i.viewNavigator.getCurrentViewName()==CAL.DisplayView.AgendaView&&i.calendarAgendaView.refresh()}function ft(n){var t=n.Summary;t&&t.length!=0||(t=r.controller.emptytitle);var s=n.MeetingRequestOperation&&n.MeetingRequestOperation.organizerAction===CAL.OrganizerActionType.CreateMeetingRequest&&!n.IsDraft,u=n.Calendar?Calendar.Event.isBirthdayCalendar(n.Calendar):!1,e=u?null:{action:r.itemEditorCommon.viewDetails},h=r.infobaralerts[s?"Invitesent":"Eventsadded"],o=n.DateStart||n.CreatedDate,c=o.toShortDateString()+(n.IsAllDayEvent||u||!n.DateStart?"":" "+o.toCompactTimeString()),i=wLive.Controls.Notifications;i.createBottomBar({content:h.format(t.encodeHtml(),c),dismissalMode:e?i.BarDismissalMode.Implicit:i.BarDismissalMode.Timeout,buttons:e}).show().then(function(t){if(t.buttonClicked==="action")if(n.RecurrenceId||n.RecurrenceDescription||n.RecurrenceInfo)f.getCachedEvent(n.CacheEventId,gController.getAppView().getLargestDisplayedRange(),{ControlInstanceName:"fullScreenEventEditor",event:n,Callback:function(n,t,i,r,u,f){gController.doCommand("CommonClickAction",{clickAction:"editFullEvent",context:{srcElement:document.body,event:n,calendar:n.Calendar,originalEvent:f,masterEvent:u}})}});else{var i=n.ItemType===CAL.CalendarItemType.TaskItem;gController.doCommand("CommonClickAction",{clickAction:"edit",context:{dataSource:{ItemType:i?"task":"event",ItemId:n.Guid},srcElement:document.body,event:n,calendar:f.getCalendar(n.CalendarGuid),originalEvent:n}})}})}function vt(n){if(n&&n.ControlInstanceName)return n.ControlInstanceName}function yt(n,t){if(i.fullScreenEventEditor&&i.fullScreenEventEditor.getController().getIsWaitingForServer())i.fullScreenEventEditor.getController().editingComplete(t.message,t.title);else if(i.fullScreenTaskEditor&&i.fullScreenTaskEditor.getController().getIsWaitingForServer())i.fullScreenTaskEditor.getController().editingComplete(t.message,t.title);else if(i.calendarGeneralSettingsControl&&i.calendarGeneralSettingsControl.getIsWaitingForServer())i.calendarGeneralSettingsControl.refreshComplete(null,t.message);else{var u=t.message,f=parseInt(t.error&&t.error.ErrorCode?t.error.ErrorCode:t.errorCode,16);wLive.Controls.Notifications.createModalDialog({title:t.title?t.title.encodeHtml():r.alerts.ErrorTitle,content:u,buttons:{action:r.alerts.OK}}).show().then(function(){switch(f){case Calendar.ErrorCodes.SessionTimedOut:reloadMainFrame();break;default:e.$().trigger("appview_servererrorcleared")}})}s()}function pt(n,t,i){switch(i){case Calendar.DesktopModel.EventsNotSavedReason.ReadOnlyCalendar:gController.updateSpecifiedEvents(t),s(),wLive.Controls.Notifications.createModalDialog({title:t[0].Summary.encodeHtml(),content:r.modelErrors.eventModifyPermissionsError,buttons:{action:r.alerts.OK}}).show()}}function wt(n,t,r){i.fullScreenEventEditor&&r&&r.ControlInstanceName=="fullScreenEventEditor"?i.fullScreenEventEditor.getController().editingComplete():i.fullScreenTaskEditor&&r.ControlInstanceName=="fullScreenTaskEditor"&&i.fullScreenTaskEditor.getController().editingComplete(),s(),ft(t)}function et(n,t,r){var f,u;if(i.fullScreenEventEditor&&r.ControlInstanceName==="fullScreenEventEditor"?i.fullScreenEventEditor.getController().editingComplete():i.fullScreenTaskEditor&&r.ControlInstanceName==="fullScreenTaskEditor"&&i.fullScreenTaskEditor.getController().editingComplete(),f=!1,r&&r.ControlInstanceName)switch(r.ControlInstanceName){case"calendarDayList":c(t);break;case"calendarMonthGrid":y(t),c(t);break;case"taskView":ut(t,!1,r.taskAction==="getCompletedTasks");break;case"eventEditor":case"fullScreenEventEditor":case"taskEditor":case"fullScreenTaskEditor":case"bugger":u=t&&t.length>0?t[0]:r.EventSaved,u||(u=r.newEvents?r.newEvents[0]:t[0]),r.suppressToast||r.savingRecurringEvent||ft(u),i.cogMenu.showHideCalendarSelected(u.CalendarGuid,!0),f=!0;case"pollingControl":case"calendarFilter":case"calendarGeneralSettings":y(t),c(t),ut(t,f),s(),r.CalendarToToggle&&i.cogMenu.showHideCalendarSelected(r.CalendarToToggle,!0);break;case"calendarAgendaView":rt(t);break;case"bootstrapControls":case"postBootstrapControls":y(t),c(t),i.viewNavigator.getCurrentViewName()===CAL.DisplayView.AgendaView&&rt(t)}else alert("Please provide a control instance name...")}function ot(n,t,i,r,u,f){var l,c,o,s;pltTimerMarkReceivedData(),pltTimerMarkAllDownloadingComplete();switch(r.ControlInstanceName){case"fullScreenEventEditor":case"fullScreenTaskEditor":if(l=e.getControlInstance(r.ControlInstanceName),l){var o=t,a=i,v=u,s=r.Callback,h=o?Calendar.Event.isEventReadOnly(o):!1;o&&!a.IsCurrentUserOwner&&Calendar.FullEvent.isEventMeetingRequest(o)&&(h=!0),s(o,r.viewingName,!1,h,v,f,r)}break;case"eventEditor":c=e.getControlInstance("eventEditor"),c&&(o=t,c.show(i,"edit"));break;case"None":s=r.Callback,s&&s(t,i,r.Context)}}function bt(n,t,r,u,f){var e=t,h=i.calendarMonthGrid,c=i.calendarDayList,o=i.calendarTaskView;r==!1&&u&&i.cogMenu.showHideCalendarSelected(u,!1),h&&h.removeEvents(e),c&&c.removeEvents(e),s(),o&&(f=="hideCompletedTasks"&&o.setHasCompletedTasks(!1),o.tasksDeleted(e))}function st(n,t){i.fullScreenEventEditor&&t.ControlInstanceName=="fullScreenEventEditor"?i.fullScreenEventEditor.getController().editingComplete():i.fullScreenTaskEditor&&t.ControlInstanceName=="fullScreenTaskEditor"&&i.fullScreenTaskEditor.getController().editingComplete()}function kt(n,t){st(n,t)}function dt(n,t,r){var h;t.length>0&&i.cogMenu.showHideCalendarSelected(t[0].CalendarGuid,!0);var u=r.oContext,o=u?u.srcElement:null,l=o?o.ParentFigure:null,a=o&&l?l.PartNum||1:1;if(st(n,r),gController.updateSpecifiedEvents(t),h=u&&u.ControlInstanceName?u.ControlInstanceName:r.ControlInstanceName,i.calendarTaskView&&(h==="taskEditor"||h==="fullScreenTaskEditor"||h==="taskView")&&e.getControlInstance("calendarTaskView").tasksUpdated(t),s(),u&&u.refreshSrcElement){var v=i.viewNavigator.getCurrentViewName(),c=r.eventId,f=document.body;switch(v){case CAL.DisplayView.MonthView:f=i.calendarMonthGrid.getFigureElemByEventId(c);break;case CAL.DisplayView.DayView:case CAL.DisplayView.WeekView:f=i.calendarDayList.getFigureElemByEventId(c,a);break;case CAL.DisplayView.AgendaView:f=i.calendarAgendaView.getAnchorElemByEventId(c)}u.srcElement=f}}function gt(n,t,r){var o=vt(r),e,c,s,f,u;if(i.eventEditor&&i.eventEditor.addCalendarsToDropdownList(t),o==="postBootstrapControls"&&t!==undefined&&t.length)for(e=0;e<t.length;e++)i.cogMenu.calendarExist(t[e].Guid)||i.cogMenu.addCalendar(t[e]);if(o=="bootstrapControls"||o=="postBootstrapControls")for(i.exchangeSharingDialog&&i.exchangeSharingDialog.setCalendars(t),c=["calendarMonthGrid","calendarDayList","calendarTaskView","cogMenu"],s=0;s<c.length;s++)for(f=c[s],u=0;u<t.length;++u)i[f]?(i[f].setCalendarColor(t[u].Guid,t[u].ColorIndex),f=="calendarTaskView"&&(i[f].setCalendarReadOnly(t[u].Guid,Calendar.Event.isCalendarReadOnly(t[u])),t[u].IsDefaultCalendar&&i[f].setDefaultCalendar(t[u].Guid))):h.requireDelayLoad(function(n){i[n.ctrlName].setCalendarColor(n.calendarGuid,n.colorIndex),n.ctrlName=="calendarTaskView"&&(i[n.ctrlName].setCalendarReadOnly(n.calendarGuid,Calendar.Event.isCalendarReadOnly(n.calendar)),n.calendar.IsDefaultCalendar&&i[n.ctrlName].setDefaultCalendar(n.calendarGuid))},{ctrlName:f,calendarGuid:t[u].Guid,colorIndex:t[u].ColorIndex,calendar:t[u]})}function ni(n,t,u){var o=u.Callback,h,f;for(o&&o(t),h=[],f=0;f<t.length;++f)h.push(t[f]),i.calendarMonthGrid.setCalendarColor(t[f].Guid,t[f].ColorIndex),i.calendarDayList.setCalendarColor(t[f].Guid,t[f].ColorIndex),i.calendarTaskView.setCalendarColor(t[f].Guid,t[f].ColorIndex),i.calendarTaskView.setCalendarReadOnly(t[f].Guid,Calendar.Event.isCalendarReadOnly(t[f]));i.eventEditor&&i.eventEditor.addCalendarsToDropdownList(t),i.fullScreenEventEditor&&i.fullScreenEventEditor.getController().addCalendarsToDropdownList(t),i.fullScreenTaskEditor&&i.fullScreenTaskEditor.getController().addCalendarsToDropdownList(t),i.commandBar&&i.commandBar.addCalendar(t[0]),i.cogMenu.addCalendar(t[0]),s(),e.displayNotificationBar(r.infobaralerts.Calendarsadded.format(t[0].Name))}function ti(n,t){var r=t;i.calendarMonthGrid.setCalendarColor(r.Guid,r.ColorIndex),i.calendarDayList.setCalendarColor(r.Guid,r.ColorIndex),i.calendarTaskView.setCalendarColor(r.Guid,r.ColorIndex),i.cogMenu.setCalendarColor(r.Guid,r.ColorIndex),s()}function ii(n,t,r){var u=t,f=r;i.fullScreenEventEditor&&i.fullScreenEventEditor.getController().updateCalendarInDropdownList(u,f),i.fullScreenTaskEditor&&i.fullScreenTaskEditor.getController().updateCalendarInDropdownList(u,f),i.eventEditor&&i.eventEditor.updateCalendarInDropdownList(u,f)}function ri(n,t){var u=t,f=i.calendarGeneralSettingsControl;gController.doCommand("NavigateToView",CAL.DisplayView.CalendarGeneralSettingsView),f.loadFromCalendar(u),gController.doCommand("TrackAction",{trackId:Calendar.Event.isBirthdayCalendar(u)?"ExistingBirthdayCalendarSettingsPage":"ExistingCalendarSettingsPage"})}function ui(n,t,r){var u=t,f=r.Callback;f&&f(u),i.calendarMonthGrid.setCalendarCharm(u.Guid,u.CharmId),i.calendarDayList.setCalendarCharm(u.Guid,u.CharmId),i.calendarMonthGrid.setCalendarColor(u.Guid,u.ColorIndex),i.calendarDayList.setCalendarColor(u.Guid,u.ColorIndex),i.calendarTaskView.setCalendarColor(u.Guid,u.ColorIndex),i.cogMenu.updateCalendar(u),i.calendarTaskView.setCalendarReadOnly(u.Guid,Calendar.Event.isCalendarReadOnly(u)),i.eventEditor&&i.eventEditor.updateCalendarInDropdownList(u),i.fullScreenEventEditor&&i.fullScreenEventEditor.getController().updateCalendarInDropdownList(u),i.fullScreenTaskEditor&&i.fullScreenTaskEditor.getController().updateCalendarInDropdownList(u),i.commandBar&&i.commandBar.updateCalendar(u),s()}function fi(n,t,i){var r=t.CallbackForSuccess;r&&r(i)}function ei(n,t,i){var r=t.CallbackForFail;r&&r(i)}function oi(n,t){i.calendarGeneralSettingsControl.refreshComplete(t)}function si(n,t,r,u){var f=u&&u.isBirthdayCalendar;i.eventEditor&&i.eventEditor.removeCalendarFromDropdownList(t,f),i.fullScreenEventEditor&&i.fullScreenEventEditor.getController().removeCalendarFromDropdownList(t,f),i.fullScreenTaskEditor&&i.fullScreenTaskEditor.getController().removeCalendarFromDropdownList(t,f),i.commandBar&&i.commandBar.removeCalendar(t,f),i.calendarMonthGrid.removeEvents(r),i.calendarDayList.removeEvents(r),i.calendarTaskView.tasksDeleted(r),i.cogMenu.removeCalendar([t]),u.ControlInstanceName&&i.viewNavigator.navigateToPreviousEventView(),s()}function hi(){$header&&$header.showLoading()}function ci(){$header&&$header.hideLoading()}function ht(){wLive.Controls.Notifications.createModalDialog({title:r.controller.errortitle,content:r.controller.abchdown,buttons:{action:r.alerts.OK}}).show()}function li(){h.isDelayLoadCompleted()?ht():b=!0}var e=this,p=null;this.$=function(){return p||(p=jQuery(e))};var r=null,o=null,l=!0,a=!0,u=CAL.DisplayView.MonthView,ct=!1,lt=null,w=null,v=!1,b=!1,k=null,ai=250,i={},f=null,h=null;this.init=function(n){h=new Calendar.DelayLoadManager,f=n,l=t.enableGridDragDrop,a=t.enableGridBgSelection,u=t.initViewName,ct=t.isAdsDown,lt=t.subscriptionErrorThreshold,r=t.contentStrings,o=t.imagePath,w=t.toolbarInfo,v=t.isInPublishingMode,at(w),f.$().bind({"eventsexist.userv":et,"eventsadded.userv":et,"eventssaved.userv":dt,"readonlyeventsaved.userv":kt,"eventsdeleted.userv":bt,"eventdetailsreceived.userv":ot,"eventsnotsaved.userv":pt,"eventsoutofrangeadded.userv":wt,"calendarsadded.userv":ni,"calendarcolorchanged.userv":ti,"calendarsexist.userv":gt,"calendardetailsreceived.userv":ri,"calendarsaved.userv":ui,"calendarsharingsettingssaved.userv":fi,"calendarsharingsettingsnotsaved.userv":ei,"calendarrefreshed.userv":oi,"calendarremoved.userv":si,"calendarpositionchanged.userv":ii,"servererror.userv":yt,"requestinprogress.userv":hi,"requestcomplete.userv":ci,"sharingdown.userv":li}),gController.$().bind("onDemandFeatureLoaded.userv",d)},this.dispose=function(){i.fullScreenEventEditor&&i.fullScreenEventEditor.dispose(),i.fullScreenTaksEditor&&i.fullScreenTaskEditor.dispose(),i.calendarMonthGrid&&i.calendarMonthGrid.dispose(),i.calendarDayList&&i.calendarDayList.dispose(),i.calendarTaskView&&i.calendarTaskView.dispose(),i.calendarAgendaView&&i.calendarAgendaView.dispose(),i.calendarGeneralSettingsControl&&i.calendarGeneralSettingsControl.dispose(),i.eventEditor&&i.eventEditor.dispose(),i.calendarEnhancedPreview&&i.calendarEnhancedPreview.dispose(),i.eventEditRsvpResponse&&i.eventEditRsvpResponse.dispose(),i.viewNavigator&&i.viewNavigator.dispose(),i.commandBar&&i.commandBar.dispose(),f.$().unbind(".userv"),k&&k.unbind(".userv"),gController.$().unbind("onDemandFeatureLoaded",d);for(var n in i)i[n]=null;r=f=h=i=null},this.getCurrentView=function(){switch(i.viewNavigator.getCurrentViewName()){case CAL.DisplayView.MonthView:return i.calendarMonthGrid;case CAL.DisplayView.WeekView:case CAL.DisplayView.DayView:return i.calendarDayList;case CAL.DisplayView.AgendaView:return i.calendarAgendaView;case CAL.DisplayView.TaskView:return i.calendarTaskView;case CAL.DisplayView.NewEventView:case CAL.DisplayView.ReadOnlyEventView:case CAL.DisplayView.EditEventView:return i.fullScreenEventEditor;case CAL.DisplayView.NewTaskView:case CAL.DisplayView.ReadOnlyTaskView:case CAL.DisplayView.EditTaskView:return i.fullScreenTaskEditor;case CAL.DisplayView.CalendarGeneralSettingsView:return i.calendarGeneralSettingsControl}},this.getLargestDisplayedRange=function(){var n=this.getCurrentView(),t;return t=n&&n.getDisplayedRange?n.getDisplayedRange():Calendar.Date.getRangeOfCalendarMonth(gController.getAppState().getTargetStartDate())},this.getContentStrings=function(){return r},this.fireResizeEvent=function(){e.$().trigger("appview_windowresized")},this.getControlInstance=function(n){return i[n]},this.notifyDelaySourcesLoaded=function(){u!=CAL.DisplayView.MonthView&&u!=CAL.DisplayView.DayView&&u!=CAL.DisplayView.WeekView&&g(),u!=CAL.DisplayView.DayView&&u!=CAL.DisplayView.WeekView&&nt(),u!=CAL.DisplayView.AgendaView&&tt(),u!=CAL.DisplayView.TaskView&&it(),i.resizeEngine.completeDeferredResize(),r.enhPreviewEvent||addEnhancedPreviewContentStrings(r),i.calendarEnhancedPreview=new Calendar.CalendarEnhancedPreview(_ge("calendarViewsContainer"),{imagePath:o,contentStrings:r.enhPreviewEvent}),gController.initDelayed(),h.setDelayLoadCompleted(),b&&ht()},this.displayNotificationBar=function(n){var t=wLive.Controls.Notifications;t.createBottomBar({content:n.encodeHtml(),dismissalMode:t.BarDismissalMode.Timeout}).show()},e.getRRUInitData=function(){var n=null,t;if(getSetting("isRruPresent")){if(t=CAL.DisplayView[getSetting("displayView")],t!=CAL.DisplayView.DefaultView&&i.viewNavigator.getCurrentViewName()!=t)switch(t){case CAL.DisplayView.EditEventView:n={Command:"EditEvent",Params:{eventId:getSetting("eventId"),eventRecurrenceId:getSetting("eventRecurrenceId"),calendarId:getSetting("calendarId"),isRru:!0}};break;case CAL.DisplayView.EditTaskView:n={Command:"EditTask",Params:{eventId:getSetting("eventId"),calendarId:getSetting("calendarId")}};break;case CAL.DisplayView.CalendarGeneralSettingsView:n={Command:"LaunchCalendarSettingDialog",Params:{calendarGuid:getSetting("calendarId")}};break;case CAL.DisplayView.CalendarSharingSettingsView:n={Command:"LaunchCalendarSharingSettingDialog",Params:{calendarId:getSetting("calendarId")},Action:getSetting("rruAction")};break;case CAL.DisplayView.NewEventView:n={Command:"NewPrePopulatedEvent",Params:getSetting("rruAction")==="showbirthdays"?"birthday":getSetting("eventDetails"),Action:getSetting("rruAction")};break;case CAL.DisplayView.NewTaskView:n={Command:"NewPrePopulatedTask",Params:getSetting("eventDetails")}}if(!n)switch(getSetting("rruAction")){case"showbirthdays":n={Action:"ShowBirthdayCal",Params:null}}}return n},this.processActionOnLoadedFullEvent=function(n,t,i,r,u){ot(null,n,t,i,r,u)}},Calendar.View.registerClass_lf("Calendar.View"),Calendar.ResizeEngine=function(n){function v(){jQuery(window).unbind("resize",r),gController.$().unbind("disposeControllers",v),gController.unregisterCommands(u),$B.IE||(window.onresize=null)}function r(){k()&&setTimeout(p,0)}function y(){var n=document.documentElement;return!o&&n.clientHeight!=0&&n.clientWidth!=0}function k(){return y()?(e.fireResizeEvent(),document.documentElement.clientWidth<f)?(p(),!1):!0:!1}function p(){var l,c;if(y()){i=!1,l=document.documentElement,o=!0;var n=e.getCurrentView(),u=t.clientWidth<f,h=t.clientHeight,r=Math.max(t.clientWidth,f);u?(s.style.width=r+"px",t.style.overflowX="auto"):(s.style.width="auto",t.style.overflowX="hidden"),n&&typeof n.setWidth!="undefined"?n.setWidth(r):i=!0,c=h-d(jQuery("#navigationContainer").is(":visible")),n&&typeof n.setHeight!="undefined"?n.setHeight(c):i=!0,t.style.overflowY="hidden",s.style.height="auto",e.getControlInstance("viewNavigator").update(),o=!1,w.style.display="none"}}function d(n){var t=n?jQuery("#navigationContainer").outerHeight(!0):0;return(l?l.offsetHeight:0)+(a?a.offsetHeight:0)+t}var h=987,f=h,u=this,c=null;this.$=function(){return c||(c=jQuery(u))};var e=n,o=!1,i=!1,w=_ge("ContentMain"),b=_ge("c_header"),t=jQuery("#c_base")[0];jQuery(b).css("min-width",h);var l=_ge("CalendarPublishedHeader"),s=_ge("bodyWrapper"),a=_ge("m_wf");$baseMaster.toggleFixedHeader(!0),gController.$().bind("disposeControllers",v),gController.registerCommands(u,["RefreshResizeEngine"]),this.doCommand=function(n){switch(n){case"RefreshResizeEngine":u.refresh()}},this.attachHandler=function(){window.setTimeout(function(){$B.IE?jQuery(window).resize(r):window.onresize=r},1)},this.refresh=function(){r(null)},this.completeDeferredResize=function(){i&&(i=!1,r(null))}},AppState=function(){var n=CAL.DisplayView.MonthView,u=null,c=null,f=null,e=null,o=null,s=null,t=5e3,i=10,l=!!getSetting("circleId"),a=new Calendar.Date,r=null,h=null,v=!1;this.init=function(l){n=l.initViewName||n,u=l.initViewCommandName,c=l.calUrl,f=l.viewContactsUrl,e=l.editContactsUrl,o=l.cleanUpContactsUrl,s=l.marketQS,t=l.pollingInterval||t,i=l.pollingMaxRetries||i,r=l.serviceVersion,h=l.targetDate},this.getInitView=function(){return n},this.setInitView=function(t){n=t},this.getInitViewCommandName=function(){return u},this.setInitViewCommandName=function(n){u=n},this.getApplicationUrl=function(){return c},this.getViewContactsUrl=function(){return f},this.setViewContactsUrl=function(n){f=n},this.getEditContactsUrl=function(){return e},this.setEditContactsUrl=function(n){e=n},this.getCleanUpContactsUrl=function(){return o},this.setCleanUpContactsUrl=function(n){o=n},this.getMarketQS=function(){return s},this.setMarketQS=function(n){s=n},this.getPollingInterval=function(){return t},this.setPollingInterval=function(n){t=n},this.getPollingMaxRetries=function(){return i},this.setPollingMaxRetries=function(n){i=n},this.getIsGroupMode=function(){return l},this.setIsGroupMode=function(n){l=n},this.getTargetStartDate=function(){return a},this.setTargetStartDate=function(n){a=n},this.getServiceVersion=function(){return r?r:""},this.setServiceVersion=function(n){r=n},this.getBootModelTargetDate=function(){return h},this.setBootModelTargetDate=function(n){h=n},this.getIsInDragMode=function(){return v},this.setIsInDragMode=function(n){v=n}},CommandDispatcher=function(){var n={};this.registerListener=function(t,i){if(t&&i&&Object.isArray(i))for(var r=0;r<i.length;r++)n[i[r]]?n[i[r]].contains(t)||n[i[r]].push(t):n[i[r]]=[t]},this.unregisterListener=function(t,i){var r,u;if(t)if(i&&Object.isArray(i))for(r=0;r<i.length;r++)n[i[r]].contains(t)&&n[i[r]].remove(t);else for(u in n)n[u].contains(t)&&n[u].remove(t)},this.doCommand=function(t,i){var u=!1,r;if(n[t])for(r=0;r<n[t].length;r++)if(typeof n[t][r].doCommand!="undefined"&&(u=n[t][r].doCommand(t,i)),u)break;return u}},AppController=function(){function c(n){o=n}var n=this,e=null;this.$=function(){return e||(e=jQuery(n))};var o=null,s=new AppState,r=null,t=null,h=null,u=null,f=new CommandDispatcher,i=null,l=null;return this.getStrings=function(){return h},this.getAppState=function(){return s},this.getOnDemandLoadManager=function(){return i},this.getTrackingId=function(){return 0},this.init=function(f,e,o){i=new Calendar.OnDemandLoadManager,r=f,t=e,h=o.contentStrings,s.init(o),u={},jQuery(window).unload(n.dispose),jQuery(window.document).keydown(n.handleKeyDown),i.$().bind("featuresloaded.appc",n.ondemandFeaturesLoaded),n.$().trigger("initControllers",[r,t])},this.registerOnDemandFeatures=function(n){i.registerFeatures(n)},this.initOnDemand=function(i){n.$().trigger("initOnDemandControllers",[r,t,i])},this.initDelayed=function(){n.$().trigger("initDelayedControllers",[r,t])},this.getModel=function(){return r},this.getAppView=function(){return t},this.hideAllPopupDialogs=function(){n.$().trigger("hideAllPopups"),typeof $menu!="undefined"&&$menu.closeCurrent()},this.dispose=function(){jQuery(window).unbind("unload",n.dispose),jQuery(window.document).unbind("keydown",n.handleKeyDown),t.$().unbind(".appc"),i.$().unbind(".appc"),i&&i.dispose(),r.dispose(),t.dispose(),typeof m_pBugger!="undefined"&&m_pBugger.dispose(),n.$().trigger("disposeControllers")},this.registerCommands=function(n,t){f.registerListener(n,t)},this.unregisterCommands=function(n,t){f.unregisterListener(n,t)},this.doCommandWithEvent=function(t,i,r){c(t);var u=n.doCommand(i,r);return c(null),u},this.getGlobalEvent=function(){return o},this.getGlobalEventSrcElement=function(){return n.getGlobalEvent().target||n.getGlobalEvent().srcElement},this.doCommand=function(t,i){switch(t){case"SelectContentArea":n.selectNavigableElement(n.getCurrentViewContentElementID());break;case"CommonClickAction":n.$().trigger("clickAction",[i])}return f.doCommand(t,i)},this.isCalendarVisible=function(){return!0},this.saveEventData=Function.abstractMethod,this.selectNavigableElement=function(n){var t=window.document.getElementById(n);if(t){t.tabIndex=0;try{t.focus()}catch(i){}return t.tabIndex=-1,!1}return!0},this.getCurrentViewContentElementID=Function.abstractMethod,this.handleKeyDown=function(t){t.keyCode==Dom.KeyCode.Esc&&n.hideAllPopupDialogs()},this.notifyOnDemandFeatureLoaded=function(t){n.$().trigger("onDemandFeatureLoaded",[t])},this.ondemandFeaturesLoaded=function(t,i,r){for(var f=i,e=0;e<f.length;++e)u[f[e]]||(u[f[e]]=!0,n.notifyOnDemandFeatureLoaded(f[e]));n.initOnDemand(f),r.go()},this.askToEditEventOrSeries=function(t,i,r){var u=n.getStrings();wLive.Controls.Notifications.createFlyout({anchor:r,content:u.recurrenceinformation,buttons:{action:u.editoccurence,alternate:u.editseries}}).show().then(function(n){if(n.buttonClicked&&n.buttonClicked!=="close"&&i){var t={action:"Occurrence",alternate:"Series"}[n.buttonClicked];i(null,"Open",t)}})},this._setupDeleteSeries=function(t,i,r){var u=n.getStrings(),f=wLive.Controls.Notifications.createFlyout({anchor:r,content:u.alertdeleteseries,buttons:{action:u.alertdeleteoccurrence,alternate:u.alertdeleteevery}});return f.buttonMappings={action:{command:i,option:"Occurrence"},alternate:{command:i,option:"Series"}},f},AppController.registerBaseMethod(this,"init"),AppController.registerBaseMethod(this,"initOnDemand"),AppController.registerBaseMethod(this,"initDelayed"),AppController.registerBaseMethod(this,"doCommand"),AppController.registerBaseMethod(this,"doCommandWithEvent"),AppController.registerBaseMethod(this,"dispose"),AppController.registerBaseMethod(this,"isCalendarVisible"),AppController.registerBaseMethod(this,"saveEventData"),AppController.registerBaseMethod(this,"handleKeyDown"),AppController.registerBaseMethod(this,"notifyOnDemandFeatureLoaded"),AppController.registerBaseMethod(this,"ondemandFeaturesLoaded"),this},AppController.registerClass_lf("AppController"),DesktopAppController=function(){function yt(){var i=n.getStrings();wLive.Controls.Notifications.createModalDialog({title:i.errortitle,content:i.bootstrapTimeout,buttons:{action:i.ok}}).show()}function ui(){$BSI.navigateTo(getSetting("optionsPageUrl"))}function fi(){$BSI.navigateTo(getSetting("importPageUrl"))}function ei(i){var u=!t.getCalendarVisibility(i),r=f.getLargestDisplayedRange(),o=gController.getCurrentViewName()===CAL.DisplayView.AgendaView,e={ControlInstanceName:"calendarFilter",CalendarGuid:i,Checked:u};n.getAppState().getIsGroupMode()?u?(t.makeCalendarsVisibleInGroupMode([i],r.StartDate,r.EndDate,e),gController.doCommand("TrackAction",{trackId:"ShowPersonalCalendar"})):t.setCalendarInvisible(i,!1,!1):t.updateCalendarVisibility(i,u,r.StartDate,r.EndDate,e,o)}function oi(){var n=t.getBirthdayCalendar(),i;n&&!n.IsVisibleToCurrentUser&&(i=f.getLargestDisplayedRange(),t.updateCalendarVisibility(n.Guid,!0,i.StartDate,i.EndDate,{isRru:!0,ControlInstanceName:"bootstrapControls",showCalendarGuid:n.Guid}))}function si(){gWeather&&n.$().trigger("weatherUpdated")}function pt(t){var i=n.getAppState().getInitView(),u;r.getCurrentViewName()&&(i=r.getCurrentViewName()),t.itemId&&t.calendarId&&t.itemId.length>0&&t.calendarId.length>0&&(u=jQuery.extend({viewName:i,skipRecurrenceDialog:!1,isRru:!1},t),n.doCommand("EditItem",u))}function hi(){n.getAppState().setIsInDragMode(!0)}function ci(){n.getAppState().setIsInDragMode(!1)}function li(){gController.getTasksClicked()&&gController.setTasksLoaded(!0)}function ai(t,i){var r=n.getStrings();i.isEventChanged&&i.userParticipationStatus!==CAL.CalendarUserParticipationStatus.Declined?wLive.Controls.Notifications.createModalDialog({title:r.editRsvpAlertSaveTitle,content:r.editRsvpAlertSaveText,buttons:{action:r.save,close:r.cancel}}).show().then(function(n){n.buttonClicked==="action"&&ct(t,i)}):ct(t,i)}function vi(t,i){var r=n.getSelectionRange(i);gController.getCurrentViewName()!==CAL.DisplayView.MonthView&&i&&i.getDisplayMode&&i.getDisplayMode()!==Calendar.MonthGridDisplayMode.Month&&(r.IsAllDayEvent=!0),n.doCommand("ShowAddEventPopOver",{eventContext:t,timeSelection:r,trackingName:"EventQuickAddFromGridAddLink",trackingAttributes:gController.getViewInstrumentation()})}function et(t){var i=null,u=t==CAL.CalendarItemType.TaskItem;switch(r.getCurrentViewName()){case CAL.DisplayView.MonthView:i=n.getSelectionRange(o,u);break;case CAL.DisplayView.WeekView:case CAL.DisplayView.DayView:i=n.getSelectionRange(s,u);break;case CAL.DisplayView.AgendaView:i=n.getSelectionRange(c,u)}t===CAL.CalendarItemType.CalendarItem?(n.doCommand("ShowAddEventPopOver",{eventContext:null,timeSelection:i,trackingName:"ToolbarAddEventButton",trackingAttributes:gController.getViewInstrumentation()}),$BSI.reportEvent("AddCreate.Calendar.Event",{CalEntryPoint:"ToolbarQuickAdd"})):t===CAL.CalendarItemType.TaskItem?(n.doCommand("ShowAddTaskPopOver",{eventContext:null,timeSelection:i,trackingName:"ToolbarAddTask",trackingAttributes:gController.getViewInstrumentation()}),$BSI.reportEvent("AddCreate.Calendar.Task",{CalEntryPoint:"ToolbarQuickAdd"})):t==="birthday"&&n.doCommand("ShowAddBirthdayPopOver",{eventContext:null,timeSelection:i,trackingName:"ToolbarAddBirthdayButton",trackingAttributes:gController.getViewInstrumentation()})}function yi(n){for(var t=n,i;t&&t!==document;){if(i=ut.indexOf(t.id),i>=0)return i;t=t.parentNode}return-1}function pi(n){var t=n;if(!t){var i=gController.getStrings().pageTitles,f=r.getCurrentViewName(),u=i[Calendar.getViewNameFromEnum(f)];t=u?u:i.Default}window.document.title=t}function wi(i,r){n.doCommand("HideInfoBar");var u=r;n.doCommand("RefreshResizeEngine"),pi(),u!=CAL.DisplayView[getSetting("savedView")]&&isAllowedSavedView(Calendar.getViewNameFromEnum(u))&&!getSetting("publishedUrlBase")&&t.savePersistentView(u),n.hideAllPopupDialogs(),u===CAL.DisplayView.MonthView?(o.getExpansionMode()!==CAL.GridExpansionMode[getSetting("monthGridExpansionMode")]&&n.doCommand(o.getExpansionMode()?"CollapseGrid":"ExpandGrid"),o.becomeActiveView()):(u===CAL.DisplayView.WeekView||u===CAL.DisplayView.DayView)&&s.getExpansionMode()!==CAL.GridExpansionMode[getSetting("monthGridExpansionMode")]&&n.doCommand(s.getExpansionMode()?"CollapseGrid":"ExpandGrid")}function bi(n,t){wt(n.oEvent,n.currentView,n.newView,t)}function ki(t,i){var v=r.getCurrentViewName(),l=i==="previous"?-1:1,f,u,e,h,a;switch(v){case CAL.DisplayView.MonthView:u=o.getDisplayedRange(),l<0?(e=u.StartDate.addDays(-1),f=-1*Calendar.Date.getDaysInMonth(e.getFullYear(),e.getMonth())):(a=Calendar.Date.average(u.StartDate,u.EndDate),f=Calendar.Date.getDaysInMonth(a.getFullYear(),a.getMonth()),e=u.EndDate.addDays(1)),n.getAppState().setTargetStartDate(gController.getAppState().getTargetStartDate().addDays(f)),o.showMonth(e,f),o.getController().paginationAction();break;case CAL.DisplayView.WeekView:case CAL.DisplayView.DayView:u=s.getCurrentDateRange(),f=l*Calendar.Date.getDayDifference(u.StartDate,u.EndDate),e=u.StartDate.addDays(f),h=u.EndDate.addDays(f),n.getAppState().setTargetStartDate(gController.getAppState().getTargetStartDate().addDays(f)),s.showDateRange(e,h,!1),s.getController().paginationAction();break;case CAL.DisplayView.AgendaView:u=c.getDisplayedRange(),f=l*Calendar.Date.getDayDifference(u.StartDate,u.EndDate),e=u.StartDate.addDays(f),h=u.EndDate.addDays(f),n.getAppState().setTargetStartDate(gController.getAppState().getTargetStartDate().addDays(f)),c.getController().updateRange(e,h)}}function wt(t,i,u,f){at&&(!f&&gHistoryEngine&&gHistoryEngine.AddEventToHistory({oEvent:t,currentView:i,newView:u},bi),n.$().trigger("displayviewchangerequested",[i,u]),r.getCurrentViewName()!==u&&v(n.getAppState().getTargetStartDate(),u))}function v(t,i,u){var a=t?t:new Calendar.Date,e=a.clone(),h=a.clone(),l=null,v=!0,y,p;n.getAppState().setTargetStartDate(a);switch(i){case CAL.DisplayView.MonthView:o.showMonth(e);break;case Calendar.ViewNavigatorButtons.Week:e.moveToStartOfWeek(),h.moveToEndOfWeek(),s.showDateRange(e,h,!0);break;case CAL.DisplayView.DayView:e.moveToStartOfDay(),h.moveToEndOfDay(),s.showDateRange(e,h,!0);break;case CAL.DisplayView.AgendaView:y=c.getDisplayedRange(),p=Calendar.Date.getDayDifference(y.StartDate,y.EndDate),e.moveToStartOfDay(),h=e.addDays(p),h.moveToStartOfDay(),c.getController().updateRange(e,h),l=f.getContentStrings().agendaView.header;break;case CAL.DisplayView.TaskView:n.setTasksClicked(!0),n.getTasksLoaded()||n.doCommand("LoadTasks"),l=f.getContentStrings().taskView.header,v=!1}i!==r.getCurrentViewName()&&(l&&w.setDateLabelText(l),w.setDateLabelPointer(v),u||n.doCommand("NavigateToView",i))}function di(i,e){var s=!0,o=r.getCurrentViewName(),a=i,h,c,l;switch(a){case"viewSocialEvent":nr(e.dataSource.ItemId);break;case"editBirthdayDetails":getSetting("isBirthdayCalendarReadOnly")?n.showBirthdayReadOnlyError():k({itemType:e.dataSource.ItemType,itemId:e.dataSource.ItemId,viewName:o,srcElement:e.srcElement});break;case"view":case"edit":case"setReminder":k({itemType:e.dataSource.ItemType,itemId:e.dataSource.ItemId,viewName:o,srcElement:e.srcElement,refreshSrcElement:e.refreshSrcElement});break;case"viewContact":st(e.externalId,!1);break;case"editContact":st(e.externalId);break;case"sendMessage":gt(e.externalId);break;case"deleteBirthday":s=!1,h=f.getLargestDisplayedRange(),t.getCachedEvent(e.dataSource.ItemId,h,{ControlInstanceName:"None",Callback:y,Context:{srcElement:e.srcElement}});break;case"delete":s=!1,h=f.getLargestDisplayedRange(),t.getCachedEvent(e.dataSource.ItemId,h,{ControlInstanceName:"None",Callback:y,Context:{srcElement:e.srcElement}});break;case"editFullEvent":n.hideAllPopupDialogs(),c={ControlInstanceName:"fullScreenEventEditor",Callback:bt,viewingName:o,srcElement:e.srcElement},pltTimerMarkRequestingJavascript(),n.getOnDemandLoadManager().requireFeatures(["ItemEditor","FullScreenEventEditor"],{oContext:c,event:e.event,calendar:e.calendar,masterEvent:e.masterEvent,originalEvent:e.originalEvent},function(n){pltTimerMarkReceivedJavascript(),f.processActionOnLoadedFullEvent(n.event,n.calendar,n.oContext,n.masterEvent,n.originalEvent)});break;case"deleteFullEvent":c={ControlInstanceName:"None",Callback:y,Context:{srcElement:e.srcElement}},f.processActionOnLoadedFullEvent(e.event,e.calendar,c,e.masterEvent,e.originalEvent);break;case"previewEvent":l=u("calendarEnhancedPreview"),l&&e&&e.dataSource&&e.srcElement&&(e.srcElement.DataSource=e.dataSource,l.showEventPreview(e.srcElement))}s&&gHistoryEngine&&e&&e.dataSource&&gHistoryEngine.AddEventToHistory({eventId:e.dataSource.ItemId,itemType:e.dataSource.ItemType,viewingName:o},gi,n.closeFullScreenEventEditor)}function gi(n){k({itemType:n.itemType,itemId:n.eventId,calendarId:n.calendarId,viewName:n.viewingName})}function nr(i){n.hideAllPopupDialogs();var r=f.getLargestDisplayedRange();t.getFullEvent(i,r,{ControlInstanceName:"None",eventId:i,calendarId:0,Callback:tr})}function tr(n){window.top.location.href=n.Url}function k(i){var r=i.itemType,s=r==="task"?PLT_TIMER_ID_AJAX_EDIT_TASK_VIEW:PLT_TIMER_ID_AJAX_EDIT_EVENT_VIEW,h,c;pltTimerStart(s),n.hideAllPopupDialogs();var u=null,e=null,o=null;switch(r){case"event":u="fullScreenEventEditor",e=bt,o=["ItemEditor","FullScreenEventEditor"];break;case"task":u="fullScreenTaskEditor",e=ur,o=["ItemEditor","FullScreenTaskEditor"];break;default:return}h={ControlInstanceName:u,Callback:e,viewingName:i.viewName,itemType:r,eventId:i.itemId,calendarId:i.calendarId,getSeries:i.skipRecurrenceDialog,isRru:i.isRru,srcElement:i.srcElement,refreshSrcElement:i.refreshSrcElement},c=f.getLargestDisplayedRange(),pltTimerMarkRequestingJavascript(),n.getOnDemandLoadManager().requireFeatures(o,{fppContext:h},function(n){pltTimerMarkReceivedJavascript(),t.getFullEvent(i.itemId,c,n.fppContext)})}function ir(n,t,i){return n===null&&t!==null&&t.RecurrenceDescription!==null&&i!==null?!0:n&&i&&n.RecurrenceDescription!==null&&n.RecurrenceDescription!==i.RecurrenceDescription?!0:!1}function bt(t,i,r,f,o,s,h){var l=h.isRru,c,a,y,p,w,v;!l&&ir(t,o,s)?(c=u("fullScreenEventEditor").getStrings(),wLive.Controls.Notifications.createModalDialog({title:c.warningChangeRecurrencePatternTitle,content:c.majorRecurrenceChangeOnQuery,buttons:{action:c.ok}}).show()):t&&Calendar.Event.isRecurringEvent(t)&&!f?(a=n.getStrings().emptytitle,t.Summary&&t.Summary.length>0&&(a=t.Summary.encodeHtml()),y=s?Calendar.Event.quantifyChangeFromStub(t,s):{},e={pMasterEvent:o,pEvent:t,viewingGrid:i,isEventChanged:r,isReadOnly:f,changeDescription:y},h.getSeries?(p={isMasterEventFetched:!0},kt(p,"Open","Series")):n.askToEditEventOrSeries(a,kt,h.srcElement)):(w=t?t:o,v=u("fullScreenEventEditor"),v&&(v.getController().show(w,i,r,f,Calendar.Event.quantifyChangeFromStub(t,!s&&l?t:s)),n.doCommand("NavigateToView",f?CAL.DisplayView.ReadOnlyEventView:CAL.DisplayView.EditEventView))),pltTimerStop()}function kt(t,i,f){var s=n.getStrings(),o,h;if(i==="Open"&&(o=u("fullScreenEventEditor"),o)){switch(f){case"Occurrence":o.getController().setEditSeries(!1);break;case"Series":if(e.pEvent.IsRecurrenceException)return t&&t.isMasterEventFetched?(h=s.emptytitle,e.pEvent.Summary&&e.pEvent.Summary.length>0&&(h=e.pEvent.Summary.encodeHtml()),wLive.Controls.Notifications.createModalDialog({title:h,content:s.meetingRequestSeriesMissingError,buttons:{action:s.ok}}).show()):k({itemType:"event",itemId:e.pEvent.ParentGuid,calendarId:e.pEvent.CalendarGuid,viewName:r.getCurrentViewName(),skipRecurrenceDialog:!0}),!0;o.getController().setEditSeries(!0),e.pEvent=rr(e.pMasterEvent,e.pEvent)}o.getController().show(e.pEvent,e.viewingGrid,e.isEventChanged,e.isReadOnly,e.changeDescription),n.doCommand("NavigateToView",e.isReadOnly?CAL.DisplayView.ReadOnlyEventView:CAL.DisplayView.EditEventView)}}function rr(n,t){var i=t.CacheEventId;return t=n,t.CacheEventId=i,t}function ur(t,i,r,f,e){var o=u("fullScreenTaskEditor");o&&(o.getController().show(t,i,r,f,e),n.doCommand("NavigateToView",f?CAL.DisplayView.ReadOnlyTaskView:CAL.DisplayView.EditTaskView)),pltTimerStop()}function fr(i){var f,e,o,s,h,c;if(pltTimerStart(PLT_TIMER_ID_AJAX_EDIT_EVENT_VIEW),pltTimerMarkAsCacheHit(),f=Calendar.FullEvent.createNewEvent(),f.ItemType=CAL.CalendarItemType.CalendarItem,e=Calendar.Date.combineDateAndTime(n.getAppState().getTargetStartDate(),new Calendar.Date),e.setClosestHalfHour(),o=e.clone(),o=o.addMinutes(60),i&&i==="birthday"){if(s=t.getBirthdayCalendar(),!s){pltTimerStop();return}f.Calendar=s,f.IsBirthday=!0,f.Birthdate=e.clone(),f.Birthdate.setYear(gNoYear),i=null}else i?(f.Summary=i.Summary,f.Description=i.Description,f.Location=i.Location,f.DateStart=new Calendar.Date(i.StartDate*1e3),f.DateEnd=new Calendar.Date(i.EndDate*1e3),f.CustomTZStartDate=f.DateStart.clone(),f.CustomTZEndDate=f.DateEnd.clone(),f.EventTimeInUserTimeZone=!1,f.IsAllDayEvent=i.IsAllDay,f.RecurrenceId=null,f.RecurrenceInfo=null,f.CalendarGuid=i.Calendar):(f.DateStart=e,f.DateEnd=o);h=n.getAppState().getInitView(),r.getCurrentViewName()!=null&&(h=r.getCurrentViewName()),c={ControlInstanceName:"fullScreenEventEditor",viewingName:h,isEventChanged:!1},n.doCommand("TrackAction",{trackId:"AddToCalSingleEventLandingPage"}),pltTimerMarkRequestingJavascript(),n.getOnDemandLoadManager().requireFeatures(["ItemEditor","FullScreenEventEditor","EventEditorManager","EventRecurrenceManager"],{m_pModel:t,eventData:f,fppContext:c,RU:i?i.RU:null},function(t){pltTimerMarkReceivedJavascript(),pltTimerMarkAllDownloadingComplete(),n.hideAllPopupDialogs(),u("fullScreenEventEditor").getController().show(t.eventData,t.fppContext.viewingName,t.fppContext.isEventChanged,!1,null,t.RU),n.doCommand("NavigateToView",CAL.DisplayView.NewEventView),pltTimerStop()})}function er(i){var f,e,o;pltTimerStart(PLT_TIMER_ID_AJAX_EDIT_TASK_VIEW),pltTimerMarkAsCacheHit(),f=Calendar.FullEvent.createNewEvent(),f.ItemType=CAL.CalendarItemType.TaskItem,f.Priority=CAL.EventPriority.Normal,f.EventProgress=CAL.EventProgress.NotStarted,i&&(f.Summary=i.Summary,f.Description=i.Description,f.Location=null,f.DateStart=null,f.DateEnd=i.DueDate&&i.DueDate!=="''"?new Calendar.Date(i.DueDate*1e3):null,f.CustomTZStartDate=null,f.CustomTZEndDate=null,f.EventTimeInUserTimeZone=!1,f.RecurrenceId=null,f.RecurrenceInfo=null),e=n.getAppState().getInitView(),r.getCurrentViewName()!=null&&(e=r.getCurrentViewName()),o={ControlInstanceName:"fullScreenTaskEditor",viewingName:e,isEventChanged:!1},n.doCommand("TrackAction",{trackId:"AddToCalSingleTaskLandingPage"}),pltTimerMarkRequestingJavascript(),n.getOnDemandLoadManager().requireFeatures(["ItemEditor","FullScreenTaskEditor","EventEditorManager"],{m_pModel:t,eventData:f,fppContext:o,RU:i?i.RU:null},function(t){pltTimerMarkReceivedJavascript(),pltTimerMarkAllDownloadingComplete(),n.hideAllPopupDialogs(),u("fullScreenTaskEditor").getController().show(t.eventData,t.fppContext.viewingName,t.fppContext.isEventChanged,!1,null,t.RU),n.doCommand("NavigateToView",CAL.DisplayView.NewTaskView),pltTimerStop()})}function ot(t,i,r,f,e){pltTimerStart(t==="task"?PLT_TIMER_ID_POPUP_TASK_EDITOR:PLT_TIMER_ID_POPUP_EVENT_EDITOR),t!=="event"||f?t!=="task"||f?t!=="birthday"||f||(f="BirthdayQuickAdd"):f="TaskQuickAdd":f="EventQuickAdd",pltTimerMarkRequestingJavascript(),vt.requireDelayLoad(function(){n.getOnDemandLoadManager().requireFeatures(["ItemEditor"],{eventContext:i,timeSelection:r,type:t},function(t){pltTimerMarkReceivedJavascript(),pltTimerMarkAllDownloadingComplete();var i=u(t.type+"Editor");i.setBestDefaultCalendar(n.getAppState().getIsGroupMode()),i.show(t.timeSelection,t.eventContext),pltTimerStop()}),gController.doCommand("TrackAction",{trackId:f,attributes:e})})}function or(){$CSIPerf.addCsd("E","1"),pltTimerStop()}function sr(i){t.getCalendar(i,{}),n.getOnDemandLoadManager().requireFeatures(["Polling"],{calendarId:i},function(t){p||(p=new Calendar.PollingControl,p.initialize(n.getAppState().getPollingInterval(),n.getAppState().getPollingMaxRetries())),p.startPolling(function(){cr(t.calendarId)})})}function hr(){p.stopPolling()}function cr(n){var u=r.getCurrentViewName()===CAL.DisplayView.AgendaView,i=f.getLargestDisplayedRange();t.pollCalendarEventsByDateRange(n,i.StartDate,i.EndDate,{ControlInstanceName:"pollingControl",CalendarGuid:n},u)}function dt(){o=u("calendarMonthGrid"),s=u("calendarDayList"),c=u("calendarAgendaView"),tt=u("calendarTaskView")}function st(t,i){t&&(i?window.open(n.getAppState().getEditContactsUrl().format(t),"_blank"):window.open(n.getAppState().getViewContactsUrl().format(t),"_blank"))}function gt(n){n&&window.open("SendBirthdayMessage.aspx?contactId="+n,"_blank")}function lr(){window.open(n.getAppState().getCleanUpContactsUrl(),"_blank")}function ar(){$Do.when("NotificationControls",0,function(){wLive.Calendar.getFreDialog().show().then(function(n){if(n.buttonClicked==="action")t.handleFirstRunExperience(this.selectedOptionValue,!1,!0);else if(n.buttonClicked==="close"){var i=getSetting("groupProfileUrl");i&&(window.top.location=i)}})})}function vr(){switch(r.getCurrentViewName()){case CAL.DisplayView.AgendaView:c&&d("agenda","");break;case CAL.DisplayView.MonthView:d("monthView","");break;case CAL.DisplayView.DayView:case CAL.DisplayView.WeekView:var n=r.getCurrentViewName()===CAL.DisplayView.DayView?"dayView":"weekView";d(n,"");break;case CAL.DisplayView.NewEventView:case CAL.DisplayView.ReadOnlyEventView:case CAL.DisplayView.EditEventView:ni(!1);break;case CAL.DisplayView.NewTaskView:case CAL.DisplayView.ReadOnlyTaskView:case CAL.DisplayView.EditTaskView:ni(!0);break;case CAL.DisplayView.TaskView:d("taskView","")}}function ni(n){var i=u(n?"fullScreenTaskEditor":"fullScreenEventEditor"),t,r;i&&(t=i.getController().getOriginalEvent(),t&&(r="&guid="+t.Guid+"&calid="+t.CalendarGuid,d(n?"task":"event",r)))}function d(t,i){var u=getSetting("publishedPrintUrl"),r=u?u:"PrintShell.aspx";r+="?type="+t+i,r+=n.getAppState().getMarketQS()?"&"+n.getAppState().getMarketQS():"",h||(h=[]),h.push(window.open(r,"","width=980px,height=600px,menubar=yes,location=no,toolbar=yes,resizable=yes,scrollbars=no"))}function yr(n){l=null,n&&h&&h.remove(n)}function pr(n){var i=null,r=null,u=null,e;switch(n){case"agenda":i=c.getController().getRange();break;case"monthView":i=o.getDisplayedRange();break;case"dayView":case"weekView":i=s.getCurrentDateRange();break;case"taskView":e=tt,r=e.getTasks(),u=e.getTaskColors()}l={model:t,contentStrings:f.getContentStrings(),userTimezone:getSetting("timeZoneNum"),dateRange:i,datePrefs:getSetting("dateClassUserPref"),isPublishMode:!!getSetting("publishedPrintUrl")},n==="monthView"?l.displayMode=o.getDisplayMode():n==="taskView"&&(l.tasks=r,l.taskColors=u,l.isTaskLimitedMode=tt.getController().isLimitedMode(),l.isTaskCompletedSectionVisible=tt.getController().isCompletedSectionVisible())}function wr(){var r=[0,1,2,3,4,5,6,7,8,9,10,11],n=t.getAllCalendars(null,!0);if(n)for(i=0;i<n.length;i++)r.remove(n[i].calendarColor);return r}function it(t,i){var r=t?!1:!0,u=null;r&&(u=wr()),n.getOnDemandLoadManager().requireFeatures(["CalendarGeneralSettingsControl"],{calendarId:t,isNew:r,availableColors:u,newCalendarType:i},function(t){n.doCommand("LaunchCalendarSettingsDialog",t)})}function ht(i){n.getOnDemandLoadManager().requireFeatures(["CalendarSharingSettingsControl"],{calendarId:i},function(n){m_pStrings.calendarSharingSettings||addCalendarSharingContentStrings(m_pStrings),n.calendarId||(n.calendarId=t.getDefaultCalendarGuid()),b=Calendar.SharingDialogHelper.showSharingDialog(n.calendarId,m_pStrings).bind("afterdismiss",g),b.calendarGuid=n.calendarId})}function g(){n.getCurrentViewName()===CAL.DisplayView.CalendarGeneralSettingsView&&n.doCommand("EditCalendar",b.calendarGuid),b.unbind("afterdismiss",g),b=null}function y(i,f,e){var h=wLive.Controls.Notifications,c=e.srcElement||event.srcElement,w=!1,a=Calendar.Event.isBirthdayCalendar(f),o=n.getStrings(),l=o.emptytitle,g,rt,ut,p,d;if(i.Summary&&i.Summary.length>0&&(l=i.Summary.encodeHtml()),Calendar.Event.isCalendarReadOnly(f)&&!a){h.createTopBar({content:o.eventDeletePermissionsError,dismissalMode:h.BarDismissalMode.Timeout}).show();return}if(i.ItemType===CAL.CalendarItemType.SocialEvent){g=o.eventSpaceEventCantDeleteError.format(i.Url),h.createTopBar({content:g,dismissalMode:h.BarDismissalMode.Timeout}).show();return}if(Calendar.Event.isEventMeetingRequest(i)&&!i.Calendar.IsCurrentUserOwner){h.createTopBar({content:o.meetingRequestDeletePermissionsError,dismissalMode:h.BarDismissalMode.Timeout}).show();return}var nt=e&&e.bIsEditingEvent,b=e&&e.bIsEditingSeries,k=e&&e.preDeleteComplete,tt=Calendar.Event.isEventMeetingRequestInOrganizerMode(i)&&i.Calendar.IsCurrentUserOwner&&!i.IsDraft,it=Calendar.Event.isEventMeetingRequestInParticipantMode(i)&&i.Calendar.IsCurrentUserOwner,s=null,v=i.RecurrenceId&&!nt;m_meetingRequestsEnabled&&tt?v&&!k?s=n._setupDeleteSeries(l,"PreDeleteMeetingRequest",c):(s=h.createFlyout({anchor:c,content:o.alertDeleteMeetingRequestOrganizer,buttons:{action:o["delete"]}}),s.buttonMappings={action:{command:"DeleteMeetingRequest"}}):m_meetingRequestsEnabled&&it&&i.IcsEventStatus!==CAL.ICalEventStatus.Cancelled?v&&!k?s=n._setupDeleteSeries(l,"PreDeleteParticipantMeetingRequest",c):e&&e.MeetingRequestOperation?(i.MeetingRequestOperation=e.MeetingRequestOperation,w=!0):(s=h.createFlyout({anchor:c,content:o.alertDeleteMeetingRequestParticipant,buttons:{action:o.alertDeleteMeetingRequestParticipantOption1,alternate:o.alertDeleteMeetingRequestParticipantOption2}}),s.buttonMappings={action:{command:"DeleteParticipantMeetingRequest",option:"send"},alternate:{command:"DeleteParticipantMeetingRequest",option:"edit"}}):v?s=n._setupDeleteSeries(l,"Delete",c):(rt=a?o.alertdeletebirthday:o.alertdeletesingle,ut=i.ItemType===CAL.CalendarItemType.TaskItem?o.alertdeletetask:rt,s=h.createFlyout({anchor:c,content:ut,buttons:{action:o["delete"]}}),s.buttonMappings={action:{command:"Delete"}}),p={DeletedEvent:i,bIsEditingSeries:b,ControlInstanceName:e?e.ControlInstanceName:"None",bIsBirthdayEvent:a},d=function(i){var f,o,e,h,s;if(i){f=p.DeletedEvent,o=p.bIsEditingSeries;switch(i.command){case"Delete":e=!1;switch(i.option){case"Occurrence":e=!1;break;case"Series":e=!0;break;default:f.RecurrenceId&&o&&(e=!0)}f.RecurrenceId?t.deleteRecurringEvent(f,e):(h=[f.Guid],t.deleteEvents(h,{eventIds:h,events:[f],ControlInstanceName:p.ControlInstanceName})),s=r.getCurrentViewName(),s===CAL.DisplayView.EditEventView||s===CAL.DisplayView.ReadOnlyEventView?u("fullScreenEventEditor").getController().cancel():s===CAL.DisplayView.EditTaskView&&u("fullScreenTaskEditor").getController().cancel();break;case"DeleteMeetingRequest":n.getOnDemandLoadManager().requireFeatures(["EventEditRsvpResponse"],{eventPackage:{eventData:f},organizerActionType:CAL.OrganizerActionType.CancelMeeting,bIsEditingSeries:o},br);break;case"DeleteParticipantMeetingRequest":ct(i.option,{eventPackage:{eventData:f},userParticipationStatus:CAL.CalendarUserParticipationStatus.Declined,userMessagingComplete:!0,bIsEditingSeries:o});break;case"PreDeleteParticipantMeetingRequest":case"PreDeleteMeetingRequest":y(f,f.Calendar,{bIsEditingEvent:!1,preDeleteComplete:!0,bIsEditingSeries:i.option==="Series",srcElement:c})}return}},w?d({command:"Delete",option:b?"Series":"Occurrence"}):s.show().then(function(n){d(s.buttonMappings[n.buttonClicked])})}function br(n){var i=f.getLargestDisplayedRange();t.getFullEvent(n.eventPackage.eventData.CacheEventId,i,{ControlInstanceName:"None",eventId:n.eventPackage.eventData.CacheEventId,calendarId:0,Callback:kr,Context:n})}function kr(n,t,i){var r={eventData:n};u("eventEditRsvpResponse").show(r,null,i.organizerActionType,i.bIsEditingSeries)}function ct(i,e){var l=e&&e.userMessagingComplete,s=e&&typeof e.bIsEditingSeries!="undefined"?e.bIsEditingSeries:!1,h,o,a,c;i==="edit"?n.getOnDemandLoadManager().requireFeatures(["EventEditRsvpResponse"],{eventPackage:e.eventPackage,userParticipationStatus:e.userParticipationStatus,bIsEditingSeries:s},function(n){u("eventEditRsvpResponse").show(n.eventPackage,n.userParticipationStatus,null,n.bIsEditingSeries)}):(h=CAL.ParticipantActionType.UpdateParticipantStatusOnly,i==="send"&&(h=CAL.ParticipantActionType.UpdateParticipantStatusAndSendUpdate),o=e.eventPackage,o.eventData.MeetingRequestOperation=new CAL.PLMROperationInfo(null,h),e.userParticipationStatus===CAL.CalendarUserParticipationStatus.Declined?(l?o.eventData.RecurrenceId?t.deleteRecurringEvent(o.eventData,s):(c=[o.eventData.Guid],t.deleteEvents(c,{eventIds:c,events:[o.eventData]})):(a=f.getLargestDisplayedRange(),t.getCachedEvent([u("fullScreenEventEditor").getController().getEventId()],a,{ControlInstanceName:"None",Callback:y,event:Calendar.Event.cloneEvent(o.eventData),Context:{bIsEditingEvent:!0,bIsEditingSeries:s,MeetingRequestOperation:Calendar.Event.MeetingRequestOperation.clone(o.eventData.MeetingRequestOperation)}})),r.getCurrentViewName()===CAL.DisplayView.EditEventView&&u("fullScreenEventEditor").getController().cancel()):(n.saveEventData(o.eventData,o.OldDateStart,o.OldDateEnd,o.IsReadOnly,o.recurrenceState,o.IsChangingCalendar,"fullScreenEventEditor","event"),gHistoryEngine&&gHistoryEngine.AddEventToHistory(e,ti),u("fullScreenEventEditor").getController().clear()))}function ti(t,i){n.doCommand("NavigateToView",i.preViewingGrid)}function dr(n,i,f,e){if(i.eventData.RecurrenceId)t.deleteRecurringEvent(i.eventData,e);else{var o=[i.eventData.Guid];t.deleteEvents(o,{eventIds:o,events:[i.eventData]})}r.getCurrentViewName()===CAL.DisplayView.EditEventView&&u("fullScreenEventEditor").getController().cancel()}function gr(i,f){var e=f.eventPackage,s=f.userParticipationStatus,h=f.bIsEditingSeries,o;s==CAL.CalendarUserParticipationStatus.Declined?(e.eventData.RecurrenceId?t.deleteRecurringEvent(e.eventData,h):(o=[e.eventData.Guid],t.deleteEvents(o,{eventIds:o,events:[e.eventData]})),r.getCurrentViewName()===CAL.DisplayView.EditEventView&&u("fullScreenEventEditor").getController().cancel()):(n.saveEventData(e.eventData,e.OldDateStart,e.OldDateEnd,e.IsReadOnly,e.recurrenceState,e.IsChangingCalendar,"fullScreenEventEditor","event"),gHistoryEngine&&gHistoryEngine.AddEventToHistory(f,ti),u("fullScreenEventEditor")&&u("fullScreenEventEditor").getController().clear())}var n,lt,ri,a;DesktopAppController.initializeBase_lf(this,arguments),n=this,lt=null,n.$=function(){return lt||(lt=jQuery(n))};var at=!1,nt=[],u=null,t=null,f=null,rt=null,vt=new Calendar.DelayLoadManager,p=null,r=null,o=null,s=null,c=null,tt=null,w=null,b=null,nu="fseePLT",ut=["navigationContainer","calendarViewsContainer"],ft=null,e=null,l=null,h=null,ii=8;return n.getMaxDaysInWeekView=function(){return ii},ri=42,n.getMonthViewMaxCells=function(){return ri},a={isTraditionalMonthView:!0,isTraditionalWeekView:!1,haveTasksLoaded:CAL.DisplayView[getSetting("savedView")]===CAL.DisplayView.TaskView,tasksClicked:!1},n.setViewFlags=function(n,t){n!=null&&typeof n!="undefined"&&(a.isTraditionalMonthView=n),t!=null&&typeof t!="undefined"&&(a.isTraditionalWeekView=t)},n.getIsTraditionalMonthView=function(){return a.isTraditionalMonthView},n.getIsTraditionalWeekView=function(){return a.isTraditionalWeekView},n.getTasksLoaded=function(){return a.haveTasksLoaded},n.setTasksLoaded=function(n){a.haveTasksLoaded=n},n.getTasksClicked=function(){return a.tasksClicked},n.setTasksClicked=function(n){a.tasksClicked=n},n.getCurrentViewName=function(){return r.getCurrentViewName()},n.getPreviousViewName=function(){return r.getPreviousViewName()},n.navigateToPreviousEventView=function(){r.navigateToPreviousEventView()},n.getPrintContext=function(){return l},n.beginWaitForBootstrap=function(n){ft=window.setTimeout(yt,n)},n.endWaitForBootstrap=function(){ft&&window.clearTimeout(ft)},n.init=function(i,e){f=e,u=f.getControlInstance,t=i,r=u("viewNavigator"),rt=(new Calendar.BICITrackingManager).init(n.getAppState().getIsGroupMode()),dt(),t.$().bind({"stoppolling.dac":hr,"servererror.dac":or,"bootstrapfailed.dac":yt}),jQuery(r).bind({"viewnav_requestdisplaychange.dac":wt,"viewnav_viewchanged.dac":wi}),w=u("gridNavigator"),jQuery(w).bind("gridnav_paginationaction.dac",ki),DesktopAppController.callBaseMethod_lf(n,"init",arguments)},n.initDelayed=function(){dt(),vt.setDelayLoadCompleted(),gHistoryEngine=new HistoryEngine,gHistoryEngine.initialize(window,"app_frameset","/calendar/Library/hist0"+n.getAppState().getServiceVersion()+".aspx","/calendar/Library/hist1"+n.getAppState().getServiceVersion()+".aspx",{commandName:n.getAppState().getInitViewCommandName(),paramList:{targetDate:n.getAppState().getBootModelTargetDate()}},doCommandFromHistory,null),at=!0,DesktopAppController.callBaseMethod_lf(n,"initDelayed",arguments)},n.notifyOnDemandFeatureLoaded=function(t){DesktopAppController.callBaseMethod_lf(n,"notifyOnDemandFeatureLoaded",arguments);switch(t){case"EventEditRsvpResponse":var i=u("eventEditRsvpResponse");i&&jQuery(i).bind({"send.dac":gr,"delete.dac":dr})}},n.registerDragDropControl=function(n){jQuery(n).bind({"drageventended.dac":ci,"drageventstarted.dac":hi}),nt.push(n)},n.dispose=function(){var f,e;for(jQuery(t).unbind(".dac"),jQuery(r).unbind(".dac"),jQuery(u("eventEditRsvpResponse")).unbind(".dac"),i=0;i<nt.length;i++)jQuery(nt[i]).unbind(".dac");if(nt=null,gHistoryEngine&&(gHistoryEngine.dispose(),gHistoryEngine=null),h){for(f=0;f<h.length;f++)e=h[f],e&&e.close();h.clear(),h=null}DesktopAppController.callBaseMethod_lf(n,"dispose",arguments)},this.isCalendarVisible=function(n){return t.getCalendar(n,{}).IsVisibleToCurrentUser},n.saveEventData=function(i,u,e,o,s,h,c,l){var y,p,a,v;if(o){t.saveReadOnlyEvent(i,{ControlInstanceName:c});return}y=f?f.getLargestDisplayedRange():null,p=s&&(i.IsRecurrenceException||i.RecurrenceId||i.RecurrenceInfo||s.originalEventWasRecurring),p||(s=null),t&&t.saveEvent(i,n.isCalendarVisible(i.CalendarGuid),s,y,h,{ControlInstanceName:c}),i.Guid||(a=l=="event"?"AddNewEvent":"TaskNoDueDateQuickAddSave",v=t.getCalendar(i.CalendarGuid,{}),n.getAppState().getIsGroupMode()&&v&&!Calendar.Event.isGroupCalendar(v)?a="SaveEventToPersonalCalendar":(r.getCurrentViewName()===CAL.DisplayView.MonthView||l==="task")&&(i.IsAllDayEvent?a=l==="event"?"EventAllDayMonthGridSave":"TaskNoDueTimeQuickAddSave":i.DateEnd&&(a=l==="event"?"EventPartialDayMonthGridSave":"TaskWithDueTimeQuickAddSave")),n.doCommand("TrackAction",{trackId:a,attributes:gController.getViewInstrumentation()}))},n.saveBirthdayData=function(i,r){var u=f?f.getLargestDisplayedRange():null;t&&t.saveBirthday(i,n.isCalendarVisible(i.CalendarGuid),u,{ControlInstanceName:r})},n.showBirthdayReadOnlyError=function(){var t=n.getStrings();wLive.Controls.Notifications.createModalDialog({title:t.birthdayReadOnlyErrorTitle,content:t.birthdayReadOnlyErrorMessage,buttons:{action:t.ok}}).show()},n.getCurrentViewContentElementID=function(){switch(r.getCurrentViewName()){case CAL.DisplayView.MonthView:case CAL.DisplayView.WeekView:case CAL.DisplayView.DayView:case CAL.DisplayView.AgendaView:case CAL.DisplayView.TaskView:return"calendarViewsContainer";case CAL.DisplayView.EditEventView:case CAL.DisplayView.NewEventView:case CAL.DisplayView.ReadOnlyEventView:return"fullScreenEventEditor";case CAL.DisplayView.EditTaskView:case CAL.DisplayView.NewTaskView:case CAL.DisplayView.ReadOnlyTaskView:return"fullScreenTaskEditor";case CAL.DisplayView.CalendarGeneralSettingsView:return"calendarGeneralSettingsContainer"}},n.getSelectionRange=function(n,t){var i=n.getSelectionRange();return i||t||(i=gController.getDefaultSelectionRange()),i},n.getDefaultSelectionRange=function(){var u=null,r=new Calendar.Date,f,o;r.moveToStartOfDay(),f=new Calendar.Date(r),f.moveToEndOfDay();var e={DateStart:r,DateEnd:f},i=new Calendar.Date,t=null;return Calendar.Date.getDayDifference(e.DateStart,i)>=0&&Calendar.Date.getDayDifference(i,e.DateEnd)>=0?(t=i,i=null):n.getAppState().getTargetStartDate()&&(t=n.getAppState().getTargetStartDate().clone()),t.setHours(Calendar.Date.StartHourOfWorkDay,Calendar.Date.StartMinuteOfWorkDay,0,0),o=t.addMinutes(60),u={DateStart:t,DateEnd:o,IsAllDayEvent:!1}},n.getItemDetailsAndEditFromHistory=function(t){var i={itemType:t.itemType,itemId:t.eventId,calendarId:t.calendarId,viewName:t.viewingName,skipRecurrenceDialog:!1};n.doCommand("EditItem",i)},n.deleteItem=function(t){var i=r.getCurrentViewName();switch(i){case CAL.DisplayView.ReadOnlyEventView:case CAL.DisplayView.EditEventView:n.deleteSelectedEvent(t);break;case CAL.DisplayView.ReadOnlyTaskView:case CAL.DisplayView.EditTaskView:n.deleteSelectedTask(t);break;case CAL.DisplayView.CalendarGeneralSettingsView:n.doCommand("DeleteCalendarBeingEdited",t)}},n.deleteSelectedEvent=function(i){var c=n.getStrings(),e=null,a=null,h={bIsEditingEvent:!1},v,l,p;i&&i.srcElement&&(h.srcElement=i.srcElement),v=r.getCurrentViewName();switch(v){case CAL.DisplayView.ReadOnlyEventView:case CAL.DisplayView.EditEventView:l=u("fullScreenEventEditor").getController(),e=[l.getEventId()],a=l.getOriginalEvent(),h.bIsEditingEvent=!0,h.bIsEditingSeries=l.isEditingRecurringEventSeries(),h.srcElement=u("commandBar").deleteButton[0];break;case CAL.DisplayView.MonthView:e=o.getSelectedEventIds();break;case CAL.DisplayView.WeekView:case CAL.DisplayView.DayView:e=s.getSelectedEventIds()}e&&(e.length===0?wLive.Controls.Notifications.createModalDialog({title:c.deleteEventNoSelectionTitle,content:c.deleteEventNoSelectionText,buttons:{action:c.ok}}).show():(p=f.getLargestDisplayedRange(),t.getCachedEvent(e[0],p,{ControlInstanceName:"None",Callback:y,event:Calendar.Event.cloneEvent(a),Context:h})))},n.deleteSelectedTask=function(n){var e=null,o=null,i={bIsEditingEvent:!1},s;n&&n.srcElement&&(i.srcElement=n.srcElement);switch(r.getCurrentViewName()){case CAL.DisplayView.EditTaskView:e=u("fullScreenTaskEditor").getController().getEventId(),o=u("fullScreenTaskEditor").getController().getOriginalEvent(),i.bIsEditingEvent=!0;break;default:return}s=f.getLargestDisplayedRange(),t.getCachedEvent(e,s,{ControlInstanceName:"None",Callback:y,event:Calendar.Event.cloneEvent(o),Context:i})},n.closeFullScreenEventEditor=function(){var n=u("fullScreenEventEditor");n&&n.getController().stopWatchingSidebarNavigation()},n.closeFullScreenTaskEditor=function(){var n=u("fullScreenTaskEditor");n&&n.getController().stopWatchingSidebarNavigation()},n.handleKeyDown=function(t){var r=window.document.activeElement,i;switch(t.keyCode){case Dom.KeyCode.F6:if(i=yi(r)+1,i==ut.length)return!0;if(!n.selectNavigableElement(ut[i]))return t.returnValue=!1,!1}DesktopAppController.callBaseMethod_lf(n,"handleKeyDown",arguments)},n.showDeleteConfirmationAlert=function(n,t,i){y(n,t,i)},n.updateSpecifiedEvents=function(t){n.$().trigger("updateEvents",[t])},n.getViewNameInstrumentation=function(n){var t=5;switch(n){case CAL.DisplayView.MonthView:t=0;break;case CAL.DisplayView.WeekView:t=1;break;case CAL.DisplayView.DayView:t=2;break;case CAL.DisplayView.AgendaView:t=3;break;case CAL.DisplayView.TaskView:t=4}return t},n.getCurrentViewForInstrumentation=function(){return n.getViewNameInstrumentation(gController.getCurrentViewName())},n.getViewInstrumentation=function(t){return jQuery.extend(t||{},{CalendarView:n.getCurrentViewForInstrumentation()})},n.doCommand=function(i,u,e){var h=!1,a=null,l,c,d,b,y,p,nt;switch(i){case"CommandBarAction":u&&u.srcElement&&(l=u.srcElement,c=l.getAttribute("cmd"),c||(d=jQuery(l).parentsUntil("li","a"),d.each(function(){return c=this.getAttribute("cmd"),c?(l=this,!1):void 0})),c&&(b=l.getAttribute("cPm"),c==="Delete"&&(b={srcElement:l}),$menu.closeCurrent(),n.doCommand(c,b),y=null,c==="NewPrePopulatedEvent"||c==="NewItem"&&gController.getCurrentViewName()!==CAL.DisplayView.TaskView?y="ToolbarAddEventButton":(c==="NewPrePopulatedTask"||c==="NewItem")&&(y="ToolbarAddTask"),y&&n.doCommand("TrackAction",{trackId:y,attributes:gController.getViewInstrumentation()})));break;case"NewItem":n.doCommand(r.getCurrentViewName()===CAL.DisplayView.TaskView?"NewPrePopulatedTask":"NewPrePopulatedEvent");break;case"Options":ui();break;case"Import":fi();break;case"NewBirthdayCalendar":n.doCommand("LaunchCalendarSettingDialog",{newCalendarType:CAL.CalendarType.Birthday});break;case"LoadCalendars":t&&t.getAllCalendars();break;case"SetTasksLoaded":li();break;case"FirstRunExperience":getSetting("showFRE")&&ar();break;case"SetUserTimezone":_handleFirstRunExperience(u.Timezone,u.BootstrapWhenComplete);break;case"Bootstrap":sendBootstrapRequest();break;case"ShowAddEventPopOver":ot("event",u.eventContext,u.timeSelection,u.trackingName,u.trackingAttributes,"showAddEventPopOver");break;case"ShowAddTaskPopOver":ot("task",u.eventContext,u.timeSelection,u.trackingName,u.trackingAttributes,"showAddTaskPopOver");break;case"ShowAddBirthdayPopOver":ot("birthday",u.eventContext,u.timeSelection,u.trackingName,u.trackingAttributes,"showAddBirthdayPopOver");break;case"InitAgendaView":h=!0,w.setDateLabelText(f.getContentStrings().agendaView.header),n.doCommand("NavigateToView",CAL.DisplayView.AgendaView);break;case"ShowAgendaView":h=!0,r.changeDisplay(Calendar.ViewNavigatorButtons.Agenda);break;case"ShowDayView":h=!0,v(u.targetDate,CAL.DisplayView.DayView);break;case"ShowWeekView":h=!0,v(u.targetDate,CAL.DisplayView.WeekView);break;case"ShowTaskView":h=!0,v(u.targetDate,CAL.DisplayView.TaskView);break;case"ShowBirthdayCal":oi();break;case"ShowMonthView":h=!0,v(u.targetDate,CAL.DisplayView.MonthView);break;case"DelayInitInitialView":h=!1,v(u.targetDate,n.getAppState().getInitView(),!0),n.doCommand("RefreshResizeEngine");break;case"NewEvent":et(CAL.CalendarItemType.CalendarItem);break;case"NewBirthday":getSetting("isBirthdayCalendarReadOnly")?n.showBirthdayReadOnlyError():et("birthday");break;case"NewTask":et(CAL.CalendarItemType.TaskItem);break;case"LaunchEditor":vi(u.eventContext,u.control);break;case"EditEvent":h=!0,pt({itemType:"event",itemId:u.eventId+(u.eventRecurrenceId?"|"+u.eventRecurrenceId:""),calendarId:u.calendarId,skipRecurrenceDialog:!u.eventRecurrenceId,isRru:u.isRru});break;case"EditTask":h=!0,pt({itemType:"task",itemId:u.eventId,calendarId:u.calendarId});break;case"NewPrePopulatedEvent":h=!0,fr(u);break;case"NewPrePopulatedTask":h=!0,er(u);break;case"GoToToday":h=!0,v(new Calendar.Date,r.getCurrentViewName());break;case"GoToDate":h=!0,p=r.getCurrentViewName(),p===CAL.DisplayView.MonthView&&(p=CAL.DisplayView.DayView),v(u.targetDate,p);break;case"TrackAction":rt&&rt.trackAction(u.trackId,u.kind,u.attributes);break;case"CommonClickAction":di(u.clickAction,u.context);break;case"Delete":n.deleteItem(u);break;case"DeleteEvent":n.deleteSelectedEvent(u);break;case"DeleteTask":n.deleteSelectedTask(u);break;case"LaunchCalendarSettingDialog":u&&!u.calendarGuid&&u.newCalendarType&&u.newCalendarType==CAL.CalendarType.Birthday&&getSetting("isBirthdayCalendarReadOnly")?n.showBirthdayReadOnlyError():(h=!0,it(u?u.calendarGuid:null,u?u.newCalendarType:null));break;case"EditCalendarFromContextMenu":h=!0,it(u.menuContext.calendarId);break;case"ShareCalendarFromContextMenu":h=!0,ht(u.menuContext.calendarId),a=g;break;case"NotificationsFromContextMenu":h=!0,it(u.menuContext.calendarId);break;case"EditCalendar":h=!0,it(u);break;case"ShareCalendar":h=!0,ht(u),a=g;break;case"LaunchCalendarSharingSettingDialog":h=!0,ht(u.calendarId),a=g;break;case"Print":vr();break;case"ReturnToCalendarView":h=!0,r.navigateToPreviousEventView();break;case"StartPolling":sr(u.calendarId);break;case"RsvpResponse":ai(u.rsvpAction,u.context);break;case"SetupPrintContext":pr(u.printType);break;case"DisposePrintContext":yr(u.printWindow);break;case"NavigateToContactDetails":st(u);break;case"NavigateToCleanUpContacts":lr(u);break;case"SendMessage":gt(u);break;case"EditItem":k({itemType:u.itemType,itemId:u.itemId,calendarId:u.calendarId,viewName:u.viewName?u.viewName:r.getCurrentViewName(),skipRecurrenceDialog:u.skipRecurrenceDialog,isRru:u.isRru,srcElement:u.srcElement});break;case"ProcessWeather":si();break;case"SetCalendarVisibility":nt=jQuery(u.srcElement).parents("li").filter(":first").attr("guid"),ei(nt);break;case"ClearGridBackgroundSelections":o.clearBackgroundSelection(),s.clearBackgroundSelection();break;case"ViewRSSLink":showUrlDlg("https","calendar.xml",m_pStrings.Published.rssTitle,m_pStrings.Published.rssMessage,"PublishedXMLLink");break;case"ViewICSLink":showUrlDlg("webcals","calendar.ics",m_pStrings.Published.icsTitle,m_pStrings.Published.icsMessage,"PublishedICALLink")}gHistoryEngine&&h&&!e&&gHistoryEngine.AddEventToHistory({commandName:i,paramList:u},doCommandFromHistory,a),DesktopAppController.callBaseMethod_lf(n,"doCommand",arguments)},this},DesktopAppController.registerClass_lf("DesktopAppController","AppController"),MiniCalendarController=function(n){function s(){gController.$().bind("initControllers",u)}function u(n,r,u){o=r,e=u,jQuery(t).bind({"selectionchanged.mcc":h,"beforeselectionchanged.mcc":c,"displayedmonthchanged.mcc":l,"paginationaction.mcc":a,"clickaction.mcc":v,"drageventstarted.mcc":y}),gController.registerCommands(i,["SetSelection","ForceSetSelection"])}function f(n){gController.doCommand("NavigateToView",n.view),t.setSelection(n.startDate,n.endDate,n.focusDate)}function h(n,t,r,u){i.$().trigger("selectionchanged",[t,r]),u&&gHistoryEngine&&gHistoryEngine.AddEventToHistory({startDate:t,endDate:r,focusDate:gController.getAppState().getTargetStartDate(),view:gController.getCurrentViewName()},f)}function c(n,t,i){var u,f,e,o,l,a;if(!(i.StartDate>i.EndDate))if(gController.getCurrentViewName()==CAL.DisplayView.AgendaView)gController.getAppState().setTargetStartDate(i.StartDate.clone());else{if(u=Calendar.Date.getDayDifference(i.StartDate,i.EndDate),u==Calendar.Date.NumberOfDaysInWeek&&i.StartDate.getDay()==Calendar.Date.FirstDayOfWeek&&gController.setViewFlags(null,!0),gController.getIsTraditionalWeekView()&&(u==1?(i.StartDate.moveToStartOfWeek(),i.EndDate.moveToEndOfWeek()):gController.setViewFlags(null,u==Calendar.Date.NumberOfDaysInWeek&&i.StartDate.getDay()==Calendar.Date.FirstDayOfWeek)),u>gController.getMaxDaysInWeekView()&&u<=gController.getMonthViewMaxCells()&&(f=i.StartDate.clone(),f.moveToEndOfWeek(),f.moveToStartOfDay(),e=i.EndDate.clone(),e.moveToStartOfWeek(),o=f.getMonth(),!gController.getIsTraditionalMonthView()&&e.getMonth()==o&&f.getDate()<=7&&e.getDate()>Calendar.Date.getDaysInMonth(f.getFullYear(),o)-7&&gController.setViewFlags(!0,null),i.StartDate.moveToStartOfWeek(),i.EndDate.moveToEndOfWeek()),gController.getIsTraditionalMonthView())if(u<28)gController.setViewFlags(!1,null);else{var s=Calendar.Date.average(i.StartDate,i.EndDate),h=Calendar.Date.getRangeOfMonth(s),c=Calendar.Date.getRangeOfCalendarMonth(s);gController.setViewFlags(h.StartDate.valueOf()==i.StartDate.valueOf()&&h.EndDate.valueOf()==i.EndDate.valueOf()||c.StartDate.valueOf()==i.StartDate.valueOf()&&c.EndDate.valueOf()==i.EndDate.valueOf(),null)}t?gController.getAppState().setTargetStartDate(t.clone()):gController.getAppState().getTargetStartDate().isBetween(i.StartDate,i.EndDate)||(gController.getIsTraditionalMonthView()?(l=Calendar.Date.average(i.StartDate,i.EndDate),a=gController.getAppState().getTargetStartDate().clone(),a.moveToSameDateOfTargetMonth(l.getYear(),l.getMonth()),gController.getAppState().setTargetStartDate(a)):gController.getAppState().setTargetStartDate(i.StartDate.clone()))}}function l(n,i,r,u){var h=t.getSelectionRange(),y;if(h.StartDate&&u!=0){var l=Math.min(gController.getAppState().getTargetStartDate().getDate(),Calendar.Date.getDaysInMonth(i,r)),a=Calendar.Date.getDayDifference(h.StartDate,h.EndDate),o=h.StartDate.clone(),e=h.EndDate.clone(),s=null;if(a<=gController.getMaxDaysInWeekView())if(gController.getIsTraditionalWeekView())s=new Calendar.Date(i,r,Math.min(l,Calendar.Date.getDaysInMonth(i,r))),o=s.clone(),o.moveToStartOfWeek(),e=o.clone(),e.moveToEndOfWeek();else{var p=e-o,c=new Calendar.Date(e.getFullYear(),e.getMonth(),1).addMonths(u),v=Calendar.Date.getDaysInMonth(c.getFullYear(),c.getMonth()),w=e.getDate();v<w?(e=c.clone(),e.setDate(v),e.moveToEndOfDay()):e.setMonth(e.getMonth()+u),o.setTime(e.getTime()-p),s=o.clone()}else s=new Calendar.Date(i,r,l),gController.getIsTraditionalMonthView()||gController.getCurrentViewName()==CAL.DisplayView.AgendaView?(y=Calendar.Date.getRangeOfCalendarMonth(new Calendar.Date(i,r,1)),o=y.StartDate,e=y.EndDate):(o=s.clone(),o.moveToStartOfWeek(),e=o.addDays(a-1),e.moveToEndOfDay());t.setSelection(o,e,s),gHistoryEngine&&gHistoryEngine.AddEventToHistory({startDate:o,endDate:e,focusDate:s,view:gController.getCurrentViewName()},f)}}function a(){gController.doCommand("TrackAction",{trackId:"MiniCalPagination",attributes:gController.getViewInstrumentation()})}function v(){gController.doCommand("TrackAction",{trackId:"MiniCalClickEvent",attributes:gController.getViewInstrumentation()})}function y(){gController.doCommand("TrackAction",{trackId:"MiniCalDragEvent"})}var i=this,r=null;this.$=function(){return r||(r=jQuery(i))};var e=null,o=null,t=n;this.dispose=function(){jQuery(t).unbind(".mcc"),gController.$().unbind("initControllers",u),gController.unregisterCommands(i),t=null},this.doCommand=function(n,i){switch(n){case"SetSelection":t.setSelection(i.startDate,i.endDate,i.focusDate,i.dontBroadcast);break;case"ForceSetSelection":t.forceSetSelection(i.startDate,i.endDate,i.focusDate,i.dontBroadcast)}},s()},MiniCalendarController.registerClass_lf("MiniCalendarController"),GridControllerBase=function(n){function o(n,t){f.updateEvents(t)}var t=this,u=null;this.$=function(){return u||(u=jQuery(t))};var f=n,i=null,r=null,e=!1;this.getGridView=function(){return f},this.getModel=function(){return i},this.getAppView=function(){return r},this.isInitialized=function(){return e},this.initController=function(n,t,u){i=t,r=u,e=!0},this.initDelayed=function(n,i,r){t.initController(n,i,r)},this.create=function(){gController.$().bind({"initControllers.gcb":t.initController,"initDelayedControllers.gcb":t.initDelayed,"updateEvents.gcb":o})},this.dispose=function(){gController.$().unbind(".gcb"),i=r=null},this.isCurrentView=function(){return!1},this.getPaginationSequenceID=function(){return""},this.paginationAction=function(){gController.doCommand("TrackAction",{trackId:t.getPaginationSequenceID(),attributes:gController.getViewInstrumentation()})},this.dragEventStarted=function(){gController.hideAllPopupDialogs()},this.eventDropped=function(n,i){var u=i.Event,r;m_meetingRequestsEnabled&&Calendar.Event.isEventMeetingRequestInOrganizerMode(u)?(r=gController.getStrings(),wLive.Calendar.createNotificationWithOptions("ModalDialog",{title:r.alertDragDropChangeMeetingRequestTitle,content:r.alertDragDropChangeMeetingRequestText,buttons:{action:r.ok,close:r.cancel}},[{caption:r.alertDragDropChangeMeetingRequestOption1,value:"SendUpdate",checked:!0},{caption:r.alertDragDropChangeMeetingRequestOption2,value:"Cancel"},]).show().then(function(n){var r=i;n.buttonClicked==="action"&&(this.optionSelected==="SendUpdate"?(r.Event.MeetingRequestOperation=new CAL.PLMROperationInfo(CAL.OrganizerActionType.SendUpdatesToAll),t.eventDroppedPost(r)):gController.updateSpecifiedEvents([r.OriginalEvent]))})):t.eventDroppedPost(i)},this.eventDroppedPost=function(n){switch(n.DragType){case Calendar.DragDrop.DragType.Move:i.moveEventUsingStartTime(n,r.getLargestDisplayedRange(),null);break;case Calendar.DragDrop.DragType.TopResize:i.updateEventStartTime(n,r.getLargestDisplayedRange(),null);break;case Calendar.DragDrop.DragType.BottomResize:i.updateEventEndTime(n,r.getLargestDisplayedRange(),null)}gController.doCommand("TrackAction",{trackId:"DragOrResizeEvent"})},GridControllerBase.registerBaseMethod(this,"initController"),GridControllerBase.registerBaseMethod(this,"initDelayed"),GridControllerBase.registerBaseMethod(this,"dispose"),GridControllerBase.registerBaseMethod(this,"doCommand"),GridControllerBase.registerBaseMethod(this,"isCurrentView"),GridControllerBase.registerBaseMethod(this,"getPaginationSequenceID")},GridControllerBase.registerAbstractClass("GridControllerBase")